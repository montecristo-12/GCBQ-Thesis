---
title: "GCBQ Dissertation - N Melas"
output: html_notebook
---

## Data Preparation

The following assumes inflation data from the UK Office of National Statistics CPIH Annual Rate (Series ID: 2550). This can be accessed from <https://www.ons.gov.uk/economy/inflationandpriceindices/timeseries/l55o/mm23>

### Assigning BoE survey timeseries to inflation data

The ONS publishes monthly and quarterly statistics on annual inflation. Although the BoE survey is conducted quarterly, the survey months are always February, April, July, or November. If I want to compare public perceptions and predictions of inflation, I should use inflation data that, as best as possible, reflects inflation activity experienced as close as possible to the survey date.

To do this, I take the pattern of the yyyyqq variable from the BoE dataset (e.g. 200101 for a survey conducted in May 2001), and assign the value the ONS inflation timeseries for the month prior to that survey (e.g. 200101 for ONS inflation statistics for April 2001.)

Surveys that cover the fourth quarter of the year are actually conducted in February of the following year. To account for this, I subtract 100 from values of yyyyqq that end in 04, so that I use the January data for the following year of any survey that is notated yyyy04.

#### CPIH series
**Use 'yyyyqq' variable as a primary key between Inflation Attitudes Survey and CPIH series**

```{r}
CPIH_series <- CPIH_series %>%
    mutate(yyyyqq = case_when(
        str_detect(Title, "JAN") ~ paste0(substr(Title, 1, 4), "01"),
        str_detect(Title, "APR") ~ paste0(substr(Title, 1, 4), "02"),
        str_detect(Title, "JUL") ~ paste0(substr(Title, 1, 4), "03"),
        str_detect(Title, "OCT") ~ paste0(substr(Title, 1, 4), "04")
    )) %>%
    mutate(yyyyqq = as.numeric(yyyyqq)) %>%
    filter(!is.na(yyyyqq))
```

**Data cleaning - CPIH labelling**

```{r}
CPIH_series <- CPIH_series %>%
    rename(CPIH = "CPIH ANNUAL RATE 00: ALL ITEMS 2015=100") %>%
    mutate(CPIH = as.numeric(CPIH))
```

#### CPI series
**Use 'yyyyqq' variable as a primary key between Inflation Attitudes Survey and CPI series**

```{r}
CPI_series <- CPI_series %>%
    mutate(yyyyqq = case_when(
        str_detect(Title, "JAN") ~ paste0(substr(Title, 1, 4), "01"),
        str_detect(Title, "APR") ~ paste0(substr(Title, 1, 4), "02"),
        str_detect(Title, "JUL") ~ paste0(substr(Title, 1, 4), "03"),
        str_detect(Title, "OCT") ~ paste0(substr(Title, 1, 4), "04")
    )) %>%
    mutate(yyyyqq = as.numeric(yyyyqq)) %>%
    filter(!is.na(yyyyqq))
```

**Data cleaning - CPI labeling**

```{r}
CPI_series <- CPI_series %>%
    rename(CPI = "CPI ANNUAL RATE 00: ALL ITEMS 2015=100") %>%
    mutate(CPI = as.numeric(CPI))
```

#### Implementing BoE survey intervals for inflation data

The BoE Inflation Attitudes survey uses interval values to capture respondents' perceptions and predictions about inflation. More information about the BoE's survey design is available above at 3.2 Data Dictionary.

This code applies the same interval scaling to actual CPIH inflation outcomes; e.g. CPIH for April 2023 was 7.8%, which would have been 5.5 in the BoE's 2001 scaling, and 7.5 in the BoE's 2009 scaling.

**2001 Intervals** 
This applies the interval scaling from the original BoE inflation attitudes survey from 2001 to 2008 (i.e. the scaling applied in the P, E1y, E2y, and E5y variables)

```{r}
CPIH_series <- CPIH_series %>%
	mutate(CPIH_BOEscale_2001 = case_when(
	CPIH < 0 ~ 1,
	CPIH == 0 ~ 0,
	CPIH > 0 & CPIH < 1 ~ 0.5,
	CPIH >= 1 & CPIH < 2 ~ 1.5,
	CPIH >= 2 & CPIH < 3 ~ 2.5,
	CPIH >= 3 & CPIH < 4 ~ 3.5,
	CPIH >= 4 & CPIH < 5 ~ 4.5,
	CPIH >= 5 ~ 5.5
))
```

```{r}
CPI_series <- CPI_series %>%
	mutate(CPI_BOEscale_2001 = case_when(
	CPI < 0 ~ 1,
	CPI == 0 ~ 0,
	CPI > 0 & CPI < 1 ~ 0.5,
	CPI >= 1 & CPI < 2 ~ 1.5,
	CPI >= 2 & CPI < 3 ~ 2.5,
	CPI >= 3 & CPI < 4 ~ 3.5,
	CPI >= 4 & CPI < 5 ~ 4.5,
	CPI >= 5 ~ 5.5
))
```

**2009 Intervals** 
This applies the interval scaling from BoE inflation attitudes survey from 2009 (i.e. the scaling applied in the P_all, E1y_all, E2y_all, and E5y_all variables)

```{r}
CPIH_series <- CPIH_series %>%
    mutate(CPIH_BOEscale_2009 = case_when(
    CPIH < -5 ~ -5.5,
    CPIH >= -5 & CPIH < -4 ~ -4.5,
    CPIH >= -4 & CPIH < -3 ~ -3.5,
    CPIH >= -3 & CPIH < -2 ~ -2.5,
    CPIH >= -2 & CPIH < -1 ~ -1.5,
    CPIH >= -1 & CPIH < 0 ~ -0.5,
    CPIH == 0 ~ 0,
    CPIH > 0 & CPIH < 1 ~ 0.5,
    CPIH >= 1 & CPIH < 2 ~ 1.5,
    CPIH >= 2 & CPIH < 3 ~ 2.5,
    CPIH >= 3 & CPIH < 4 ~ 3.5,
    CPIH >= 4 & CPIH < 5 ~ 4.5,
    CPIH >= 5 & CPIH < 6 ~ 5.5,
    CPIH >= 6 & CPIH < 7 ~ 6.5,
    CPIH >= 7 & CPIH < 8 ~ 7.5,
    CPIH >= 8 & CPIH < 9 ~ 8.5,
    CPIH >= 9 & CPIH < 10 ~ 9.5,
    CPIH >= 10 & CPIH < 11 ~ 10.5,
    CPIH >= 11 & CPIH < 12 ~ 11.5,
    CPIH >= 12 & CPIH < 13 ~ 12.5,
    CPIH >= 13 & CPIH < 14 ~ 13.5,
    CPIH >= 14 & CPIH < 15 ~ 14.5,
    CPIH > 15 ~ 15.5))
```


```{r}
CPI_series <- CPI_series %>%
    mutate(CPI_BOEscale_2009 = case_when(
    CPI < -5 ~ -5.5,
    CPI >= -5 & CPI < -4 ~ -4.5,
    CPI >= -4 & CPI < -3 ~ -3.5,
    CPI >= -3 & CPI < -2 ~ -2.5,
    CPI >= -2 & CPI < -1 ~ -1.5,
    CPI >= -1 & CPI < 0 ~ -0.5,
    CPI == 0 ~ 0,
    CPI > 0 & CPI < 1 ~ 0.5,
    CPI >= 1 & CPI < 2 ~ 1.5,
    CPI >= 2 & CPI < 3 ~ 2.5,
    CPI >= 3 & CPI < 4 ~ 3.5,
    CPI >= 4 & CPI < 5 ~ 4.5,
    CPI >= 5 & CPI < 6 ~ 5.5,
    CPI >= 6 & CPI < 7 ~ 6.5,
    CPI >= 7 & CPI < 8 ~ 7.5,
    CPI >= 8 & CPI < 9 ~ 8.5,
    CPI >= 9 & CPI < 10 ~ 9.5,
    CPI >= 10 & CPI < 11 ~ 10.5,
    CPI >= 11 & CPI < 12 ~ 11.5,
    CPI >= 12 & CPI < 13 ~ 12.5,
    CPI >= 13 & CPI < 14 ~ 13.5,
    CPI >= 14 & CPI < 15 ~ 14.5,
    CPI > 15 ~ 15.5))
```

### Implementing Haldane et al (2009) variables

#### Institutional Knowledge

Implementing the knowledge index proposed in pp 4-5. From the article:

```{r}
BOE_IAS <- BOE_IAS %>%
  mutate(q11_knowledge_hmm2021 = case_when(
    q11 == 1 ~ 2,
    q11 == 7 ~ 1,
    TRUE ~ 0
  )) %>%
  mutate(q12_knowledge_hmm2021 = case_when(
    q12 == 3 ~ 2,
    q12 == 6 ~ 1,
    TRUE ~ 0
  )) %>%
  mutate(q13_knowledge_hmm2021 = case_when(
    q13 == 3 ~ 2,
    q13 == 5 ~ 1,
    TRUE ~ 0
  )) %>%
  mutate(knowledge_hmm2021 = q11_knowledge_hmm2021 + q12_knowledge_hmm2021 + q13_knowledge_hmm2021) %>%
  dplyr::select(-q11_knowledge_hmm2021, -q12_knowledge_hmm2021, -q13_knowledge_hmm2021)
```

#### Macroeconomics Knowledge

Asked one of the authors of the Haldane 2021 paper for how they calculated the macroeconomics knowledge variable
```{r}
BOE_IAS <- BOE_IAS %>%
  mutate(q9a_eknowledge_hmm2021 = case_when(
    q9a == 4 ~ 2,
    q9a == 5 ~ 2,
    q11 == 6 ~ 1,
    TRUE ~ 0
  )) %>%
  mutate(q9b_eknowledge_hmm2021 = case_when(
    q9a == 1 ~ 2,
    q9a == 2 ~ 2,
    q11 == 6 ~ 1,
    TRUE ~ 0
  )) %>%
  mutate(eknowledge_hmm2021 = q9a_eknowledge_hmm2021 + q9b_eknowledge_hmm2021) %>%
  dplyr::select(-q9a_eknowledge_hmm2021, -q9b_eknowledge_hmm2021)
```

### Variables for trust in BoE

#### q14_binary

Q14 in binary scale, where 1 = Very satisfied or Fairly satisfied and 0 = Very dissatisfied or Fairly dissatisfied

```{r}
BOE_IAS <- BOE_IAS %>% 
    mutate(q14_binary = case_when(
        q14 %in% c(1, 2) ~ 0,
        q14 %in% c(4, 5) ~ 1
    ))
```

#### q14_hmm2021

Q14 in ordinal scale between 1-4, where 1 = Very satisfied and 4 = Very dissatisfied

```{r}
BOE_IAS <- BOE_IAS %>% 
    mutate(q14_hmm2021 = case_when(
        q14 == 1 ~ 1,
        q14 == 2 ~ 2,
        q14 == 4 ~ 3,
        q14 == 5 ~ 4
    ))
```

### Calculating Aggregate Satisfaction

**Calculating aggregate satisfaction by survey round**
```{r}
trustaggregate <- BOE_IAS %>%
    group_by(yyyyqq) %>%
    summarise(.,
              agg_dissatisfied = round((sum(q14_binary, na.rm = TRUE) / sum(!is.na(q14_binary))), 2),
              agg_satisfied = round((sum(!is.na(q14_binary)) - sum(q14_binary, na.rm = TRUE)) / sum(!is.na(q14_binary)), 2),
              agg_trust = round((agg_dissatisfied * -1) + agg_satisfied,2)
            )
```

**Adding aggregate satisfaction to the BOE dataframe**
```{r}
BOE_IAS <-
    left_join(BOE_IAS,trustaggregate %>%
                  dplyr::select(any_of(c("yyyyqq","agg_trust"))),
              by = "yyyyqq")
BOE_IAS <- BOE_IAS %>%
  dplyr::mutate(agg_trust_inv = agg_trust*-1)
```

### Perception and Prediction Error Calculations

#### Calculating Error Using BoE's 2001 Scaling

The code in this section uses the interval scaling from the original BoE inflation attitudes survey from 2001 to 2008 (i.e. the scaling applied in the P, E1y, E2y, and E5y variables)

##### Perception Error

This creates a new dummy variable 'CPIH_perception_error_scale_2001', which is the annual CPIH rate for the prior month minus the response to Q1 (inflation in the prior 12 months).

```{r}
BOE_IAS <-
	left_join(BOE_IAS,CPIH_series %>%
              	dplyr::select(any_of(c("yyyyqq","CPIH_BOEscale_2001"))),
          	by = "yyyyqq") %>%
	mutate(CPIH_perception_error_scale_2001 = P - CPIH_BOEscale_2001) %>%
	dplyr::select(-CPIH_BOEscale_2001)
```

As above, for CPI.

```{r}
BOE_IAS <-
	left_join(BOE_IAS,CPI_series %>%
              	dplyr::select(any_of(c("yyyyqq","CPI_BOEscale_2001"))),
          	by = "yyyyqq") %>%
	mutate(CPI_perception_error_scale_2001 = P - CPI_BOEscale_2001) %>%
	dplyr::select(-CPI_BOEscale_2001)
```

##### Prediction Error (12 Months)

This creates a new dummy variable 'CPIH_prediction_error_scale_2001_12', which is the annual CPIH rate for the prior month minus the response to Q2 (inflation prediction for the next 12 months).

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_12 = yyyyqq + 100) %>% # This creates a dummy variable for a yyyyqq value 12 months ahead of the survey date
    left_join(
        CPIH_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_12", "CPIH_BOEscale_2001"))),
        by = c("yyyyqq_12" = "yyyyqq")
    ) %>% # This left join adds the CPIH value for 12 months ahead, based on the yyyyqq_12 variable created above
    mutate(CPIH_prediction_error_scale_2001_12 = E1y - CPIH_BOEscale_2001) %>% # The value for CPIH_BOEscale_2001 will be the value 12 months ahead of this survey)
    dplyr::select(-CPIH_BOEscale_2001, -yyyyqq_12)
```

As above, for CPI.

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_12 = yyyyqq + 100) %>% # This creates a dummy variable for a yyyyqq value 12 months ahead of the survey date
    left_join(
        CPI_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_12", "CPI_BOEscale_2001"))),
        by = c("yyyyqq_12" = "yyyyqq")
    ) %>% # This left join adds the CPI value for 12 months ahead, based on the yyyyqq_12 variable created above
    mutate(CPI_prediction_error_scale_2001_12 = E1y - CPI_BOEscale_2001) %>% # The value for CPI_BOEscale_2001 will be the value 12 months ahead of this survey)
    dplyr::select(-CPI_BOEscale_2001, -yyyyqq_12)
```

##### Prediction Error (24 Months)

This creates a new dummy variable 'CPIH_prediction_error_scale_2001_24', which is the annual CPIH rate for the prior month minus the response to Q2 (inflation prediction for the next 2 years).

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_24 = yyyyqq + 200) %>% # This creates a dummy variable for a yyyyqq value 24 months ahead of the survey date
    left_join(
        CPIH_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_24", "CPIH_BOEscale_2001"))),
        by = c("yyyyqq_24" = "yyyyqq")
    ) %>% # This left join adds the CPIH value for 24 months ahead, based on the yyyyqq_24 variable created above
    mutate(CPIH_prediction_error_scale_2001_24 =  E2y - CPIH_BOEscale_2001) %>% # The value for CPIH_BOEscale_2001 will be the value 24 months ahead of this survey)
    dplyr::select(-CPIH_BOEscale_2001, -yyyyqq_24)
```

As above, for CPI

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_24 = yyyyqq + 200) %>% # This creates a dummy variable for a yyyyqq value 24 months ahead of the survey date
    left_join(
        CPI_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_24", "CPI_BOEscale_2001"))),
        by = c("yyyyqq_24" = "yyyyqq")
    ) %>% # This left join adds the CPI value for 24 months ahead, based on the yyyyqq_24 variable created above
    mutate(CPI_prediction_error_scale_2001_24 =  E2y - CPI_BOEscale_2001) %>% # The value for CPI_BOEscale_2001 will be the value 24 months ahead of this survey)
    dplyr::select(-CPI_BOEscale_2001, -yyyyqq_24)
```

##### Prediction Error (60 Months)

This creates a new dummy variable 'CPIH_prediction_error_scale_2001_60', which is the annual CPIH rate for the prior month minus the response to Q2 (inflation prediction for the next 5 years).

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_60 = yyyyqq + 500) %>% # This creates a dummy variable for a yyyyqq value 60 months ahead of the survey date
    left_join(
        CPIH_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_60", "CPIH_BOEscale_2001"))),
        by = c("yyyyqq_60" = "yyyyqq")
    ) %>% # This left join adds the CPIH value for 60 months ahead, based on the yyyyqq_60 variable created above
    mutate(CPIH_prediction_error_scale_2001_60 = E5y - CPIH_BOEscale_2001) %>% # The value for CPIH_BOEscale_2001 will be the value 60 months ahead of this survey)
    dplyr::select(-CPIH_BOEscale_2001, -yyyyqq_60)
```

As above, for CPI.

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_60 = yyyyqq + 500) %>% # This creates a dummy variable for a yyyyqq value 60 months ahead of the survey date
    left_join(
        CPI_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_60", "CPI_BOEscale_2001"))),
        by = c("yyyyqq_60" = "yyyyqq")
    ) %>% # This left join adds the CPI value for 60 months ahead, based on the yyyyqq_60 variable created above
    mutate(CPI_prediction_error_scale_2001_60 = E5y - CPI_BOEscale_2001) %>% # The value for CPI_BOEscale_2001 will be the value 60 months ahead of this survey)
    dplyr::select(-CPI_BOEscale_2001, -yyyyqq_60)
```

#### Calculating Error Using BoE's 2009 Scaling

This applies the interval scaling from BoE inflation attitudes survey from 2009 (i.e. the scaling applied in the P_all, E1y_all, E2y_all, and E5y_all variables)

##### Perception Error

This creates a new dummy variable 'CPIH_perception_error_scale_2009', which is the annual CPIH rate for the prior month minus the response to Q1 (inflation in the prior 12 months).

```{r}
BOE_IAS <-
	left_join(BOE_IAS,CPIH_series %>%
              	dplyr::select(any_of(c("yyyyqq","CPIH_BOEscale_2009"))),
          	by = "yyyyqq") %>%
	mutate(CPIH_perception_error_scale_2009 = P_all - CPIH_BOEscale_2009) %>%
  dplyr::select(-CPIH_BOEscale_2009)
```

As above, for CPI.

```{r}
BOE_IAS <-
	left_join(BOE_IAS,CPI_series %>%
              	dplyr::select(any_of(c("yyyyqq","CPI_BOEscale_2009"))),
          	by = "yyyyqq") %>%
	mutate(CPI_perception_error_scale_2009 = P_all - CPI_BOEscale_2009) %>%
  dplyr::select(-CPI_BOEscale_2009)
```

##### Prediction Error (12 months)

This creates a new dummy variable 'CPIH_prediction_error_scale_2009_12', which is the annual CPIH rate for the prior month minus the response to Q2 (inflation prediction for the next 12 months).

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_12 = yyyyqq + 100) %>% # This creates a dummy variable for a yyyyqq value 12 months ahead of the survey date
    left_join(
        CPIH_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_12", "CPIH_BOEscale_2009"))),
        by = c("yyyyqq_12" = "yyyyqq")
    ) %>% # This left join adds the CPIH value for 12 months ahead, based on the yyyyqq_12 variable created above
    mutate(CPIH_prediction_error_scale_2009_12 = E1y_all - CPIH_BOEscale_2009) %>% # The value for CPIH_BOEscale_2009 will be the value 12 months ahead of this survey)
    dplyr::select(-CPIH_BOEscale_2009,-yyyyqq_12)
```

As above, for CPI.

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_12 = yyyyqq + 100) %>% # This creates a dummy variable for a yyyyqq value 12 months ahead of the survey date
    left_join(
        CPI_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_12", "CPI_BOEscale_2009"))),
        by = c("yyyyqq_12" = "yyyyqq")
    ) %>% # This left join adds the CPI value for 12 months ahead, based on the yyyyqq_12 variable created above
    mutate(CPI_prediction_error_scale_2009_12 = E1y_all - CPI_BOEscale_2009) %>% # The value for CPI_BOEscale_2009 will be the value 12 months ahead of this survey)
    dplyr::select(-CPI_BOEscale_2009,-yyyyqq_12)
```

##### Prediction Error (24 months)

This creates a new dummy variable 'CPIH_prediction_error_scale_2009_24', which is the annual CPIH rate for the prior month minus the response to Q3 (inflation prediction for the next 2 years).
```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_24 = yyyyqq + 200) %>% # This creates a dummy variable for a yyyyqq value 24 months ahead of the survey date
    left_join(
        CPIH_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_24", "CPIH_BOEscale_2009"))),
        by = c("yyyyqq_24" = "yyyyqq")
    ) %>% # This left join adds the CPIH value for 12 months ahead, based on the yyyyqq_24 variable created above
    mutate(CPIH_prediction_error_scale_2009_24 = E2y_all - CPIH_BOEscale_2009) %>% # The value for CPIH_BOEscale_2009 will be the value 24 months ahead of this survey)
    dplyr::select(-CPIH_BOEscale_2009,-yyyyqq_24)
```

As above, for CPI.

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_24 = yyyyqq + 200) %>% # This creates a dummy variable for a yyyyqq value 24 months ahead of the survey date
    left_join(
        CPI_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_24", "CPI_BOEscale_2009"))),
        by = c("yyyyqq_24" = "yyyyqq")
    ) %>% # This left join adds the CPI value for 12 months ahead, based on the yyyyqq_24 variable created above
    mutate(CPI_prediction_error_scale_2009_24 = E2y_all - CPI_BOEscale_2009) %>% # The value for CPI_BOEscale_2009 will be the value 24 months ahead of this survey)
    dplyr::select(-CPI_BOEscale_2009,-yyyyqq_24)
```

##### Prediction Error (60 months)

This creates a new dummy variable 'CPIH_prediction_error_scale_2009_60', which is the annual CPIH rate for the prior month minus the response to Q4 (inflation prediction for the next 5 years).
```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_60 = yyyyqq + 500) %>% # This creates a dummy variable for a yyyyqq value 60 months ahead of the survey date
    left_join(
        CPIH_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_60", "CPIH_BOEscale_2009"))),
        by = c("yyyyqq_60" = "yyyyqq")
    ) %>% # This left join adds the CPIH value for 60 months ahead, based on the yyyyqq_60 variable created above
    mutate(CPIH_prediction_error_scale_2009_60 = E5y_all - CPIH_BOEscale_2009) %>% # The value for CPIH_BOEscale_2009 will be the value 60 months ahead of this survey)
    dplyr::select(-CPIH_BOEscale_2009, -yyyyqq_60)
```

As above, for CPI.

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(yyyyqq_60 = yyyyqq + 500) %>% # This creates a dummy variable for a yyyyqq value 60 months ahead of the survey date
    left_join(
        CPI_series %>%
            dplyr::select(any_of(c("yyyyqq", "yyyyqq_60", "CPI_BOEscale_2009"))),
        by = c("yyyyqq_60" = "yyyyqq")
    ) %>% # This left join adds the CPI value for 60 months ahead, based on the yyyyqq_60 variable created above
    mutate(CPI_prediction_error_scale_2009_60 = E5y_all - CPI_BOEscale_2009) %>% # The value for CPI_BOEscale_2009 will be the value 60 months ahead of this survey)
    dplyr::select(-CPI_BOEscale_2009, -yyyyqq_60)
```

#### Add absolute error variables

```{r}
BOE_IAS <- BOE_IAS %>%
  mutate(CPIH_perception_error_scale_2009_abs = abs(CPIH_perception_error_scale_2009)) %>%
  mutate(CPIH_prediction_error_scale_2009_12_abs = abs(CPIH_prediction_error_scale_2009_12)) %>%
  mutate(CPIH_prediction_error_scale_2009_24_abs = abs(CPIH_prediction_error_scale_2009_24)) %>%
  mutate(CPIH_prediction_error_scale_2009_60_abs = abs(CPIH_prediction_error_scale_2009_60)) %>%
  mutate(CPI_perception_error_scale_2009_abs = abs(CPI_perception_error_scale_2009)) %>%
  mutate(CPI_prediction_error_scale_2009_12_abs = abs(CPI_prediction_error_scale_2009_12)) %>%
  mutate(CPI_prediction_error_scale_2009_24_abs = abs(CPI_prediction_error_scale_2009_24)) %>%
  mutate(CPI_prediction_error_scale_2009_60_abs = abs(CPI_prediction_error_scale_2009_60))
```


#### Adding inflation dummy variables to each observation

**Add CPIH to each observation to adjust for time-fixed inflation effects**
```{r}
BOE_IAS <-
	left_join(BOE_IAS,CPIH_series %>%
              	dplyr::select(any_of(c("yyyyqq","CPIH"))),
          	by = "yyyyqq")
```

**Add CPI to each observation to adjust for time-fixed inflation effects**
```{r}
BOE_IAS <-
	left_join(BOE_IAS,CPI_series %>%
              	dplyr::select(any_of(c("yyyyqq","CPI"))),
          	by = "yyyyqq")
```

### Interval Regression Data Preparation

#### Setting Upper and Lower Bound Variables

**Upper and lower bounds for P_all variable**

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(P_all_lower = case_when(
      P_all < -5 ~ NA,
      P_all >= -5 & P_all < -4 ~ -5,
      P_all >= -4 & P_all < -3 ~ -4,
      P_all >= -3 & P_all < -2 ~ -3,
      P_all >= -2 & P_all < -1 ~ -2,
      P_all >= -1 & P_all < 0 ~ -1,
      P_all == 0 ~ 0,
      P_all > 0 & P_all < 1 ~ 0,
      P_all >= 1 & P_all < 2 ~ 1,
      P_all >= 2 & P_all < 3 ~ 2,
      P_all >= 3 & P_all < 4 ~ 3,
      P_all >= 4 & P_all < 5 ~ 4,
      P_all >= 5 & P_all < 6 ~ 5,
      P_all >= 6 & P_all < 7 ~ 6,
      P_all >= 7 & P_all < 8 ~ 7,
      P_all >= 8 & P_all < 9 ~ 8,
      P_all >= 9 & P_all < 10 ~ 9,
      P_all >= 10 & P_all < 11 ~ 10,
      P_all >= 11 & P_all < 12 ~ 11,
      P_all >= 12 & P_all < 13 ~ 12,
      P_all >= 13 & P_all < 14 ~ 13,
      P_all >= 14 & P_all < 15 ~ 14,
      P_all > 15 ~ 15)) %>%
    mutate(P_all_upper = case_when(
      P_all < -5 ~ -5,
      P_all >= -5 & P_all < -4 ~ -4,
      P_all >= -4 & P_all < -3 ~ -3,
      P_all >= -3 & P_all < -2 ~ -2,
      P_all >= -2 & P_all < -1 ~ -1,
      P_all >= -1 & P_all < 0 ~ 0,
      P_all == 0 ~ 0,
      P_all > 0 & P_all < 1 ~ 1,
      P_all >= 1 & P_all < 2 ~ 2,
      P_all >= 2 & P_all < 3 ~ 3,
      P_all >= 3 & P_all < 4 ~ 4,
      P_all >= 4 & P_all < 5 ~ 5,
      P_all >= 5 & P_all < 6 ~ 6,
      P_all >= 6 & P_all < 7 ~ 7,
      P_all >= 7 & P_all < 8 ~ 8,
      P_all >= 8 & P_all < 9 ~ 9,
      P_all >= 9 & P_all < 10 ~ 10,
      P_all >= 10 & P_all < 11 ~ 11,
      P_all >= 11 & P_all < 12 ~ 12,
      P_all >= 12 & P_all < 13 ~ 13,
      P_all >= 13 & P_all < 14 ~ 14,
      P_all >= 14 & P_all < 15 ~ 15,
      P_all > 15 ~ NA))
```

**Upper and lower bounds for E1y_all variable**

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(E1y_all_lower = case_when(
      E1y_all < -5 ~ NA,
      E1y_all >= -5 & E1y_all < -4 ~ -5,
      E1y_all >= -4 & E1y_all < -3 ~ -4,
      E1y_all >= -3 & E1y_all < -2 ~ -3,
      E1y_all >= -2 & E1y_all < -1 ~ -2,
      E1y_all >= -1 & E1y_all < 0 ~ -1,
      E1y_all == 0 ~ 0,
      E1y_all > 0 & E1y_all < 1 ~ 0,
      E1y_all >= 1 & E1y_all < 2 ~ 1,
      E1y_all >= 2 & E1y_all < 3 ~ 2,
      E1y_all >= 3 & E1y_all < 4 ~ 3,
      E1y_all >= 4 & E1y_all < 5 ~ 4,
      E1y_all >= 5 & E1y_all < 6 ~ 5,
      E1y_all >= 6 & E1y_all < 7 ~ 6,
      E1y_all >= 7 & E1y_all < 8 ~ 7,
      E1y_all >= 8 & E1y_all < 9 ~ 8,
      E1y_all >= 9 & E1y_all < 10 ~ 9,
      E1y_all >= 10 & E1y_all < 11 ~ 10,
      E1y_all >= 11 & E1y_all < 12 ~ 11,
      E1y_all >= 12 & E1y_all < 13 ~ 12,
      E1y_all >= 13 & E1y_all < 14 ~ 13,
      E1y_all >= 14 & E1y_all < 15 ~ 14,
      E1y_all > 15 ~ 15)) %>%
    mutate(E1y_all_upper = case_when(
      E1y_all < -5 ~ -5,
      E1y_all >= -5 & E1y_all < -4 ~ -4,
      E1y_all >= -4 & E1y_all < -3 ~ -3,
      E1y_all >= -3 & E1y_all < -2 ~ -2,
      E1y_all >= -2 & E1y_all < -1 ~ -1,
      E1y_all >= -1 & E1y_all < 0 ~ 0,
      E1y_all == 0 ~ 0,
      E1y_all > 0 & E1y_all < 1 ~ 1,
      E1y_all >= 1 & E1y_all < 2 ~ 2,
      E1y_all >= 2 & E1y_all < 3 ~ 3,
      E1y_all >= 3 & E1y_all < 4 ~ 4,
      E1y_all >= 4 & E1y_all < 5 ~ 5,
      E1y_all >= 5 & E1y_all < 6 ~ 6,
      E1y_all >= 6 & E1y_all < 7 ~ 7,
      E1y_all >= 7 & E1y_all < 8 ~ 8,
      E1y_all >= 8 & E1y_all < 9 ~ 9,
      E1y_all >= 9 & E1y_all < 10 ~ 10,
      E1y_all >= 10 & E1y_all < 11 ~ 11,
      E1y_all >= 11 & E1y_all < 12 ~ 12,
      E1y_all >= 12 & E1y_all < 13 ~ 13,
      E1y_all >= 13 & E1y_all < 14 ~ 14,
      E1y_all >= 14 & E1y_all < 15 ~ 15,
      E1y_all > 15 ~ NA))
```

**Upper and lower bounds for E2y_all variable**

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(E2y_all_lower = case_when(
      E2y_all < -5 ~ NA,
      E2y_all >= -5 & E2y_all < -4 ~ -5,
      E2y_all >= -4 & E2y_all < -3 ~ -4,
      E2y_all >= -3 & E2y_all < -2 ~ -3,
      E2y_all >= -2 & E2y_all < -1 ~ -2,
      E2y_all >= -1 & E2y_all < 0 ~ -1,
      E2y_all == 0 ~ 0,
      E2y_all > 0 & E2y_all < 1 ~ 0,
      E2y_all >= 1 & E2y_all < 2 ~ 1,
      E2y_all >= 2 & E2y_all < 3 ~ 2,
      E2y_all >= 3 & E2y_all < 4 ~ 3,
      E2y_all >= 4 & E2y_all < 5 ~ 4,
      E2y_all >= 5 & E2y_all < 6 ~ 5,
      E2y_all >= 6 & E2y_all < 7 ~ 6,
      E2y_all >= 7 & E2y_all < 8 ~ 7,
      E2y_all >= 8 & E2y_all < 9 ~ 8,
      E2y_all >= 9 & E2y_all < 10 ~ 9,
      E2y_all >= 10 & E2y_all < 11 ~ 10,
      E2y_all >= 11 & E2y_all < 12 ~ 11,
      E2y_all >= 12 & E2y_all < 13 ~ 12,
      E2y_all >= 13 & E2y_all < 14 ~ 13,
      E2y_all >= 14 & E2y_all < 15 ~ 14,
      E2y_all > 15 ~ 15)) %>%
    mutate(E2y_all_upper = case_when(
      E2y_all < -5 ~ -5,
      E2y_all >= -5 & E2y_all < -4 ~ -4,
      E2y_all >= -4 & E2y_all < -3 ~ -3,
      E2y_all >= -3 & E2y_all < -2 ~ -2,
      E2y_all >= -2 & E2y_all < -1 ~ -1,
      E2y_all >= -1 & E2y_all < 0 ~ 0,
      E2y_all == 0 ~ 0,
      E2y_all > 0 & E2y_all < 1 ~ 1,
      E2y_all >= 1 & E2y_all < 2 ~ 2,
      E2y_all >= 2 & E2y_all < 3 ~ 3,
      E2y_all >= 3 & E2y_all < 4 ~ 4,
      E2y_all >= 4 & E2y_all < 5 ~ 5,
      E2y_all >= 5 & E2y_all < 6 ~ 6,
      E2y_all >= 6 & E2y_all < 7 ~ 7,
      E2y_all >= 7 & E2y_all < 8 ~ 8,
      E2y_all >= 8 & E2y_all < 9 ~ 9,
      E2y_all >= 9 & E2y_all < 10 ~ 10,
      E2y_all >= 10 & E2y_all < 11 ~ 11,
      E2y_all >= 11 & E2y_all < 12 ~ 12,
      E2y_all >= 12 & E2y_all < 13 ~ 13,
      E2y_all >= 13 & E2y_all < 14 ~ 14,
      E2y_all >= 14 & E2y_all < 15 ~ 15,
      E2y_all > 15 ~ NA))
```

**Upper and lower bounds for E5y_all variable**

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(E5y_all_lower = case_when(
      E5y_all < -5 ~ NA,
      E5y_all >= -5 & E5y_all < -4 ~ -5,
      E5y_all >= -4 & E5y_all < -3 ~ -4,
      E5y_all >= -3 & E5y_all < -2 ~ -3,
      E5y_all >= -2 & E5y_all < -1 ~ -2,
      E5y_all >= -1 & E5y_all < 0 ~ -1,
      E5y_all == 0 ~ 0,
      E5y_all > 0 & E5y_all < 1 ~ 0,
      E5y_all >= 1 & E5y_all < 2 ~ 1,
      E5y_all >= 2 & E5y_all < 3 ~ 2,
      E5y_all >= 3 & E5y_all < 4 ~ 3,
      E5y_all >= 4 & E5y_all < 5 ~ 4,
      E5y_all >= 5 & E5y_all < 6 ~ 5,
      E5y_all >= 6 & E5y_all < 7 ~ 6,
      E5y_all >= 7 & E5y_all < 8 ~ 7,
      E5y_all >= 8 & E5y_all < 9 ~ 8,
      E5y_all >= 9 & E5y_all < 10 ~ 9,
      E5y_all >= 10 & E5y_all < 11 ~ 10,
      E5y_all >= 11 & E5y_all < 12 ~ 11,
      E5y_all >= 12 & E5y_all < 13 ~ 12,
      E5y_all >= 13 & E5y_all < 14 ~ 13,
      E5y_all >= 14 & E5y_all < 15 ~ 14,
      E5y_all > 15 ~ 15)) %>%
    mutate(E5y_all_upper = case_when(
      E5y_all < -5 ~ -5,
      E5y_all >= -5 & E5y_all < -4 ~ -4,
      E5y_all >= -4 & E5y_all < -3 ~ -3,
      E5y_all >= -3 & E5y_all < -2 ~ -2,
      E5y_all >= -2 & E5y_all < -1 ~ -1,
      E5y_all >= -1 & E5y_all < 0 ~ 0,
      E5y_all == 0 ~ 0,
      E5y_all > 0 & E5y_all < 1 ~ 1,
      E5y_all >= 1 & E5y_all < 2 ~ 2,
      E5y_all >= 2 & E5y_all < 3 ~ 3,
      E5y_all >= 3 & E5y_all < 4 ~ 4,
      E5y_all >= 4 & E5y_all < 5 ~ 5,
      E5y_all >= 5 & E5y_all < 6 ~ 6,
      E5y_all >= 6 & E5y_all < 7 ~ 7,
      E5y_all >= 7 & E5y_all < 8 ~ 8,
      E5y_all >= 8 & E5y_all < 9 ~ 9,
      E5y_all >= 9 & E5y_all < 10 ~ 10,
      E5y_all >= 10 & E5y_all < 11 ~ 11,
      E5y_all >= 11 & E5y_all < 12 ~ 12,
      E5y_all >= 12 & E5y_all < 13 ~ 13,
      E5y_all >= 13 & E5y_all < 14 ~ 14,
      E5y_all >= 14 & E5y_all < 15 ~ 15,
      E5y_all > 15 ~ NA))
```

**Upper and lower bounds for CPIH_perception_error_scale_2009 variable**

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(CPIH_perception_error_scale_2009_lower = case_when(
      CPIH_perception_error_scale_2009 < -5 ~ NA,
      CPIH_perception_error_scale_2009 >= -5 & CPIH_perception_error_scale_2009 < -4 ~ -5,
      CPIH_perception_error_scale_2009 >= -4 & CPIH_perception_error_scale_2009 < -3 ~ -4,
      CPIH_perception_error_scale_2009 >= -3 & CPIH_perception_error_scale_2009 < -2 ~ -3,
      CPIH_perception_error_scale_2009 >= -2 & CPIH_perception_error_scale_2009 < -1 ~ -2,
      CPIH_perception_error_scale_2009 >= -1 & CPIH_perception_error_scale_2009 < 0 ~ -1,
      CPIH_perception_error_scale_2009 == 0 ~ 0,
      CPIH_perception_error_scale_2009 > 0 & CPIH_perception_error_scale_2009 < 1 ~ 0,
      CPIH_perception_error_scale_2009 >= 1 & CPIH_perception_error_scale_2009 < 2 ~ 1,
      CPIH_perception_error_scale_2009 >= 2 & CPIH_perception_error_scale_2009 < 3 ~ 2,
      CPIH_perception_error_scale_2009 >= 3 & CPIH_perception_error_scale_2009 < 4 ~ 3,
      CPIH_perception_error_scale_2009 >= 4 & CPIH_perception_error_scale_2009 < 5 ~ 4,
      CPIH_perception_error_scale_2009 >= 5 & CPIH_perception_error_scale_2009 < 6 ~ 5,
      CPIH_perception_error_scale_2009 >= 6 & CPIH_perception_error_scale_2009 < 7 ~ 6,
      CPIH_perception_error_scale_2009 >= 7 & CPIH_perception_error_scale_2009 < 8 ~ 7,
      CPIH_perception_error_scale_2009 >= 8 & CPIH_perception_error_scale_2009 < 9 ~ 8,
      CPIH_perception_error_scale_2009 >= 9 & CPIH_perception_error_scale_2009 < 10 ~ 9,
      CPIH_perception_error_scale_2009 >= 10 & CPIH_perception_error_scale_2009 < 11 ~ 10,
      CPIH_perception_error_scale_2009 >= 11 & CPIH_perception_error_scale_2009 < 12 ~ 11,
      CPIH_perception_error_scale_2009 >= 12 & CPIH_perception_error_scale_2009 < 13 ~ 12,
      CPIH_perception_error_scale_2009 >= 13 & CPIH_perception_error_scale_2009 < 14 ~ 13,
      CPIH_perception_error_scale_2009 >= 14 & CPIH_perception_error_scale_2009 < 15 ~ 14,
      CPIH_perception_error_scale_2009 > 15 ~ 15)) %>%
    mutate(CPIH_perception_error_scale_2009_upper = case_when(
      CPIH_perception_error_scale_2009 < -5 ~ -5,
      CPIH_perception_error_scale_2009 >= -5 & CPIH_perception_error_scale_2009 < -4 ~ -4,
      CPIH_perception_error_scale_2009 >= -4 & CPIH_perception_error_scale_2009 < -3 ~ -3,
      CPIH_perception_error_scale_2009 >= -3 & CPIH_perception_error_scale_2009 < -2 ~ -2,
      CPIH_perception_error_scale_2009 >= -2 & CPIH_perception_error_scale_2009 < -1 ~ -1,
      CPIH_perception_error_scale_2009 >= -1 & CPIH_perception_error_scale_2009 < 0 ~ 0,
      CPIH_perception_error_scale_2009 == 0 ~ 0,
      CPIH_perception_error_scale_2009 > 0 & CPIH_perception_error_scale_2009 < 1 ~ 1,
      CPIH_perception_error_scale_2009 >= 1 & CPIH_perception_error_scale_2009 < 2 ~ 2,
      CPIH_perception_error_scale_2009 >= 2 & CPIH_perception_error_scale_2009 < 3 ~ 3,
      CPIH_perception_error_scale_2009 >= 3 & CPIH_perception_error_scale_2009 < 4 ~ 4,
      CPIH_perception_error_scale_2009 >= 4 & CPIH_perception_error_scale_2009 < 5 ~ 5,
      CPIH_perception_error_scale_2009 >= 5 & CPIH_perception_error_scale_2009 < 6 ~ 6,
      CPIH_perception_error_scale_2009 >= 6 & CPIH_perception_error_scale_2009 < 7 ~ 7,
      CPIH_perception_error_scale_2009 >= 7 & CPIH_perception_error_scale_2009 < 8 ~ 8,
      CPIH_perception_error_scale_2009 >= 8 & CPIH_perception_error_scale_2009 < 9 ~ 9,
      CPIH_perception_error_scale_2009 >= 9 & CPIH_perception_error_scale_2009 < 10 ~ 10,
      CPIH_perception_error_scale_2009 >= 10 & CPIH_perception_error_scale_2009 < 11 ~ 11,
      CPIH_perception_error_scale_2009 >= 11 & CPIH_perception_error_scale_2009 < 12 ~ 12,
      CPIH_perception_error_scale_2009 >= 12 & CPIH_perception_error_scale_2009 < 13 ~ 13,
      CPIH_perception_error_scale_2009 >= 13 & CPIH_perception_error_scale_2009 < 14 ~ 14,
      CPIH_perception_error_scale_2009 >= 14 & CPIH_perception_error_scale_2009 < 15 ~ 15,
      CPIH_perception_error_scale_2009 > 15 ~ NA))
```

**Upper and lower bounds for CPIH_prediction_error_scale_2009_12 variable**

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(CPIH_prediction_error_scale_2009_12_lower = case_when(
      CPIH_prediction_error_scale_2009_12 < -5 ~ NA,
      CPIH_prediction_error_scale_2009_12 >= -5 & CPIH_prediction_error_scale_2009_12 < -4 ~ -5,
      CPIH_prediction_error_scale_2009_12 >= -4 & CPIH_prediction_error_scale_2009_12 < -3 ~ -4,
      CPIH_prediction_error_scale_2009_12 >= -3 & CPIH_prediction_error_scale_2009_12 < -2 ~ -3,
      CPIH_prediction_error_scale_2009_12 >= -2 & CPIH_prediction_error_scale_2009_12 < -1 ~ -2,
      CPIH_prediction_error_scale_2009_12 >= -1 & CPIH_prediction_error_scale_2009_12 < 0 ~ -1,
      CPIH_prediction_error_scale_2009_12 == 0 ~ 0,
      CPIH_prediction_error_scale_2009_12 > 0 & CPIH_prediction_error_scale_2009_12 < 1 ~ 0,
      CPIH_prediction_error_scale_2009_12 >= 1 & CPIH_prediction_error_scale_2009_12 < 2 ~ 1,
      CPIH_prediction_error_scale_2009_12 >= 2 & CPIH_prediction_error_scale_2009_12 < 3 ~ 2,
      CPIH_prediction_error_scale_2009_12 >= 3 & CPIH_prediction_error_scale_2009_12 < 4 ~ 3,
      CPIH_prediction_error_scale_2009_12 >= 4 & CPIH_prediction_error_scale_2009_12 < 5 ~ 4,
      CPIH_prediction_error_scale_2009_12 >= 5 & CPIH_prediction_error_scale_2009_12 < 6 ~ 5,
      CPIH_prediction_error_scale_2009_12 >= 6 & CPIH_prediction_error_scale_2009_12 < 7 ~ 6,
      CPIH_prediction_error_scale_2009_12 >= 7 & CPIH_prediction_error_scale_2009_12 < 8 ~ 7,
      CPIH_prediction_error_scale_2009_12 >= 8 & CPIH_prediction_error_scale_2009_12 < 9 ~ 8,
      CPIH_prediction_error_scale_2009_12 >= 9 & CPIH_prediction_error_scale_2009_12 < 10 ~ 9,
      CPIH_prediction_error_scale_2009_12 >= 10 & CPIH_prediction_error_scale_2009_12 < 11 ~ 10,
      CPIH_prediction_error_scale_2009_12 >= 11 & CPIH_prediction_error_scale_2009_12 < 12 ~ 11,
      CPIH_prediction_error_scale_2009_12 >= 12 & CPIH_prediction_error_scale_2009_12 < 13 ~ 12,
      CPIH_prediction_error_scale_2009_12 >= 13 & CPIH_prediction_error_scale_2009_12 < 14 ~ 13,
      CPIH_prediction_error_scale_2009_12 >= 14 & CPIH_prediction_error_scale_2009_12 < 15 ~ 14,
      CPIH_prediction_error_scale_2009_12 > 15 ~ 15)) %>%
    mutate(CPIH_prediction_error_scale_2009_12_upper = case_when(
      CPIH_prediction_error_scale_2009_12 < -5 ~ -5,
      CPIH_prediction_error_scale_2009_12 >= -5 & CPIH_prediction_error_scale_2009_12 < -4 ~ -4,
      CPIH_prediction_error_scale_2009_12 >= -4 & CPIH_prediction_error_scale_2009_12 < -3 ~ -3,
      CPIH_prediction_error_scale_2009_12 >= -3 & CPIH_prediction_error_scale_2009_12 < -2 ~ -2,
      CPIH_prediction_error_scale_2009_12 >= -2 & CPIH_prediction_error_scale_2009_12 < -1 ~ -1,
      CPIH_prediction_error_scale_2009_12 >= -1 & CPIH_prediction_error_scale_2009_12 < 0 ~ 0,
      CPIH_prediction_error_scale_2009_12 == 0 ~ 0,
      CPIH_prediction_error_scale_2009_12 > 0 & CPIH_prediction_error_scale_2009_12 < 1 ~ 1,
      CPIH_prediction_error_scale_2009_12 >= 1 & CPIH_prediction_error_scale_2009_12 < 2 ~ 2,
      CPIH_prediction_error_scale_2009_12 >= 2 & CPIH_prediction_error_scale_2009_12 < 3 ~ 3,
      CPIH_prediction_error_scale_2009_12 >= 3 & CPIH_prediction_error_scale_2009_12 < 4 ~ 4,
      CPIH_prediction_error_scale_2009_12 >= 4 & CPIH_prediction_error_scale_2009_12 < 5 ~ 5,
      CPIH_prediction_error_scale_2009_12 >= 5 & CPIH_prediction_error_scale_2009_12 < 6 ~ 6,
      CPIH_prediction_error_scale_2009_12 >= 6 & CPIH_prediction_error_scale_2009_12 < 7 ~ 7,
      CPIH_prediction_error_scale_2009_12 >= 7 & CPIH_prediction_error_scale_2009_12 < 8 ~ 8,
      CPIH_prediction_error_scale_2009_12 >= 8 & CPIH_prediction_error_scale_2009_12 < 9 ~ 9,
      CPIH_prediction_error_scale_2009_12 >= 9 & CPIH_prediction_error_scale_2009_12 < 10 ~ 10,
      CPIH_prediction_error_scale_2009_12 >= 10 & CPIH_prediction_error_scale_2009_12 < 11 ~ 11,
      CPIH_prediction_error_scale_2009_12 >= 11 & CPIH_prediction_error_scale_2009_12 < 12 ~ 12,
      CPIH_prediction_error_scale_2009_12 >= 12 & CPIH_prediction_error_scale_2009_12 < 13 ~ 13,
      CPIH_prediction_error_scale_2009_12 >= 13 & CPIH_prediction_error_scale_2009_12 < 14 ~ 14,
      CPIH_prediction_error_scale_2009_12 >= 14 & CPIH_prediction_error_scale_2009_12 < 15 ~ 15,
      CPIH_prediction_error_scale_2009_12 > 15 ~ NA))
```

**Upper and lower bounds for CPIH_prediction_error_scale_2009_24 variable**

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(CPIH_prediction_error_scale_2009_24_lower = case_when(
      CPIH_prediction_error_scale_2009_24 < -5 ~ NA,
      CPIH_prediction_error_scale_2009_24 >= -5 & CPIH_prediction_error_scale_2009_24 < -4 ~ -5,
      CPIH_prediction_error_scale_2009_24 >= -4 & CPIH_prediction_error_scale_2009_24 < -3 ~ -4,
      CPIH_prediction_error_scale_2009_24 >= -3 & CPIH_prediction_error_scale_2009_24 < -2 ~ -3,
      CPIH_prediction_error_scale_2009_24 >= -2 & CPIH_prediction_error_scale_2009_24 < -1 ~ -2,
      CPIH_prediction_error_scale_2009_24 >= -1 & CPIH_prediction_error_scale_2009_24 < 0 ~ -1,
      CPIH_prediction_error_scale_2009_24 == 0 ~ 0,
      CPIH_prediction_error_scale_2009_24 > 0 & CPIH_prediction_error_scale_2009_24 < 1 ~ 0,
      CPIH_prediction_error_scale_2009_24 >= 1 & CPIH_prediction_error_scale_2009_24 < 2 ~ 1,
      CPIH_prediction_error_scale_2009_24 >= 2 & CPIH_prediction_error_scale_2009_24 < 3 ~ 2,
      CPIH_prediction_error_scale_2009_24 >= 3 & CPIH_prediction_error_scale_2009_24 < 4 ~ 3,
      CPIH_prediction_error_scale_2009_24 >= 4 & CPIH_prediction_error_scale_2009_24 < 5 ~ 4,
      CPIH_prediction_error_scale_2009_24 >= 5 & CPIH_prediction_error_scale_2009_24 < 6 ~ 5,
      CPIH_prediction_error_scale_2009_24 >= 6 & CPIH_prediction_error_scale_2009_24 < 7 ~ 6,
      CPIH_prediction_error_scale_2009_24 >= 7 & CPIH_prediction_error_scale_2009_24 < 8 ~ 7,
      CPIH_prediction_error_scale_2009_24 >= 8 & CPIH_prediction_error_scale_2009_24 < 9 ~ 8,
      CPIH_prediction_error_scale_2009_24 >= 9 & CPIH_prediction_error_scale_2009_24 < 10 ~ 9,
      CPIH_prediction_error_scale_2009_24 >= 10 & CPIH_prediction_error_scale_2009_24 < 11 ~ 10,
      CPIH_prediction_error_scale_2009_24 >= 11 & CPIH_prediction_error_scale_2009_24 < 12 ~ 11,
      CPIH_prediction_error_scale_2009_24 >= 12 & CPIH_prediction_error_scale_2009_24 < 13 ~ 12,
      CPIH_prediction_error_scale_2009_24 >= 13 & CPIH_prediction_error_scale_2009_24 < 14 ~ 13,
      CPIH_prediction_error_scale_2009_24 >= 14 & CPIH_prediction_error_scale_2009_24 < 15 ~ 14,
      CPIH_prediction_error_scale_2009_24 > 15 ~ 15)) %>%
    mutate(CPIH_prediction_error_scale_2009_24_upper = case_when(
      CPIH_prediction_error_scale_2009_24 < -5 ~ -5,
      CPIH_prediction_error_scale_2009_24 >= -5 & CPIH_prediction_error_scale_2009_24 < -4 ~ -4,
      CPIH_prediction_error_scale_2009_24 >= -4 & CPIH_prediction_error_scale_2009_24 < -3 ~ -3,
      CPIH_prediction_error_scale_2009_24 >= -3 & CPIH_prediction_error_scale_2009_24 < -2 ~ -2,
      CPIH_prediction_error_scale_2009_24 >= -2 & CPIH_prediction_error_scale_2009_24 < -1 ~ -1,
      CPIH_prediction_error_scale_2009_24 >= -1 & CPIH_prediction_error_scale_2009_24 < 0 ~ 0,
      CPIH_prediction_error_scale_2009_24 == 0 ~ 0,
      CPIH_prediction_error_scale_2009_24 > 0 & CPIH_prediction_error_scale_2009_24 < 1 ~ 1,
      CPIH_prediction_error_scale_2009_24 >= 1 & CPIH_prediction_error_scale_2009_24 < 2 ~ 2,
      CPIH_prediction_error_scale_2009_24 >= 2 & CPIH_prediction_error_scale_2009_24 < 3 ~ 3,
      CPIH_prediction_error_scale_2009_24 >= 3 & CPIH_prediction_error_scale_2009_24 < 4 ~ 4,
      CPIH_prediction_error_scale_2009_24 >= 4 & CPIH_prediction_error_scale_2009_24 < 5 ~ 5,
      CPIH_prediction_error_scale_2009_24 >= 5 & CPIH_prediction_error_scale_2009_24 < 6 ~ 6,
      CPIH_prediction_error_scale_2009_24 >= 6 & CPIH_prediction_error_scale_2009_24 < 7 ~ 7,
      CPIH_prediction_error_scale_2009_24 >= 7 & CPIH_prediction_error_scale_2009_24 < 8 ~ 8,
      CPIH_prediction_error_scale_2009_24 >= 8 & CPIH_prediction_error_scale_2009_24 < 9 ~ 9,
      CPIH_prediction_error_scale_2009_24 >= 9 & CPIH_prediction_error_scale_2009_24 < 10 ~ 10,
      CPIH_prediction_error_scale_2009_24 >= 10 & CPIH_prediction_error_scale_2009_24 < 11 ~ 11,
      CPIH_prediction_error_scale_2009_24 >= 11 & CPIH_prediction_error_scale_2009_24 < 12 ~ 12,
      CPIH_prediction_error_scale_2009_24 >= 12 & CPIH_prediction_error_scale_2009_24 < 13 ~ 13,
      CPIH_prediction_error_scale_2009_24 >= 13 & CPIH_prediction_error_scale_2009_24 < 14 ~ 14,
      CPIH_prediction_error_scale_2009_24 >= 14 & CPIH_prediction_error_scale_2009_24 < 15 ~ 15,
      CPIH_prediction_error_scale_2009_24 > 15 ~ NA))
```

**Upper and lower bounds for CPIH_prediction_error_scale_2009_60 variable**

```{r}
BOE_IAS <- BOE_IAS %>%
    mutate(CPIH_prediction_error_scale_2009_60_lower = case_when(
      CPIH_prediction_error_scale_2009_60 < -5 ~ NA,
      CPIH_prediction_error_scale_2009_60 >= -5 & CPIH_prediction_error_scale_2009_60 < -4 ~ -5,
      CPIH_prediction_error_scale_2009_60 >= -4 & CPIH_prediction_error_scale_2009_60 < -3 ~ -4,
      CPIH_prediction_error_scale_2009_60 >= -3 & CPIH_prediction_error_scale_2009_60 < -2 ~ -3,
      CPIH_prediction_error_scale_2009_60 >= -2 & CPIH_prediction_error_scale_2009_60 < -1 ~ -2,
      CPIH_prediction_error_scale_2009_60 >= -1 & CPIH_prediction_error_scale_2009_60 < 0 ~ -1,
      CPIH_prediction_error_scale_2009_60 == 0 ~ 0,
      CPIH_prediction_error_scale_2009_60 > 0 & CPIH_prediction_error_scale_2009_60 < 1 ~ 0,
      CPIH_prediction_error_scale_2009_60 >= 1 & CPIH_prediction_error_scale_2009_60 < 2 ~ 1,
      CPIH_prediction_error_scale_2009_60 >= 2 & CPIH_prediction_error_scale_2009_60 < 3 ~ 2,
      CPIH_prediction_error_scale_2009_60 >= 3 & CPIH_prediction_error_scale_2009_60 < 4 ~ 3,
      CPIH_prediction_error_scale_2009_60 >= 4 & CPIH_prediction_error_scale_2009_60 < 5 ~ 4,
      CPIH_prediction_error_scale_2009_60 >= 5 & CPIH_prediction_error_scale_2009_60 < 6 ~ 5,
      CPIH_prediction_error_scale_2009_60 >= 6 & CPIH_prediction_error_scale_2009_60 < 7 ~ 6,
      CPIH_prediction_error_scale_2009_60 >= 7 & CPIH_prediction_error_scale_2009_60 < 8 ~ 7,
      CPIH_prediction_error_scale_2009_60 >= 8 & CPIH_prediction_error_scale_2009_60 < 9 ~ 8,
      CPIH_prediction_error_scale_2009_60 >= 9 & CPIH_prediction_error_scale_2009_60 < 10 ~ 9,
      CPIH_prediction_error_scale_2009_60 >= 10 & CPIH_prediction_error_scale_2009_60 < 11 ~ 10,
      CPIH_prediction_error_scale_2009_60 >= 11 & CPIH_prediction_error_scale_2009_60 < 12 ~ 11,
      CPIH_prediction_error_scale_2009_60 >= 12 & CPIH_prediction_error_scale_2009_60 < 13 ~ 12,
      CPIH_prediction_error_scale_2009_60 >= 13 & CPIH_prediction_error_scale_2009_60 < 14 ~ 13,
      CPIH_prediction_error_scale_2009_60 >= 14 & CPIH_prediction_error_scale_2009_60 < 15 ~ 14,
      CPIH_prediction_error_scale_2009_60 > 15 ~ 15)) %>%
    mutate(CPIH_prediction_error_scale_2009_60_upper = case_when(
      CPIH_prediction_error_scale_2009_60 < -5 ~ -5,
      CPIH_prediction_error_scale_2009_60 >= -5 & CPIH_prediction_error_scale_2009_60 < -4 ~ -4,
      CPIH_prediction_error_scale_2009_60 >= -4 & CPIH_prediction_error_scale_2009_60 < -3 ~ -3,
      CPIH_prediction_error_scale_2009_60 >= -3 & CPIH_prediction_error_scale_2009_60 < -2 ~ -2,
      CPIH_prediction_error_scale_2009_60 >= -2 & CPIH_prediction_error_scale_2009_60 < -1 ~ -1,
      CPIH_prediction_error_scale_2009_60 >= -1 & CPIH_prediction_error_scale_2009_60 < 0 ~ 0,
      CPIH_prediction_error_scale_2009_60 == 0 ~ 0,
      CPIH_prediction_error_scale_2009_60 > 0 & CPIH_prediction_error_scale_2009_60 < 1 ~ 1,
      CPIH_prediction_error_scale_2009_60 >= 1 & CPIH_prediction_error_scale_2009_60 < 2 ~ 2,
      CPIH_prediction_error_scale_2009_60 >= 2 & CPIH_prediction_error_scale_2009_60 < 3 ~ 3,
      CPIH_prediction_error_scale_2009_60 >= 3 & CPIH_prediction_error_scale_2009_60 < 4 ~ 4,
      CPIH_prediction_error_scale_2009_60 >= 4 & CPIH_prediction_error_scale_2009_60 < 5 ~ 5,
      CPIH_prediction_error_scale_2009_60 >= 5 & CPIH_prediction_error_scale_2009_60 < 6 ~ 6,
      CPIH_prediction_error_scale_2009_60 >= 6 & CPIH_prediction_error_scale_2009_60 < 7 ~ 7,
      CPIH_prediction_error_scale_2009_60 >= 7 & CPIH_prediction_error_scale_2009_60 < 8 ~ 8,
      CPIH_prediction_error_scale_2009_60 >= 8 & CPIH_prediction_error_scale_2009_60 < 9 ~ 9,
      CPIH_prediction_error_scale_2009_60 >= 9 & CPIH_prediction_error_scale_2009_60 < 10 ~ 10,
      CPIH_prediction_error_scale_2009_60 >= 10 & CPIH_prediction_error_scale_2009_60 < 11 ~ 11,
      CPIH_prediction_error_scale_2009_60 >= 11 & CPIH_prediction_error_scale_2009_60 < 12 ~ 12,
      CPIH_prediction_error_scale_2009_60 >= 12 & CPIH_prediction_error_scale_2009_60 < 13 ~ 13,
      CPIH_prediction_error_scale_2009_60 >= 13 & CPIH_prediction_error_scale_2009_60 < 14 ~ 14,
      CPIH_prediction_error_scale_2009_60 >= 14 & CPIH_prediction_error_scale_2009_60 < 15 ~ 15,
      CPIH_prediction_error_scale_2009_60 > 15 ~ NA))
```

### Re-Scaling Demographic Indicators

**Income**
```{r}
BOE_IAS <- BOE_IAS %>%
  mutate(income_fix = case_when(
    income == 1 ~ 1,
    income == 2 ~ 2,
    income == 3 ~ 3,
    income == 4 ~ 5,
    income == 5 ~ 4,
    income == 6 ~ 5,
    income == 7 ~ 1,
    income == 8 ~ 2,
    income == 9 ~ 3,
    income == 10 ~ 4,
    income == 11 ~ 5)
    )
```

### Legible X-Axis for Time Series Data

```{r}
BOE_IAS_x_scale <- data.frame(yyyyqq = unique(BOE_IAS$yyyyqq),
                              timetrend = unique(BOE_IAS$timetrend)
)
BOE_IAS_x_scale$yyyyqq_scale = as.character(BOE_IAS_x_scale$yyyyqq)
BOE_IAS_x_scale$yyyyqq_scale = paste0(substr(BOE_IAS_x_scale$yyyyqq_scale,1,4)," ","Q", substr(BOE_IAS_x_scale$yyyyqq_scale,6,6), sep = '')
BOE_IAS_x_scale$yyyyqq_scale = case_when(
  substr(BOE_IAS_x_scale$yyyyqq_scale,6,7) == "Q1" ~ BOE_IAS_x_scale$yyyyqq_scale,
  TRUE ~ substr(BOE_IAS_x_scale$yyyyqq_scale,6,7)
)

```


# Figures and Tables Used in Dissertation

## Section 3: Methodology

### Section 3.1: Fundamental Intuitions

#### Figure 1: Aggregate Satisfaction in the Bank of England

**Aggregate Satisfaction in the Bank of England**
```{r}
f.1.3b.1.1 <- BOE_IAS %>%
    group_by(timetrend) %>%
    summarise(aggregate_trust = median(agg_trust)) %>%
    ggplot(aes(x = as.factor(timetrend), y = aggregate_trust, group = 1)) +
    geom_line() +
    geom_point() +
    geom_ribbon(aes(ymin=0.5, ymax=1), fill="#2E5A87FF", alpha=0.25) +
    geom_ribbon(aes(ymin=0, ymax=0.5), fill="#6998C1FF", alpha=0.25) +
    geom_ribbon(aes(ymin=-0.5, ymax=0), fill="#ED6055FF", alpha=0.25) +
    geom_ribbon(aes(ymin=-1, ymax=-0.5), fill="#A90C38FF", alpha=0.25) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale, expand = (c(0,0.1))) +
    scale_y_continuous(expand = c(0,0), limits = c(-1, NA)) +
    coord_cartesian(ylim = c(-1,1)) +
    labs(
        subtitle = "Aggregate Satisfaction in the Bank of England - 2001-2024",
        x = "Year - Quarter",
        y = "Aggregate Satisfaction") +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9)) +
    theme(text = element_text(family = "serif"))
```

**CPIH Annual Rate - Quarterly Series - 
```{r}
f.1.3a.1.1 <- BOE_IAS %>%
    group_by(timetrend) %>%
    ggplot(aes(x = as.factor(timetrend), y = CPIH, group = 1)) +
    geom_line() +
    geom_point() +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale, expand = (c(0,0.1))) +
    labs(
        subtitle = "CPIH Annual Rate Quarterly Series - Mapped to Bank of England Inflation Attitudes Survey Dates",
        x = "Year - Quarter",
        y = "CPIH") +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9)) +
    theme(text = element_text(family = "serif"))
```

```{r}
f.1.3a.1.1 / f.1.3b.1.1 +
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
      title = 'Comparison of CPIH Annual Rate to Aggregate Statisfaction in the Bank of England - 2001-2024',
      caption = 'Figure 1: Comparison of CPIH Annual Rate to Aggregate Statisfaction in the Bank of England - 2001-2024\n Top chart shows the annual CPIH rate in the United Kingdom, with the y scale for the CPIH Annual Rate.\nThe bottom chart shows aggregate satisfaction in the Bank of England over the timeframe of the Inflation Attitudes Survey series, with the y scale showing aggregate satisfaction from 1 (unanimous satisfaction) to -1 (unanimous dissatisfaction).') & theme(text = element_text(family = "serif"))
```


#### Figure 2: Proportion of Respondents' Satisfaction in Bank of England - 2001-2024

```{r}
BOE_IAS %>%
    group_by(timetrend, q14) %>%
    mutate(counter = n()) %>%
    mutate(proportion = n() / sum(n())) %>%
    ggplot(aes(x = as.factor(timetrend), y = proportion, fill = as.factor(q14))) +
    geom_col(position = "fill") +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    scale_y_continuous(labels = scales::label_percent())+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")
    ) +
    labs(
        title = "Proportion of responses to Q14 - Satisfaction with Bank of England",
        caption = "Figure 2: Proportion of responses to Q14 - Satisfaction with Bank of England. Y scale is proportion of respondents per survey",
        x = "Year - Quarter",
        y = "Proportion",
        fill = "Respondents' Satisfaction"
    ) +
    theme_minimal() +
    theme(legend.position = "top",
          axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9)) +
    theme(text = element_text(family = "serif"))+
    guides(fill = guide_legend(nrow = 1))
```

#### Figure 3: Inflation Perception Density
```{r}
ggplot(data = subset(BOE_IAS, q14 != "6" & P_all != 99), aes(x = P_all, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, colour = "black", position = "stack") +
    geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(
        title = "Inflation Perception Density (2001-2024) - Grouped by Respondents' Satisfaction with Bank of England",
        caption = "Figure 3: Inflation Perception Density (2001-2024) - Grouped by Satisfaction with Bank of England.\nY scale is count of respondents over the entire survey period. X scale is the respondents' reported perception of inflation in the prior 12 months, in bins of 0.5%.\nThe solid line is the overall respondents' mean inflation perception, and dashed lines are the mean plus (minus) the standard deviation of inflation perception.",
        x = "Inflation Perception (Intervals)",
        y = "Response Count",
        fill = "Respondents' Satisfaction:",
        linetype = "Pooled indicators") +
    theme_minimal() +
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    scale_x_continuous(breaks = round(seq(min(BOE_IAS$P_all), max(BOE_IAS$P_all), by = 0.5), 1))+
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1), text = element_text(family = "serif"))
```


#### Figure 4: Inflation Perception Density (Satisfaction Split)

**Draw Satisfied Graph**
```{r}
f.4a.3.1.1 <- ggplot(data = subset(BOE_IAS, (q14 == 1 | q14 == 2) & P_all != 99), aes(x = P_all, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, colour = "black", position = "stack") +
    geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(
        x = "Inflation Perception (Intervals)",
        y = "Response Count",
        fill = "Respondents' Satisfaction:",
        linetype = "Pooled indicators") +
    theme_minimal()+
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    scale_x_continuous(breaks = round(seq(min(BOE_IAS$P_all), max(BOE_IAS$P_all), by = 0.5), 1))+
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1), text = element_text(family = "serif")) 
plot(f.4a.3.1.1)
```

**Draw Dissatisfied Graph**

```{r}
f.4b.3.1.1 <- ggplot(data = subset(BOE_IAS, (q14 == 4 | q14 == 5) & P_all != 99), aes(x = P_all, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, colour = "black", position = "stack") +
    geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(
        x = "Inflation Perception (Intervals)",
        y = "Response Count",
        fill = "Respondents' Satisfaction:",
        linetype = "Pooled indicators") +
    theme_minimal()+
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    scale_x_continuous(breaks = round(seq(min(BOE_IAS$P_all), max(BOE_IAS$P_all), by = 0.5), 1))+
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1), text = element_text(family = "serif")) 
plot(f.4b.3.1.1)
```

**Create Figure**

```{r}
f.4a.3.1.1 + f.4b.3.1.1 +
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
      title = 'Inflation Perception Density (2001-2024)',
      subtitle = 'Split by Satisfied vs Dissatisfied',
      caption = 'Figure 4: Inflation Perception Density (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is count of respondents over the entire survey period. X scale is the respondents reported perception of inflation in the prior 12 months, in bins of 0.5%.\nThe solid line is the overall respondents mean inflation perception, and dashed lines are the mean plus (minus) the standard deviation of inflation perception.') & theme(legend.position = "top", text = element_text(family = "serif"))
```

#### Figure 5: Inflation Prediction Density
```{r}
ggplot(data = subset(BOE_IAS, q14 != "6" & E1y_all != 99), aes(x = E1y_all, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, colour = "black", position = "stack") +
    geom_vline(aes(xintercept = mean(E1y_all)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(E1y_all) + sd(E1y_all)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(E1y_all) - sd(E1y_all)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(
        title = "Inflation Prediction Density (12 Months) - 2001-2024",
        subtitle = "Grouped by Respondents' Satisfaction with Bank of England",
        caption = "Figure 5: Inflation Prediction Density (12 Months) - 2001-2024 - Grouped by Satisfaction with Bank of England.\nY scale is count of respondents over the entire survey period. X scale is the respondents' reported prediction of inflation in the next 12 months, in bins of 0.5%.\nThe solid line is the overall respondents' mean inflation prediction, and dashed lines are the mean plus (minus) the standard deviation of inflation prediction.",
        x = "Inflation Prediction (Intervals)",
        y = "Response Count",
        fill = "Respondents' Satisfaction:",
        linetype = "Pooled indicators") +
    theme_minimal() +
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    scale_x_continuous(breaks = round(seq(min(BOE_IAS$E1y_all), max(BOE_IAS$E1y_all), by = 0.5), 1))+
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1), text = element_text(family = "serif"))
```


#### Figure 6: Inflation Prediction Density (Satisfaction Split)

**Draw Satisfied Graph**
```{r}
f.6a.3.1.1 <- ggplot(data = subset(BOE_IAS, (q14 == 1 | q14 == 2) & E1y_all != 99), aes(x = E1y_all, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, colour = "black", position = "stack") +
    geom_vline(aes(xintercept = mean(E1y_all)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(E1y_all) + sd(E1y_all)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(E1y_all) - sd(E1y_all)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(
        x = "Inflation Prediction - 12 Months (Intervals)",
        y = "Response Count",
        fill = "Respondents' Satisfaction:",
        linetype = "Pooled indicators") +
    theme_minimal()+
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    scale_x_continuous(breaks = round(seq(min(BOE_IAS$E1y_all), max(BOE_IAS$E1y_all), by = 0.5), 1))+
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1), text = element_text(family = "serif")) 
plot(f.6a.3.1.1)
```

**Draw Dissatisfied Graph**

```{r}
f.6b.3.1.1 <- ggplot(data = subset(BOE_IAS, (q14 == 4 | q14 == 5) & E1y_all != 99), aes(x = E1y_all, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, colour = "black", position = "stack") +
    geom_vline(aes(xintercept = mean(E1y_all)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(E1y_all) + sd(E1y_all)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(E1y_all) - sd(E1y_all)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(
        x = "Inflation Prediction - 12 Months (Intervals)",
        y = "Response Count",
        fill = "Respondents' Satisfaction:",
        linetype = "Pooled indicators") +
    theme_minimal()+
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    scale_x_continuous(breaks = round(seq(min(BOE_IAS$E1y_all), max(BOE_IAS$E1y_all), by = 0.5), 1))+
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1), text = element_text(family = "serif")) 
plot(f.6b.3.1.1)
```

**Create Figure**

```{r}
f.6a.3.1.1 + f.6b.3.1.1 + 
  plot_layout(guides = 'collect', axes = "collect") +
  plot_annotation(
    title = 'Inflation Prediction Density - 12 Months (2001-2024)',
    subtitle = 'Split by Satisfied vs Dissatisfied',
    caption = 'Figure 6: Inflation Prediction Density - 12 Months  (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is count of respondents over the entire survey period. X scale is the respondents reported prediction of inflation in the next 12 months, in bins of 0.5%.\nThe solid line is the overall respondents mean inflation prediction, and dashed lines are the mean plus (minus) the standard deviation of inflation prediction.') & theme(legend.position = "top", text = element_text(family = "serif"))
```

#### Figure 7: Mean Inflation Perception and Perception Error over Time

**Mean Inflation Perception over Time**
```{r}
f.7.3a.1.1 <- BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(P_all), pmean = mean(P_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pmean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Mean Inflation Perception",
        x = "Year - Quarter",
        y = "Mean - Inflation Perception",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right") +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9), text = element_text(family = "serif"))
```

**Mean Perception Error over Time**
```{r}
f.7.3b.1.1 <- BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrormean = var(CPIH_perception_error_scale_2009), perrormean = mean(CPIH_perception_error_scale_2009)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrormean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Mean Perception Error",
        x = "Year - Quarter",
        y = "Mean - Perception Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right") +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9), text = element_text(family = "serif"))
```
**Draw Figure**
```{r}
f.7.3a.1.1 / f.7.3b.1.1 + 
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
        title = 'Mean Inflation Perception and Perception Error (2001-2024)',
        caption = 'Figure 7: Mean Inflation Predictions and Prediction Error (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is the mean estimation of inflation, and estimation error, of respondents over the entire survey period.')  & theme(legend.position = "top", text = element_text(family = "serif"))
```
#### Figure 8: Mean Inflation Prediction and Prediction Error over Time (12 Months)

**Mean Inflation Prediction over Time**
```{r}
f.8.3a.1.1 <- BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(E1y_all), pmean = mean(E1y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pmean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Mean Inflation Prediction (12 Months)",
        x = "Year - Quarter",
        y = "Mean - Inflation Prediction",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```

**Mean Prediction Error over Time**
```{r}
f.8.3b.1.1 <- BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrormean = var(CPIH_prediction_error_scale_2009_12), perrormean = mean(CPIH_prediction_error_scale_2009_12)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrormean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Mean Prediction Error (12 Months)",
        x = "Year - Quarter",
        y = "Mean - Prediction Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```
**Draw Figure**
```{r}
f.8.3a.1.1 / f.8.3b.1.1 + 
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
        title = 'Mean Inflation Prediction and Prediction Error (2001-2024)',
        caption = 'Figure 8: Mean Inflation Predictions and Prediction Error (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is the mean estimation of future inflation in 12 months, and estimation error, of respondents over the entire survey period.')  & theme(legend.position = "top", text = element_text(family = "serif"))
```

#### Figure 9: Density Heatmap of Perception Error vs Prediction Error (12 Months)

**Satisfied Respondents**
```{r}
f.9.3a.1.1 <- ggplot(data = subset(BOE_IAS, P_all != 99 & E1y_all !=99 & q14_binary == 0), aes(CPIH_perception_error_scale_2009, CPIH_prediction_error_scale_2009_12)) +
    geom_hex(bins = 25, colour = "white", aes(fill = log(after_stat(ncount)))) +
    scale_fill_distiller(palette = "Blues", direction = 1) +
    scale_x_continuous(breaks = seq(-16, 16)) +
    scale_y_continuous(breaks = seq(-16, 16)) +
    theme_minimal() +
    theme(legend.position = "top", text = element_text(family = "serif")) +
    labs(
        subtitle = "Satisfied Respondents",
        x = "Perception Error",
        y = "Prediction Error (12 Months)",
        fill = "Log (Bin Count)"
    )
```
**Dissatisfied Respondents**

```{r}
f.9.3b.1.1 <- ggplot(data = subset(BOE_IAS, P_all != 99 & E1y_all !=99 & q14_binary == 1), aes(CPIH_perception_error_scale_2009, CPIH_prediction_error_scale_2009_12)) +
    geom_hex(bins = 25, colour = "white", aes(fill = log(after_stat(ncount)))) +
    scale_fill_distiller(palette = "Reds", direction = 1) +
    scale_x_continuous(breaks = seq(-16, 16)) +
    scale_y_continuous(breaks = seq(-16, 16)) +
    theme_minimal() +
    theme(legend.position = "top", text = element_text(family = "serif")) +
    labs(
        subtitle = "Dissatisfied Respondents",
        x = "Perception Error",
        y = "Prediction Error (12 Months)",
        fill = "Log (Bin Count)"
    )
```

**Draw Figure**
```{r}
f.9.3a.1.1 + f.9.3b.1.1 +
    plot_layout(axis_titles = "collect") +
    plot_annotation(
        title = 'Density Heatmap of Perception Error vs Prediction Error (12 Months)',
        caption = "Figure 9: Density Heatmap of Perception Error vs Prediction Error (12 Months) - Split by Satisfied vs Dissatisfied\nY scale is count of respondents over the entire survey period. X scale is the respondents reported prediction of inflation in the prior 12 months, in bins of 0.5%.\nThe solid line is the overall respondents mean inflation prediction, and dashed lines are the mean plus (minus) the standard deviation of inflation prediction.") & theme(legend.position = "bottom", text = element_text(family = "serif"))
```

#### Figure 10: Comparing Distributions of Responses 2001-2009 and 2009-2022

**Distribution of Inflation Predictions (12 Months) - 2001-2009**
```{r}
f.10.3a.2.1 <- BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(yyyyqq < 200901) %>%
    ggplot(.,aes(E1y, fill=as.factor(q14)))+
    geom_histogram(binwidth = 0.5, colour = "black") + 
    scale_x_continuous(breaks = c(-1, 0, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5), labels = c("Go down", "Stay the same", "0-1% increase", "1-2% increase", "2-3% increase", "3-4% increase", "4-5% increase", "Greater than \n5% increase")) +
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")
    ) + 
    labs(
        subtitle = "2001-2009",
        x = "Survey Response",
        y = "Response Count",
        fill = "Satisfaction with BoE\n(Q14 Response)"
    ) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 65, vjust = 0.5, hjust = 0.5), legend.position = "top", text = element_text(family = "serif"))+
    guides(fill = guide_legend(nrow = 1))
```

**Distribution of Inflation Predictions (12 Months) - 2009-2022**
```{r}
f.10.3b.2.1 <- BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(yyyyqq >= 200901 & yyyyqq <=202201) %>%
    ggplot(.,aes(E1y_all, fill=as.factor(q14)))+
    geom_histogram(binwidth = 0.5, colour = "black") + 
    scale_x_continuous(breaks = c(-5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5), labels = c("5% or greater\ndecrease", "4-5% decrease", "3-4% decrease", "2-3% decrease", "1-2% decrease", "0-1% decrease", "Stay the same", "0-1% increase", "1-2% increase", "2-3% increase", "3-4% increase", "4-5% increase", "5-6% increase", "6-7% increase", "7-8% increase", "8-9% increase", "9-10% increase", "10% or greater\nincrease")) +
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")
    ) + 
    labs(
        subtitle = "2009-2022",
        x = "Survey Response",
        y = "Response Count",
        fill = "Satisfaction with BoE\n(Q14 Response)") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 65, vjust = 0.5, hjust = 0.5), legend.position = "top", text = element_text(family = "serif"))+
    guides(fill = guide_legend(nrow = 1))
```

**Draw Figure**
```{r}
f.10.3a.2.1 + f.10.3b.2.1 +
    plot_layout(axis_titles = "collect") +
    plot_annotation(
        title = 'Comparison of Distribution of Responses to Inflation Expectations (12 Months)',
        caption = "Figure 10: Comparison of Distribution of Responses to Inflation Expectations - Grouped by Respondents' Response to Q14\nY scale is respondents' prediction error for 12 month inflation outcomes. X scale is respondents' perception error for current inflation. Both figures use 25 bins, and heatmap scale is the log of observations counted in each bin.") & theme(legend.position = "bottom", text = element_text(family = "serif"))
```

#### Figure B3.2.1 - Perception Error

```{r}
ggplot(data = subset(BOE_IAS, q14 != "6" & P_all != 99), aes(x = CPIH_perception_error_scale_2009, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, colour = "black", position = "stack") +
    geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(
        title = "Perception Error Density (2001-2024) - Grouped by Respondents' Satisfaction with Bank of England",
        caption = "Figure B3.2.1: Perception Error Density (2001-2024) - Grouped by Satisfaction with Bank of England.\nY scale is count of respondents over the entire survey period. X scale is the respondents' perception error in the prior 12 months, in bins of 0.5%.\nThe solid line is the overall respondents' mean perception error, and dashed lines are the mean plus (minus) the standard deviation of perception error.",
        x = "Perception (Intervals)",
        y = "Response Count",
        fill = "Respondents' Satisfaction:",
        linetype = "Pooled indicators") +
    theme_minimal() +
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    scale_x_continuous(breaks = round(seq(min(BOE_IAS$CPIH_perception_error_scale_2009), max(BOE_IAS$CPIH_perception_error_scale_2009), by = 0.5), 1))+
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1), text = element_text(family = "serif"))
```

#### Figure B3.2.2: Perception Error Density (Satisfaction Split)

**Draw Satisfied Graph**
```{r}
f.Ba.3.2.2 <- ggplot(data = subset(BOE_IAS, (q14 == 1 | q14 == 2) & P_all != 99), aes(x = P_all, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, colour = "black", position = "stack") +
    geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(
        x = "Perception Error (Intervals)",
        y = "Response Count",
        fill = "Respondents' Satisfaction:",
        linetype = "Pooled indicators") +
    theme_minimal()+
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    scale_x_continuous(breaks = round(seq(min(BOE_IAS$P_all), max(BOE_IAS$P_all), by = 0.5), 1))+
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1), text = element_text(family = "serif")) 
plot(f.Ba.3.2.2)
```

**Draw Dissatisfied Graph**

```{r}
f.Bb.3.2.2 <- ggplot(data = subset(BOE_IAS, (q14 == 4 | q14 == 5) & P_all != 99), aes(x = P_all, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, colour = "black", position = "stack") +
    geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(
        x = "Perception Error (Intervals)",
        y = "Response Count",
        fill = "Respondents' Satisfaction:",
        linetype = "Pooled indicators") +
    theme_minimal()+
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    scale_x_continuous(breaks = round(seq(min(BOE_IAS$P_all), max(BOE_IAS$P_all), by = 0.5), 1))+
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1), text = element_text(family = "serif")) 
plot(f.Bb.3.2.2)
```

**Create Figure**

```{r}
f.Ba.3.2.2 + f.Bb.3.2.2 +
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
      title = 'Perception Error Density (2001-2024)',
      subtitle = 'Split by Satisfied vs Dissatisfied',
      caption = 'Figure B3.2.2: Perception Error Density (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is count of respondents over the entire survey period. X scale is the respondents perception error in the prior 12 months, in bins of 0.5%.\nThe solid line is the overall respondents mean perception error, and dashed lines are the mean plus (minus) the standard deviation of perception error.') & theme(legend.position = "top", text = element_text(family = "serif"))
```

#### Figure B.3.3.1 - Variance of Inflation Perceptions and Perception Error

**Mean Inflation Perception over Time**
```{r}
f.B.3a.3.1 <- BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(P_all), pmean = mean(P_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Variation of Inflation Perception",
        x = "Year - Quarter",
        y = "Variation of - Inflation Perception",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right") +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9), text = element_text(family = "serif"))
```

**Mean Perception Error over Time**
```{r}
f.B.3b.3.1 <- BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrorvar = var(CPIH_perception_error_scale_2009), perrormean = mean(CPIH_perception_error_scale_2009)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrorvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Variation of Perception Error",
        x = "Year - Quarter",
        y = "Variation - Perception Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right") +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9), text = element_text(family = "serif"))
```
**Draw Figure**
```{r}
f.B.3a.3.1 / f.B.3b.3.1 + 
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
        title = 'Variation of Inflation Perception and Perception Error (2001-2024)',
        caption = 'Figure B3.3.1: Variation of Inflation Predictions and Prediction Error (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is the variation of inflation, and of estimation error, of respondents over the entire survey period.')  & theme(legend.position = "top", text = element_text(family = "serif"))
```

#### Figure B.3.3.2: Variation of Inflation Prediction and Prediction Error over Time (12 Months)

**Variation of Inflation Prediction over Time**
```{r}
f.B.3a.3.2 <- BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(E1y_all), pmean = mean(E1y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Variation of Inflation Prediction (12 Months)",
        x = "Year - Quarter",
        y = "Variation - Inflation Prediction",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```

**Variation of Prediction Error over Time**
```{r}
f.B.3b.3.2 <- BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrorvar = var(CPIH_prediction_error_scale_2009_12), perrormean = mean(CPIH_prediction_error_scale_2009_12)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrorvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Variation of Prediction Error (12 Months)",
        x = "Year - Quarter",
        y = "Variation - Prediction Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```
**Draw Figure**
```{r}
f.B.3a.3.2 / f.B.3b.3.2 + 
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
        title = 'Variation of Inflation Prediction and Prediction Error (2001-2024)',
        caption = 'Figure B.3.3.2: Variation of Inflation Predictions and Prediction Error (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is the Variation of estimation of future inflation in 12 months, and estimation error, of respondents over the entire survey period.')  & theme(legend.position = "top", text = element_text(family = "serif"))
```

#### Figure B.3.3.3: Mean Inflation Prediction and Prediction Error over Time (24 Months)

**Mean Inflation Prediction over Time**
```{r}
f.B.3a.3.3 <- BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(E2y_all), pmean = mean(E2y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pmean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Mean Inflation Prediction (24 Months)",
        x = "Year - Quarter",
        y = "Mean - Inflation Prediction",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```

**Mean Prediction Error over Time**
```{r}
f.B.3b.3.3 <- BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrorvar = var(CPIH_prediction_error_scale_2009_24), perrormean = mean(CPIH_prediction_error_scale_2009_24)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrormean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Mean of Prediction Error (24 Months)",
        x = "Year - Quarter",
        y = "Mean - Prediction Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```
**Draw Figure**
```{r}
f.B.3a.3.3 / f.B.3b.3.3 + 
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
        title = 'Mean Inflation Prediction and Prediction Error (2001-2024)',
        caption = 'Figure B.3.3.4: Mean Inflation Predictions and Prediction Error (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is the mean of estimation of future inflation in 24 months, and estimation error, of respondents over the entire survey period.')  & theme(legend.position = "top", text = element_text(family = "serif"))
```


#### Figure B.3.3.4: Variation of Inflation Prediction and Prediction Error over Time (24 Months)

**Variation of Inflation Prediction over Time**
```{r}
f.B.3a.3.4 <- BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(E2y_all), pmean = mean(E2y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Variation of Inflation Prediction (24 Months)",
        x = "Year - Quarter",
        y = "Variation - Inflation Prediction",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```

**Variation of Prediction Error over Time**
```{r}
f.B.3b.3.4 <- BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrorvar = var(CPIH_prediction_error_scale_2009_24), perrormean = mean(CPIH_prediction_error_scale_2009_24)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrorvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Variation of Prediction Error (24 Months)",
        x = "Year - Quarter",
        y = "Variation - Prediction Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```
**Draw Figure**
```{r}
f.B.3a.3.4 / f.B.3b.3.4 + 
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
        title = 'Variation of Inflation Prediction and Prediction Error (2001-2024)',
        caption = 'Figure B.3.3.4: Variation of Inflation Predictions and Prediction Error (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is the Variation of estimation of future inflation in 24 months, and estimation error, of respondents over the entire survey period.')  & theme(legend.position = "top", text = element_text(family = "serif"))
```

#### Figure B.3.3.5: Mean Inflation Prediction and Prediction Error over Time (60 Months)

**Mean Inflation Prediction over Time**
```{r}
f.B.3a.3.5 <- BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(E5y_all), pmean = mean(E5y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pmean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Mean Inflation Prediction (60 Months)",
        x = "Year - Quarter",
        y = "Mean - Inflation Prediction",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```

**Mean Prediction Error over Time**
```{r}
f.B.3b.3.5 <- BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrorvar = var(CPIH_prediction_error_scale_2009_60), perrormean = mean(CPIH_prediction_error_scale_2009_60)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrormean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Mean of Prediction Error (60 Months)",
        x = "Year - Quarter",
        y = "Mean - Prediction Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```
**Draw Figure**
```{r}
f.B.3a.3.5 / f.B.3b.3.5 + 
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
        title = 'Mean Inflation Prediction and Prediction Error (2001-2024)',
        caption = 'Figure B.3.3.5: Mean Inflation Predictions and Prediction Error (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is the mean of estimation of future inflation in 60 months, and estimation error, of respondents over the entire survey period.')  & theme(legend.position = "top", text = element_text(family = "serif"))
```


#### Figure B.3.3.4: Variation of Inflation Prediction and Prediction Error over Time (60 Months)

**Variation of Inflation Prediction over Time**
```{r}
f.B.3a.3.6 <- BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(E5y_all), pmean = mean(E5y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Variation of Inflation Prediction (60 Months)",
        x = "Year - Quarter",
        y = "Variation - Inflation Prediction",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```

**Variation of Prediction Error over Time**
```{r}
f.B.3b.3.6 <- BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrorvar = var(CPIH_prediction_error_scale_2009_60), perrormean = mean(CPIH_prediction_error_scale_2009_60)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrorvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS_x_scale$timetrend, labels = BOE_IAS_x_scale$yyyyqq_scale) +
    labs(
        subtitle = "Variation of Prediction Error (60 Months)",
        x = "Year - Quarter",
        y = "Variation - Prediction Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(legend.position = "right", text = element_text(family = "serif")) +
    theme(axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1, size = 9))
```
**Draw Figure**
```{r}
f.B.3a.3.6 / f.B.3b.3.6 + 
    plot_layout(guides = 'collect', axes = "collect") +
    plot_annotation(
        title = 'Variation of Inflation Prediction and Prediction Error (2001-2024)',
        caption = 'Figure B.3.3.4: Variation of Inflation Predictions and Prediction Error (2001-2024) Split by Satisfied vs Dissatisfied\nY scale is the Variation of estimation of future inflation in 60 months, and estimation error, of respondents over the entire survey period.')  & theme(legend.position = "top", text = element_text(family = "serif"))
```


## Intuitions

### Q14 Proportion Chart

```{r}
BOE_IAS %>%
    group_by(timetrend, q14) %>%
    mutate(counter = n()) %>%
    mutate(proportion = n() / sum(n())) %>%
    ggplot(aes(x = as.factor(timetrend), y = proportion, fill = as.factor(q14))) +
    geom_col(position = "fill") +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    scale_y_continuous(labels = scales::label_percent())+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")
    ) +
    labs(
        title = "Proportion of responses to Q14 - Satisfaction with Bank of England",
        x = "Year - Quarter",
        y = "Proportion",
        fill = "Q14 Response"
    ) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

### Aggregate Satisfaction

**Aggregate Satisfaction in the Bank of England**
```{r}
BOE_IAS %>%
    group_by(timetrend) %>%
    summarise(aggregate_trust = median(agg_trust)) %>%
    ggplot(aes(x = as.factor(timetrend), y = aggregate_trust, group = 2)) +
    geom_line() +
    geom_point() +
    geom_ribbon(aes(ymin=0.5, ymax=1), fill="#2E5A87FF", alpha=0.25) +
    geom_ribbon(aes(ymin=0, ymax=0.5), fill="#6998C1FF", alpha=0.25) +
    geom_ribbon(aes(ymin=-0.5, ymax=0), fill="#ED6055FF", alpha=0.25) +
    geom_ribbon(aes(ymin=-1, ymax=-0.5), fill="#A90C38FF", alpha=0.25) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq, expand = (c(0,0.1))) +
    scale_y_continuous(expand = c(0,0), limits = c(-1, NA), sec.axis = ) +
    coord_cartesian(ylim = c(-1,1)) +
    labs(
        title = "Aggregate Satisfaction in the Bank of England",
        x = "Year - Quarter",
        y = "Aggregate Satisfaction") +
    theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
```

### Variation and Mean Over Time By Satisfaction

#### Inflation Perceptions
**Variation - Q14**
```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(pvar = var(P_all), pmean = mean(P_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pvar)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Inflation Perception - Grouped by Q14 Response",
        x = "Year - Quarter",
        y = "Variation - Inflation Perception",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Variation - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(P_all), pmean = mean(P_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Inflation Perception - Grouped by Satsfaction with Bank of England",
        x = "Year - Quarter",
        y = "Variation - Inflation Perception",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14**

```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(pvar = var(P_all), pmean = mean(P_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pmean)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Inflation Perception - Grouped by Q14 Response",
        x = "Year - Quarter",
        y = "Mean - Inflation Perception",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(pvar = var(P_all), pmean = mean(P_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = pmean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Inflation Perception - Grouped by Satsfaction with Bank of England",
        x = "Year - Quarter",
        y = "Mean - Inflation Perception",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Inflation Prediction (12 Months)
**Variation - Q14**
```{r}
BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(e12var = var(E1y_all), e12mean = mean(E1y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e12var)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Inflation Prediction (12 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Inflation Prediction (12 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Variation - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(e12var = var(E1y_all), e12mean = mean(E1y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e12var)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Inflation Prediction (12 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Inflation Prediction (12 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14**

```{r}
BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(e12var = var(E1y_all), e12mean = mean(E1y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e12mean)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Inflation Prediction (12 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Inflation Prediction (12 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(e12var = var(E1y_all), e12mean = mean(E1y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e12mean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Inflation Prediction (12 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Inflation Prediction (12 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Inflation Prediction (24 Months)
**Variation - Q14**
```{r}
BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(e24var = var(E2y_all), e24mean = mean(E2y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e24var)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Inflation Prediction (24 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Inflation Prediction (24 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Variation - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(e24var = var(E2y_all), e24mean = mean(E2y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e24var)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Inflation Prediction (24 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Inflation Prediction (24 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14**

```{r}
BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(e24var = var(E2y_all), e24mean = mean(E2y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e24mean)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Inflation Prediction (24 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Inflation Prediction (24 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(e24var = var(E2y_all), e24mean = mean(E2y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e24mean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Inflation Prediction (24 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Inflation Prediction (24 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Inflation Prediction (60 Months)
**Variation - Q14**
```{r}
BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(e60var = var(E5y_all), e60mean = mean(E5y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e60var)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Inflation Prediction (60 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Inflation Prediction (60 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Variation - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(e60var = var(E5y_all), e60mean = mean(E5y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e60var)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Inflation Prediction (60 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Inflation Prediction (60 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14**

```{r}
BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(e60var = var(E5y_all), e60mean = mean(E5y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e60mean)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Inflation Prediction (60 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Inflation Prediction (60 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(e60var = var(E5y_all), e60mean = mean(E5y_all)) %>%
    ggplot(aes(x = as.factor(timetrend), y = e60mean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Inflation Prediction (60 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Inflation Prediction (60 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Perception Error
**Variation - Q14**

```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(perrorvar = var(CPIH_perception_error_scale_2009), perrormean = mean(CPIH_perception_error_scale_2009)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrorvar)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Perception Error - Grouped by Q14 Response",
        x = "Year - Quarter",
        y = "Variation - Perception Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Variation - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrorvar = var(CPIH_perception_error_scale_2009), perrormean = mean(CPIH_perception_error_scale_2009)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrorvar)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Perception Error - Grouped by Satsfaction with Bank of England",
        x = "Year - Quarter",
        y = "Variation - Inflation Perception",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14**

```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(q14 <= 5) %>%
    group_by(timetrend, q14) %>%
    summarise(perrormean = var(CPIH_perception_error_scale_2009), perrormean = mean(CPIH_perception_error_scale_2009)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrormean)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Perception Error - Grouped by Q14 Response",
        x = "Year - Quarter",
        y = "Mean - Perception Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(perrormean = var(CPIH_perception_error_scale_2009), perrormean = mean(CPIH_perception_error_scale_2009)) %>%
    ggplot(aes(x = as.factor(timetrend), y = perrormean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Perception Error - Grouped by Satsfaction with Bank of England",
        x = "Year - Quarter",
        y = "Mean - Perception Error",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Satisfied", "1" = "Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Prediction Error (12 Months)
**Variation - Q14**
```{r}
BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(q14 <= 5) %>%
    filter(yyyyqq <= 202302) %>%
    group_by(timetrend, q14) %>%
    summarise(eerror12var = var(CPIH_prediction_error_scale_2009_12), eerror12mean = mean(CPIH_prediction_error_scale_2009_12)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror12var)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Prediction Error (12 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Prediction Error (12 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Variation - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    filter(yyyyqq <= 202302) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(eerror12var = var(CPIH_prediction_error_scale_2009_12), eerror12mean = mean(CPIH_prediction_error_scale_2009_12)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror12var)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Prediction Error (12 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Prediction Error (12 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14**

```{r}
BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(q14 <= 5) %>%
    filter(yyyyqq <= 202302) %>%
    group_by(timetrend, q14) %>%
    summarise(eerror12var = var(CPIH_prediction_error_scale_2009_12), eerror12mean = mean(CPIH_prediction_error_scale_2009_12)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror12mean)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Prediction Error (12 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Prediction Error (12 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    filter(yyyyqq <= 202302) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(eerror12var = var(CPIH_prediction_error_scale_2009_12), eerror12mean = mean(CPIH_prediction_error_scale_2009_12)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror12mean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Prediction Error (12 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Prediction Error (12 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Prediction Error (24 Months)
**Variation - Q14**
```{r}
BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(q14 <= 5) %>%
    filter(yyyyqq <= 202202) %>%
    group_by(timetrend, q14) %>%
    summarise(eerror24var = var(CPIH_prediction_error_scale_2009_24), eerror24mean = mean(CPIH_prediction_error_scale_2009_24)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror24var)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Prediction Error (24 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Prediction Error (24 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Variation - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    filter(yyyyqq <= 202202) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(eerror24var = var(CPIH_prediction_error_scale_2009_24), eerror24mean = mean(CPIH_prediction_error_scale_2009_24)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror24var)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Prediction Error (24 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Prediction Error (24 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14**

```{r}
BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(q14 <= 5) %>%
    filter(yyyyqq <= 202202) %>%
    group_by(timetrend, q14) %>%
    summarise(eerror24var = var(CPIH_prediction_error_scale_2009_24), eerror24mean = mean(CPIH_prediction_error_scale_2009_24)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror24mean)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Prediction Error (24 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Prediction Error (24 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E2y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    filter(yyyyqq <= 202202) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(eerror24var = var(CPIH_prediction_error_scale_2009_24), eerror24mean = mean(CPIH_prediction_error_scale_2009_24)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror24mean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Prediction Error (24 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Prediction Error (24 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Prediction Error (60 Months)
**Variation - Q14**
```{r}
BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(q14 <= 5) %>%
    filter(yyyyqq <= 201902) %>%
    group_by(timetrend, q14) %>%
    summarise(eerror60var = var(CPIH_prediction_error_scale_2009_60), eerror60mean = mean(CPIH_prediction_error_scale_2009_60)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror60var)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Prediction Error (60 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Prediction Error (60 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Variation - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    filter(yyyyqq <= 201902) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(eerror60var = var(CPIH_prediction_error_scale_2009_60), eerror60mean = mean(CPIH_prediction_error_scale_2009_60)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror60var)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Variation in Prediction Error (60 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Variation - Prediction Error (60 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14**

```{r}
BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(q14 <= 5) %>%
    filter(yyyyqq <= 201902) %>%
    group_by(timetrend, q14) %>%
    summarise(eerror60var = var(CPIH_prediction_error_scale_2009_60), eerror60mean = mean(CPIH_prediction_error_scale_2009_60)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror60mean)) +
    geom_line(aes(colour = as.factor(q14), linetype = as.factor(q14), group = q14)) +
    geom_point(aes(colour = as.factor(q14), shape = as.factor(q14))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Prediction Error (60 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Prediction Error (60 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#6998C1FF", "#D6D0D1", "#ED6055FF", "#A90C38FF"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_shape_manual(
        values = c(16, 17, 18, 19, 20),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")) +
    scale_linetype_manual(
        values = c(1,1,2,3,3), 
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\n nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))+
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

**Mean - Q14 Satisfied / Dissatisfied**

```{r}
BOE_IAS %>%
    filter(E5y_all != 99) %>%
    filter(!is.na(q14_binary)) %>%
    filter(yyyyqq <= 201902) %>%
    group_by(timetrend, q14_binary) %>%
    summarise(eerror60var = var(CPIH_prediction_error_scale_2009_60), eerror60mean = mean(CPIH_prediction_error_scale_2009_60)) %>%
    ggplot(aes(x = as.factor(timetrend), y = eerror60mean)) +
    geom_point(aes(colour = as.factor(q14_binary), shape = as.factor(q14_binary))) +
    geom_line(aes(colour = as.factor(q14_binary), linetype = as.factor(q14_binary), group = as.factor(q14_binary))) +
    scale_x_discrete(breaks = BOE_IAS$timetrend, labels = BOE_IAS$yyyyqq) +
    labs(
        title = "Mean Prediction Error (60 Months - Grouped by Q14 Response)",
        x = "Year - Quarter",
        y = "Mean - Prediction Error (60 Months)",
        colour = "Q14 Response", shape = "Q14 Response", linetype = "Q14 Response") +
    scale_colour_manual(
        values = c("#2E5A87FF", "#A90C38FF"),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_shape_manual(
        values = c(16, 20),
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    scale_linetype_manual(
        values = c(1,3), 
        labels = c("0" = "Aggregate Satisfied", "1" = "Aggregate Dissatisfied")) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Table Summary

**Create table for Inflation Perceptions**

```{r}
BOE_IAS_summary_p <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (P_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = mean(P_all),
        sd = sd(P_all),
        variance = var(P_all),
        percentile25 = quantile(P_all, 0.25),
        percentile75 = quantile(P_all, 0.75),
        IQR = IQR(P_all)
    ) %>%
print(BOE_IAS_summary_p)

```

**Create table for Inflation Predictions (12 Months)**
```{r}
BOE_IAS_summary_e12 <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (E1y_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = mean(E1y_all),
        sd = sd(E1y_all),
        variance = var(E1y_all),
        percentile25 = quantile(E1y_all, 0.25),
        percentile75 = quantile(E1y_all, 0.75),
        IQR = IQR(E1y_all)
    )
print(BOE_IAS_summary_e12)
```

**Create table for Inflation Predictions (24 Months)**
```{r}
BOE_IAS_summary_e24 <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (E2y_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = mean(E2y_all),
        sd = sd(E2y_all),
        variance = var(E2y_all),
        percentile25 = quantile(E2y_all, 0.25),
        percentile75 = quantile(E2y_all, 0.75),
        IQR = IQR(E2y_all)
    )
print(BOE_IAS_summary_e24)
```

**Create table for Inflation Predictions (60 Months)**
```{r}
BOE_IAS_summary_e60 <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (E5y_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = mean(E5y_all),
        sd = sd(E5y_all),
        variance = var(E5y_all),
        percentile25 = quantile(E5y_all, 0.25),
        percentile75 = quantile(E5y_all, 0.75),
        IQR = IQR(E5y_all)
    )
print(BOE_IAS_summary_e60)
```

### Histograms Charts

#### Distribution of Responses to Inflation Perceptions (Q1) - 2001-2009

```{r}
BOE_IAS %>%
    filter(P != 99) %>%
    filter(yyyyqq < 200901) %>%
    ggplot(.,aes(P, fill=as.factor(q14)))+
    geom_histogram(binwidth = 0.5) + 
    scale_x_continuous(breaks = c(-1, 0, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5), labels = c("Go down", "Stay the same", "0-1% increase", "1-2% increase", "2-3% increase", "3-4% increase", "4-5% increase", "Greater than \n5% increase")) +
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")
    ) + 
    labs(
        title = "Distribution of Responses to Inflation Perception (Q1)\n 2001-2009",
        x = "Survey Response",
        y = "Count",
        fill = "Satisfaction with BoE \n (Q14 Response)"
    ) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Distribution of Responses to Inflation Expectations (Q2) - 2001-2009

```{r}
BOE_IAS %>%
    filter(E1y != 99) %>%
    filter(yyyyqq < 200901) %>%
    ggplot(.,aes(E1y, fill=as.factor(q14)))+
    geom_histogram(binwidth = 0.5) + 
    scale_x_continuous(breaks = c(-1, 0, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5), labels = c("Go down", "Stay the same", "0-1% increase", "1-2% increase", "2-3% increase", "3-4% increase", "4-5% increase", "Greater than \n5% increase")) +
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")
    ) + 
    labs(
        title = "Distribution of Responses to Inflation Expectations (Q2)\n 2001-2009",
        x = "Survey Response",
        y = "Count",
        fill = "Satisfaction with BoE \n (Q14 Response)"
    ) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Distribution of Responses to Inflation Perceptions (Q2) - 2009-2024

```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(yyyyqq >= 200901) %>%
    ggplot(.,aes(P_all, fill=as.factor(q14)))+
    geom_histogram(binwidth = 0.5) + 
    scale_x_continuous(breaks = c(-5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5), labels = c("5% or greater\ndecrease", "4-5% decrease", "3-4% decrease", "2-3% decrease", "1-2% decrease", "0-1% decrease", "Stay the same", "0-1% increase", "1-2% increase", "2-3% increase", "3-4% increase", "4-5% increase", "5-6% increase", "6-7% increase", "7-8% increase", "8-9% increase", "9-10% increase", "10-11% increase", "11-12% increase", "12-13% increase", "13-14% increase", "14-15% increase", "15% or greater\nincrease")) +
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")
    ) + 
    labs(
        title = "Distribution of Responses to Inflation Perceptions (Q2)\n2009-2024",
        x = "Survey Response",
        y = "Count",
        fill = "Satisfaction with BoE\n(Q14 Response)"
    ) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```
#### Distribution of Responses to Inflation Expectations (Q2) - 2009-2024

```{r}
BOE_IAS %>%
    filter(E1y_all != 99) %>%
    filter(yyyyqq >= 200901) %>%
    ggplot(.,aes(E1y_all, fill=as.factor(q14)))+
    geom_histogram(binwidth = 0.5) + 
    scale_x_continuous(breaks = c(-5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5), labels = c("5% or greater\ndecrease", "4-5% decrease", "3-4% decrease", "2-3% decrease", "1-2% decrease", "0-1% decrease", "Stay the same", "0-1% increase", "1-2% increase", "2-3% increase", "3-4% increase", "4-5% increase", "5-6% increase", "6-7% increase", "7-8% increase", "8-9% increase", "9-10% increase", "10-11% increase", "11-12% increase", "12-13% increase", "13-14% increase", "14-15% increase", "15% or greater\nincrease")) +
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied\nnor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know")
    ) + 
    labs(
        title = "Distribution of Responses to Inflation Expectations (Q2)\n2009-2024",
        x = "Survey Response",
        y = "Count",
        fill = "Satisfaction with BoE\n(Q14 Response)"
    ) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))
```

#### Inflation Perception - 2009 Scaling

##### Overall

```{r}
BOE_IAS %>%
	filter(P_all != 99) %>%
	filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
	ggplot(aes(x = P_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
  labs(title = "Figure 1: Inflation Perception Density (Q14 Response = 'Very Satisfied' or Fairly Satisfied')", x = "Inflation Perception (Intervals)", y = "Response Count", fill = "Q14 Response") +
  theme(legend.position = "top")+
  scale_fill_manual(
      values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
      labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied"

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 1) %>%
  ggplot(aes(x = P_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Perception Density (Q14 Response = 'Very Satisfied')", x = "Inflation Perception (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = P_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Perception Density (Q14 Response = 'Fairly Satisfied')", x = "Inflation Perception (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Neither Satisfied nor Dissatisfied"

```{r}
BOE_IAS %>%
  filter(P_all != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = P_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Perception Density (Q14 Response = 'Neither Satisfied nor Dissatisfied')", x = "Inflation Perception (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
  filter(P_all != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = P_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Perception Density (Q14 Response = 'Fairly Dissatisfied')", x = "Inflation Perception (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = Very Dissatisfied

```{r}
BOE_IAS %>%
  filter(P_all != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = P_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Perception Density (Q14 Response = 'Very Dissatisfied')", x = "Inflation Perception (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(q14 == 1 | q14 == 2) %>%
    ggplot(aes(x = P_all, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
    stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
    geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
    geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
    labs(title = "Inflation Perception Density (Q14 Response = 'Very Satisfied' or Fairly Satisfied')", x = "Inflation Perception (Intervals)", y = "Response Count", fill = "Q14 Response") +
    theme(legend.position = "top")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
  filter(P_all != 99) %>%
  filter(q14 == 4 | q14 == 5) %>%
  ggplot(aes(x = P_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(P_all)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(P_all) + sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(P_all) - sd(P_all)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Perception Density (Q14 Response = 'Very Dissatisfied' or Fairly Dissatisfied')", x = "Inflation Perception (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```


#### Perception Error - 2009 Scaling

##### Overall

```{r}
BOE_IAS %>%
	filter(P_all != 99) %>%
	filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
	ggplot(aes(x = CPIH_perception_error_scale_2009, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Perception Error Density - (Excludes Q14 Response 'Do Not Know')", x = "Perception Error (Intervals)", y = "Response Count", fill = "Q14 Response\n(Satisfaction with Bank of England)") +
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied"

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 1) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2009, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Very Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2009, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Neither Satisfied nor Dissatisfied"

```{r}
BOE_IAS %>%
  filter(P_all != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2009, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Neither Satisfied nor Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
  filter(P_all != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2009, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = Very Dissatisfied

```{r}
BOE_IAS %>%
  filter(P_all != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2009, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Very Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(P_all != 99) %>%
  filter(q14 == 1 | q14 == 2) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2009, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Very Satisfied' or Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
  filter(P_all != 99) %>%
  filter(q14 == 4 | q14 == 5) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2009, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) + sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2009) - sd(CPIH_perception_error_scale_2009)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Very Dissatisfied' or Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

#### Inflation Prediction (12 Months) - 2009 Scaling

##### Overall

```{r}
BOE_IAS %>%
	filter(E1y_all != 99) %>%
	filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
	ggplot(aes(x = E1y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) + sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) - sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 12 Months (Excludes Q14 Response 'Do Not Know')", x = "Inflation Prediction - 12 Months (Intervals)", y = "Response Count", fill = "Q14 Response\n(Satisfaction with Bank of England)") +
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied"

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 1) %>%
  ggplot(aes(x = E1y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) + sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) - sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 12 Months (Q14 Response = 'Very Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = E1y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) + sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) - sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 12 Months (Q14 Response = 'Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Neither Satisfied nor Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = E1y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) + sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) - sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 12 Months (Q14 Response = 'Neither Satisfied nor Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Fairly Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = E1y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) + sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) - sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 12 Months (Q14 Response = 'Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Very Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = E1y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) + sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) - sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 12 Months (Q14 Response = 'Very Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
	filter(E1y_all != 99) %>%
	filter(q14 == 1 | q14 == 2) %>%
	ggplot(aes(x = E1y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) + sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) - sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 12 Months (Q14 Response = 'Very Satisfied' or 'Fairly Satisfied')", x = "Inflation Prediction (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
	filter(E1y_all != 99) %>%
	filter(q14 == 5 | q14 == 4) %>%
	ggplot(aes(x = E1y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) + sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E1y_all,na.rm = TRUE) - sd(E1y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 12 Months (Q14 Response = 'Very Dissatisfied' or 'Fairly Dissatisfied')", x = "Inflation Prediction (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```


#### Prediction Error (12 Months) - 2009 Scaling

##### Overall

```{r}
BOE_IAS %>%
	filter(E1y_all != 99) %>%
	filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
	ggplot(aes(x = CPIH_prediction_error_scale_2009_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Excludes Q14 Response 'Do Not Know')", x = "Prediction Error - 12 Months (Intervals)", y = "Response Count", fill = "Q14 Response\n(Satisfaction with Bank of England)") +
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied"

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 1) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Very Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Neither Satisfied nor Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Neither Satisfied nor Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Fairly Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Very Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E1y_all != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Very Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
	filter(E1y_all != 99) %>%
	filter(q14 == 1 | q14 == 2) %>%
	ggplot(aes(x = CPIH_prediction_error_scale_2009_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Very Satisfied' or 'Fairly Satisfied')", x = "Prediction Error (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
	filter(E1y_all != 99) %>%
	filter(q14 == 5 | q14 == 4) %>%
	ggplot(aes(x = CPIH_prediction_error_scale_2009_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_12,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Very Dissatisfied' or 'Fairly Dissatisfied')", x = "Prediction Error (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

#### Inflation Prediction (24 Months) - 2009 Scaling

##### Overall

```{r}
BOE_IAS %>%
	filter(E2y_all != 99) %>%
	filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
	ggplot(aes(x = E2y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) + sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) - sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 24 Months (Excludes Q14 Response 'Do Not Know')", x = "Inflation Prediction - 24 Months (Intervals)", y = "Response Count", fill = "Q14 Response\n(Satisfaction with Bank of England)") +
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied"

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 1) %>%
  ggplot(aes(x = E2y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) + sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) - sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 24 Months (Q14 Response = 'Very Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = E2y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) + sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) - sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 24 Months (Q14 Response = 'Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Neither Satisfied nor Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = E2y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) + sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) - sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 24 Months (Q14 Response = 'Neither Satisfied nor Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Fairly Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = E2y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) + sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) - sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 24 Months (Q14 Response = 'Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Very Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = E2y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) + sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) - sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 24 Months (Q14 Response = 'Very Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
	filter(E2y_all != 99) %>%
	filter(q14 == 1 | q14 == 2) %>%
	ggplot(aes(x = E2y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) + sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) - sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 24 Months (Q14 Response = 'Very Satisfied' or 'Fairly Satisfied')", x = "Inflation Prediction (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
	filter(E2y_all != 99) %>%
	filter(q14 == 5 | q14 == 4) %>%
	ggplot(aes(x = E2y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) + sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E2y_all,na.rm = TRUE) - sd(E2y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 24 Months (Q14 Response = 'Very Dissatisfied' or 'Fairly Dissatisfied')", x = "Inflation Prediction (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```


#### Prediction Error (24 Months) - 2009 Scaling

##### Overall

```{r}
BOE_IAS %>%
	filter(E2y_all != 99) %>%
	filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
	ggplot(aes(x = CPIH_prediction_error_scale_2009_24, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 24 Months (Excludes Q14 Response 'Do Not Know')", x = "Prediction Error - 24 Months (Intervals)", y = "Response Count", fill = "Q14 Response\n(Satisfaction with Bank of England)") +
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied"

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 1) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_24, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 24 Months (Q14 Response = 'Very Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_24, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 24 Months (Q14 Response = 'Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Neither Satisfied nor Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_24, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 24 Months (Q14 Response = 'Neither Satisfied nor Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Fairly Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_24, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 24 Months (Q14 Response = 'Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Very Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E2y_all != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_24, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 24 Months (Q14 Response = 'Very Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
	filter(E2y_all != 99) %>%
	filter(q14 == 1 | q14 == 2) %>%
	ggplot(aes(x = CPIH_prediction_error_scale_2009_24, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 24 Months (Q14 Response = 'Very Satisfied' or 'Fairly Satisfied')", x = "Prediction Error (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
	filter(E2y_all != 99) %>%
	filter(q14 == 5 | q14 == 4) %>%
	ggplot(aes(x = CPIH_prediction_error_scale_2009_24, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_24,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_24,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 24 Months (Q14 Response = 'Very Dissatisfied' or 'Fairly Dissatisfied')", x = "Prediction Error (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

#### Inflation Prediction (60 Months) - 2009 Scaling

##### Overall

```{r}
BOE_IAS %>%
	filter(E5y_all != 99) %>%
	filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
	ggplot(aes(x = E5y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) + sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) - sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 60 Months (Excludes Q14 Response 'Do Not Know')", x = "Inflation Prediction - 60 Months (Intervals)", y = "Response Count", fill = "Q14 Response\n(Satisfaction with Bank of England)") +
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied"

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 1) %>%
  ggplot(aes(x = E5y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) + sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) - sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 60 Months (Q14 Response = 'Very Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = E5y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) + sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) - sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 60 Months (Q14 Response = 'Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Neither Satisfied nor Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = E5y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) + sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) - sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 60 Months (Q14 Response = 'Neither Satisfied nor Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Fairly Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = E5y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) + sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) - sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 60 Months (Q14 Response = 'Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Very Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = E5y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) + sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) - sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 60 Months (Q14 Response = 'Very Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
	filter(E5y_all != 99) %>%
	filter(q14 == 1 | q14 == 2) %>%
	ggplot(aes(x = E5y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) + sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) - sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 60 Months (Q14 Response = 'Very Satisfied' or 'Fairly Satisfied')", x = "Inflation Prediction (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
	filter(E5y_all != 99) %>%
	filter(q14 == 5 | q14 == 4) %>%
	ggplot(aes(x = E5y_all, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) + sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(E5y_all,na.rm = TRUE) - sd(E5y_all,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Inflation Prediction Density - 60 Months (Q14 Response = 'Very Dissatisfied' or 'Fairly Dissatisfied')", x = "Inflation Prediction (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```


#### Prediction Error (60 Months) - 2009 Scaling

##### Overall

```{r}
BOE_IAS %>%
	filter(E5y_all != 99) %>%
	filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
	ggplot(aes(x = CPIH_prediction_error_scale_2009_60, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 60 Months (Excludes Q14 Response 'Do Not Know')", x = "Prediction Error - 60 Months (Intervals)", y = "Response Count", fill = "Q14 Response\n(Satisfaction with Bank of England)") +
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied"

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 1) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_60, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 60 Months (Q14 Response = 'Very Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_60, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 60 Months (Q14 Response = 'Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Neither Satisfied nor Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_60, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 60 Months (Q14 Response = 'Neither Satisfied nor Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Fairly Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_60, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 60 Months (Q14 Response = 'Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Very Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E5y_all != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2009_60, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 60 Months (Q14 Response = 'Very Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
	filter(E5y_all != 99) %>%
	filter(q14 == 1 | q14 == 2) %>%
	ggplot(aes(x = CPIH_prediction_error_scale_2009_60, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 60 Months (Q14 Response = 'Very Satisfied' or 'Fairly Satisfied')", x = "Prediction Error (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
	filter(E5y_all != 99) %>%
	filter(q14 == 5 | q14 == 4) %>%
	ggplot(aes(x = CPIH_prediction_error_scale_2009_60, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = ..count..), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2009_60,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2009_60,na.rm = TRUE)), colour = "#000000", size = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 60 Months (Q14 Response = 'Very Dissatisfied' or 'Fairly Dissatisfied')", x = "Prediction Error (Intervals)", y = "Response Count", fill = "Q14 Response") +
	theme(legend.position = "top")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```


### Summaries of Basic Statistical Indicators

#### Inflation Perceptions and Perception Error

```{r}
BOE_IAS_summary_p <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (P_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = round(mean(P_all),2),
        sd = round(sd(P_all),2),
        variance = round(var(P_all),2),
        percentile25 = round(quantile(P_all, 0.25),2),
        percentile75 = round(quantile(P_all, 0.75),2),
        IQR = IQR(P_all),
        Variable = "Inflation Perceptions"
    ) %>%
    mutate (q14 = case_when(
        q14 == 1 ~ "Very Satisfied",
        q14 == 2 ~ "Fairly Satisfied",
        q14 == 3 ~ "Neither Satisfied nor Dissatisfied",
        q14 == 4 ~ "Fairly Dissatisfied",
        q14 == 5 ~ "Very Dissatisfied"
    )) %>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_pagg <- BOE_IAS %>%
    filter (!is.na(q14_binary)) %>%
    filter (P_all != 99) %>%
    group_by(q14_binary) %>%
    summarise(
        mean = round(mean(P_all),2),
        sd = round(sd(P_all),2),
        variance = round(var(P_all),2),
        percentile25 = round(quantile(P_all, 0.25),2),
        percentile75 = round(quantile(P_all, 0.75),2),
        IQR = IQR(P_all),
        Variable = "Inflation Perceptions"
    ) %>% 
    rename(q14 = q14_binary) %>%
    mutate (q14 = case_when(
        q14 == 0 ~ "Satisfied",
        q14 == 1 ~ "Dissatisfied",
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_perror <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (P_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = round(mean(CPIH_perception_error_scale_2009),2),
        sd = round(sd(CPIH_perception_error_scale_2009),2),
        variance = round(var(CPIH_perception_error_scale_2009),2),
        percentile25 = round(quantile(CPIH_perception_error_scale_2009, 0.25),2),
        percentile75 = round(quantile(CPIH_perception_error_scale_2009, 0.75),2),
        IQR = IQR(CPIH_perception_error_scale_2009),
        Variable = "Perception Error"
    ) %>%
    mutate (q14 = case_when(
        q14 == 1 ~ "Very Satisfied",
        q14 == 2 ~ "Fairly Satisfied",
        q14 == 3 ~ "Neither Satisfied nor Dissatisfied",
        q14 == 4 ~ "Fairly Dissatisfied",
        q14 == 5 ~ "Very Dissatisfied"
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_perroragg <- BOE_IAS %>%
    filter (!is.na(q14_binary)) %>%
    filter (P_all != 99) %>%
    group_by(q14_binary) %>%
    summarise(
        mean = round(mean(CPIH_perception_error_scale_2009),2),
        sd = round(sd(CPIH_perception_error_scale_2009),2),
        variance = round(var(CPIH_perception_error_scale_2009),2),
        percentile25 = round(quantile(CPIH_perception_error_scale_2009, 0.25),2),
        percentile75 = round(quantile(CPIH_perception_error_scale_2009, 0.75),2),
        IQR = IQR(CPIH_perception_error_scale_2009),
        Variable = "Perception Error"
    ) %>% 
    rename(q14 = q14_binary) %>%
    mutate (q14 = case_when(
        q14 == 0 ~ "Satisfied",
        q14 == 1 ~ "Dissatisfied",
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_perceptions <- rbind(rbind(BOE_IAS_summary_p,BOE_IAS_summary_pagg),rbind(BOE_IAS_summary_perror,BOE_IAS_summary_perroragg))
rm(BOE_IAS_summary_p)
rm(BOE_IAS_summary_pagg)
rm(BOE_IAS_summary_perror)
rm(BOE_IAS_summary_perroragg)
print(BOE_IAS_summary_perceptions)
```

#### Inflation Prediction and Prediction Error (12 Months)

```{r}
BOE_IAS_summary_e12 <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (E1y_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = round(mean(E1y_all),2),
        sd = round(sd(E1y_all),2),
        variance = round(var(E1y_all),2),
        percentile25 = round(quantile(E1y_all, 0.25),2),
        percentile75 = round(quantile(E1y_all, 0.75),2),
        IQR = IQR(E1y_all),
        Variable = "Inflation Predictions"
    ) %>%
    mutate (q14 = case_when(
        q14 == 1 ~ "Very Satisfied",
        q14 == 2 ~ "Fairly Satisfied",
        q14 == 3 ~ "Neither Satisfied nor Dissatisfied",
        q14 == 4 ~ "Fairly Dissatisfied",
        q14 == 5 ~ "Very Dissatisfied"
    )) %>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_e12agg <- BOE_IAS %>%
    filter (!is.na(q14_binary)) %>%
    filter (E1y_all != 99) %>%
    group_by(q14_binary) %>%
    summarise(
        mean = round(mean(E1y_all),2),
        sd = round(sd(E1y_all),2),
        variance = round(var(E1y_all),2),
        percentile25 = round(quantile(E1y_all, 0.25),2),
        percentile75 = round(quantile(E1y_all, 0.75),2),
        IQR = IQR(E1y_all),
        Variable = "Inflation Predictions"
    ) %>% 
    rename(q14 = q14_binary) %>%
    mutate (q14 = case_when(
        q14 == 0 ~ "Satisfied",
        q14 == 1 ~ "Dissatisfied",
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_eerror12 <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (E1y_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = round(mean(CPIH_prediction_error_scale_2009_12, na.rm=TRUE),2),
        sd = round(sd(CPIH_prediction_error_scale_2009_12, na.rm=TRUE),2),
        variance = round(var(CPIH_prediction_error_scale_2009_12, na.rm=TRUE), 2),
        percentile25 = round(quantile(CPIH_prediction_error_scale_2009_12, 0.25, na.rm=TRUE),2),
        percentile75 = round(quantile(CPIH_prediction_error_scale_2009_12, 0.75, na.rm=TRUE),2),
        IQR = IQR(CPIH_prediction_error_scale_2009_12, na.rm=TRUE),
        Variable = "Prediction Error"
    ) %>%
    mutate (q14 = case_when(
        q14 == 1 ~ "Very Satisfied",
        q14 == 2 ~ "Fairly Satisfied",
        q14 == 3 ~ "Neither Satisfied nor Dissatisfied",
        q14 == 4 ~ "Fairly Dissatisfied",
        q14 == 5 ~ "Very Dissatisfied"
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_eerror12agg <- BOE_IAS %>%
    filter (!is.na(q14_binary)) %>%
    filter (E1y_all != 99) %>%
    group_by(q14_binary) %>%
    summarise(
        mean = round(mean(CPIH_prediction_error_scale_2009_12, na.rm=TRUE),2),
        sd = round(sd(CPIH_prediction_error_scale_2009_12, na.rm=TRUE),2),
        variance = round(var(CPIH_prediction_error_scale_2009_12, na.rm=TRUE),2),
        percentile25 = round(quantile(CPIH_prediction_error_scale_2009_12, 0.25, na.rm=TRUE),2),
        percentile75 = round(quantile(CPIH_prediction_error_scale_2009_12, 0.75, na.rm=TRUE),2),
        IQR = IQR(CPIH_prediction_error_scale_2009_12, na.rm=TRUE),
        Variable = "Prediction Error"
    ) %>% 
    rename(q14 = q14_binary) %>%
    mutate (q14 = case_when(
        q14 == 0 ~ "Satisfied",
        q14 == 1 ~ "Dissatisfied",
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_predictions12 <- rbind(rbind(BOE_IAS_summary_e12,BOE_IAS_summary_e12agg),rbind(BOE_IAS_summary_eerror12,BOE_IAS_summary_eerror12agg))
rm(BOE_IAS_summary_e12)
rm(BOE_IAS_summary_e12agg)
rm(BOE_IAS_summary_eerror12)
rm(BOE_IAS_summary_eerror12agg)
print(BOE_IAS_summary_predictions12)
```

#### Inflation Prediction and Prediction Error (24 Months)

```{r}
BOE_IAS_summary_e24 <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (E2y_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = round(mean(E2y_all),2),
        sd = round(sd(E2y_all),2),
        variance = round(var(E2y_all),2),
        percentile25 = round(quantile(E2y_all, 0.25),2),
        percentile75 = round(quantile(E2y_all, 0.75),2),
        IQR = IQR(E2y_all),
        Variable = "Inflation Predictions"
    ) %>%
    mutate (q14 = case_when(
        q14 == 1 ~ "Very Satisfied",
        q14 == 2 ~ "Fairly Satisfied",
        q14 == 3 ~ "Neither Satisfied nor Dissatisfied",
        q14 == 4 ~ "Fairly Dissatisfied",
        q14 == 5 ~ "Very Dissatisfied"
    )) %>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_e24agg <- BOE_IAS %>%
    filter (!is.na(q14_binary)) %>%
    filter (E2y_all != 99) %>%
    group_by(q14_binary) %>%
    summarise(
        mean = round(mean(E2y_all),2),
        sd = round(sd(E2y_all),2),
        variance = round(var(E2y_all),2),
        percentile25 = round(quantile(E2y_all, 0.25),2),
        percentile75 = round(quantile(E2y_all, 0.75),2),
        IQR = IQR(E2y_all),
        Variable = "Inflation Predictions"
    ) %>% 
    rename(q14 = q14_binary) %>%
    mutate (q14 = case_when(
        q14 == 0 ~ "Satisfied",
        q14 == 1 ~ "Dissatisfied",
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_eerror24 <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (E2y_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = round(mean(CPIH_prediction_error_scale_2009_24, na.rm=TRUE),2),
        sd = round(sd(CPIH_prediction_error_scale_2009_24, na.rm=TRUE),2),
        variance = round(var(CPIH_prediction_error_scale_2009_24, na.rm=TRUE),2),
        percentile25 = round(quantile(CPIH_prediction_error_scale_2009_24, 0.25, na.rm=TRUE),2),
        percentile75 = round(quantile(CPIH_prediction_error_scale_2009_24, 0.75, na.rm=TRUE),2),
        IQR = IQR(CPIH_prediction_error_scale_2009_24, na.rm=TRUE),
        Variable = "Prediction Error"
    ) %>%
    mutate (q14 = case_when(
        q14 == 1 ~ "Very Satisfied",
        q14 == 2 ~ "Fairly Satisfied",
        q14 == 3 ~ "Neither Satisfied nor Dissatisfied",
        q14 == 4 ~ "Fairly Dissatisfied",
        q14 == 5 ~ "Very Dissatisfied"
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_eerror24agg <- BOE_IAS %>%
    filter (!is.na(q14_binary)) %>%
    filter (E2y_all != 99) %>%
    group_by(q14_binary) %>%
    summarise(
        mean = round(mean(CPIH_prediction_error_scale_2009_24, na.rm=TRUE),2),
        sd = round(sd(CPIH_prediction_error_scale_2009_24, na.rm=TRUE),2),
        variance = round(var(CPIH_prediction_error_scale_2009_24, na.rm=TRUE),2),
        percentile25 = round(quantile(CPIH_prediction_error_scale_2009_24, 0.25, na.rm=TRUE),2),
        percentile75 = round(quantile(CPIH_prediction_error_scale_2009_24, 0.75, na.rm=TRUE),2),
        IQR = IQR(CPIH_prediction_error_scale_2009_24, na.rm=TRUE),
        Variable = "Prediction Error"
    ) %>% 
    rename(q14 = q14_binary) %>%
    mutate (q14 = case_when(
        q14 == 0 ~ "Satisfied",
        q14 == 1 ~ "Dissatisfied",
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_predictions24 <- rbind(rbind(BOE_IAS_summary_e24,BOE_IAS_summary_e24agg),rbind(BOE_IAS_summary_eerror24,BOE_IAS_summary_eerror24agg))
rm(BOE_IAS_summary_e24)
rm(BOE_IAS_summary_e24agg)
rm(BOE_IAS_summary_eerror24)
rm(BOE_IAS_summary_eerror24agg)
print(BOE_IAS_summary_predictions24)
```

#### Inflation Prediction and Prediction Error (60 Months)

```{r}
BOE_IAS_summary_e60 <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (E5y_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = round(mean(E5y_all),2),
        sd = round(sd(E5y_all),2),
        variance = round(var(E5y_all),2),
        percentile25 = round(quantile(E5y_all, 0.25),2),
        percentile75 = round(quantile(E5y_all, 0.75),2),
        IQR = IQR(E5y_all),
        Variable = "Inflation Predictions"
    ) %>%
    mutate (q14 = case_when(
        q14 == 1 ~ "Very Satisfied",
        q14 == 2 ~ "Fairly Satisfied",
        q14 == 3 ~ "Neither Satisfied nor Dissatisfied",
        q14 == 4 ~ "Fairly Dissatisfied",
        q14 == 5 ~ "Very Dissatisfied"
    )) %>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_e60agg <- BOE_IAS %>%
    filter (!is.na(q14_binary)) %>%
    filter (E5y_all != 99) %>%
    group_by(q14_binary) %>%
    summarise(
        mean = round(mean(E5y_all),2),
        sd = round(sd(E5y_all),2),
        variance = round(var(E5y_all),2),
        percentile25 = round(quantile(E5y_all, 0.25),2),
        percentile75 = round(quantile(E5y_all, 0.75),2),
        IQR = IQR(E5y_all),
        Variable = "Inflation Predictions"
    ) %>% 
    rename(q14 = q14_binary) %>%
    mutate (q14 = case_when(
        q14 == 0 ~ "Satisfied",
        q14 == 1 ~ "Dissatisfied",
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_eerror60 <- BOE_IAS %>%
    filter (q14 != 6) %>%
    filter (E5y_all != 99) %>%
    group_by(q14) %>%
    summarise(
        mean = round(mean(CPIH_prediction_error_scale_2009_60, na.rm=TRUE),2),
        sd = round(sd(CPIH_prediction_error_scale_2009_60, na.rm=TRUE),2),
        variance = round(var(CPIH_prediction_error_scale_2009_60, na.rm=TRUE),2),
        percentile25 = round(quantile(CPIH_prediction_error_scale_2009_60, 0.25, na.rm=TRUE),2),
        percentile75 = round(quantile(CPIH_prediction_error_scale_2009_60, 0.75, na.rm=TRUE),2),
        IQR = IQR(CPIH_prediction_error_scale_2009_60, na.rm=TRUE),
        Variable = "Prediction Error"
    ) %>%
    mutate (q14 = case_when(
        q14 == 1 ~ "Very Satisfied",
        q14 == 2 ~ "Fairly Satisfied",
        q14 == 3 ~ "Neither Satisfied nor Dissatisfied",
        q14 == 4 ~ "Fairly Dissatisfied",
        q14 == 5 ~ "Very Dissatisfied"
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_eerror60agg <- BOE_IAS %>%
    filter (!is.na(q14_binary)) %>%
    filter (E5y_all != 99) %>%
    group_by(q14_binary) %>%
    summarise(
        mean = round(mean(CPIH_prediction_error_scale_2009_60, na.rm=TRUE),2),
        sd = round(sd(CPIH_prediction_error_scale_2009_60, na.rm=TRUE),2),
        variance = round(var(CPIH_prediction_error_scale_2009_60, na.rm=TRUE),2),
        percentile25 = round(quantile(CPIH_prediction_error_scale_2009_60, 0.25, na.rm=TRUE),2),
        percentile75 = round(quantile(CPIH_prediction_error_scale_2009_60, 0.75, na.rm=TRUE),2),
        IQR = IQR(CPIH_prediction_error_scale_2009_60, na.rm=TRUE),
        Variable = "Prediction Error"
    ) %>% 
    rename(q14 = q14_binary) %>%
    mutate (q14 = case_when(
        q14 == 0 ~ "Satisfied",
        q14 == 1 ~ "Dissatisfied",
    ))%>%
    dplyr::select(c("Variable","q14","mean","sd","variance","percentile25","percentile75","IQR"))
BOE_IAS_summary_predictions60 <- rbind(rbind(BOE_IAS_summary_e60,BOE_IAS_summary_e60agg),rbind(BOE_IAS_summary_eerror60,BOE_IAS_summary_eerror60agg))
rm(BOE_IAS_summary_e60)
rm(BOE_IAS_summary_e60agg)
rm(BOE_IAS_summary_eerror60)
rm(BOE_IAS_summary_eerror60agg)
print(BOE_IAS_summary_predictions60)
```

### Haldane et al. (2021) model

**Recreate variable for absolute deviation from 1-3% target range**

```{r}
BOE_IAS <- BOE_IAS %>%
  mutate (target_prediction_deviance_hmm2021_12 = case_when(
          E1y_all < 1.5 ~ abs(E1y_all) - 1.5,
          E1y_all > 2.5 ~ abs(E1y_all) - 2.5,
          E1y_all == 1.5 ~ 0,
          E1y_all == 2.5 ~ 0)) %>%
  mutate (target_prediction_deviance_hmm2021_24 = case_when(
          E2y_all < 1.5 ~ abs(E2y_all) - 1.5,
          E2y_all > 2.5 ~ abs(E2y_all) - 2.5,
          E2y_all == 1.5 ~ 0,
          E2y_all == 2.5 ~ 0)) %>%
  mutate (target_prediction_deviance_hmm2021_60 = case_when(
          E5y_all < 1.5 ~ abs(E5y_all) - 1.5,
          E5y_all > 2.5 ~ abs(E5y_all) - 2.5,
          E5y_all == 1.5 ~ 0,
          E5y_all == 2.5 ~ 0))
```

**Recreate stated Q14 variable inverse (1 = lowest satisfaction, 5 = highest satisfaction)

```{r}
BOE_IAS <- BOE_IAS %>%
  mutate(q14_inverse = case_when(
    q14 == 1 ~ 5,
    q14 == 2 ~ 4,
    q14 == 4 ~ 2,
    q14 == 5 ~ 1,
    q14 == 6 ~ 6,
    q14 == 3 ~ 3
  ))
```

```{r}
BOE_IAS <- BOE_IAS %>%
  mutate(q14_inverse_hmm2021 = case_when(
    q14 == 1 ~ 4,
    q14 == 2 ~ 3,
    q14 == 4 ~ 2,
    q14 == 5 ~ 1,
    .default = NULL
  ))
```


#### Create dataframes for Haldane et al. (2021) model features

**Absolute Deviance from Target - Inflation Prediction (12 Months)**
```{r}
df.hmm2021.e1y.filtered <- BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E1y_all != 99)%>%
    filter(q14 <= 5)
```

**Absolute Deviance from Target - Inflation Prediction (24 Months)**
```{r}
df.hmm2021.e2y.filtered <- BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E2y_all != 99)%>%
    filter(q14 <= 5)
```

**Absolute Deviance from Target - Inflation Prediction (60 Months)**
```{r}
df.hmm2021.e5y.filtered <- BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E5y_all != 99)%>%
    filter(q14 <= 5)
```

#### Re-create Haldane et al. (2021) model objects

**Absolute Deviance from Target - Inflation Prediction (12 Months)**

```{r}
m.lm.e12_hmm2021.q14 <- plm(target_prediction_deviance_hmm2021_12 ~  q14_inverse + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e1y.filtered, model = "within", index = c("yyyyqq"))
m.lm.e12_hmm2021.q14 <- within_intercept(m.lm.e12_hmm2021.q14, return.model = TRUE)
m.lm.e12_hmm2021.q14$cov1 <- vcovHC(m.lm.e12_hmm2021.q14, type = "HC1")
m.lm.e12_hmm2021.q14$robustse <- sqrt(diag(m.lm.e12_hmm2021.q14$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (12 Months + Quadratic Terms)**

```{r}
m.lm.e12_hmm2021.q14.qterms <- plm(target_prediction_deviance_hmm2021_12 ~  q14_inverse + I(q14_inverse^2) + knowledge_hmm2021 + I(knowledge_hmm2021^2) + eknowledge_hmm2021 + I(eknowledge_hmm2021^2) + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e1y.filtered, model = "within", index = "yyyyqq")
m.lm.e12_hmm2021.q14.qterms <- within_intercept(m.lm.e12_hmm2021.q14.qterms, return.model = TRUE)
m.lm.e12_hmm2021.q14.qterms$cov1 <- vcovHC(m.lm.e12_hmm2021.q14.qterms, type = "HC1")
m.lm.e12_hmm2021.q14.qterms$robustse <- sqrt(diag(m.lm.e12_hmm2021.q14.qterms$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (24 Months)**
```{r}
m.lm.e24_hmm2021.q14 <- plm(target_prediction_deviance_hmm2021_24 ~  q14_inverse + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e2y.filtered, model = "within", index = "yyyyqq")
m.lm.e24_hmm2021.q14 <- within_intercept(m.lm.e24_hmm2021.q14, return.model = TRUE)
m.lm.e24_hmm2021.q14$cov1 <- vcovHC(m.lm.e24_hmm2021.q14, type = "HC1")
m.lm.e24_hmm2021.q14$robustse <- sqrt(diag(m.lm.e24_hmm2021.q14$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (24 Months + Quadratic Terms)**
```{r}
m.lm.e24_hmm2021.q14.qterms <- plm(target_prediction_deviance_hmm2021_24 ~  q14_inverse + I(q14_inverse^2) + knowledge_hmm2021 + I(knowledge_hmm2021^2) + eknowledge_hmm2021 + I(eknowledge_hmm2021^2) + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e2y.filtered, model = "within", index = "yyyyqq")
m.lm.e24_hmm2021.q14.qterms <- within_intercept(m.lm.e24_hmm2021.q14.qterms, return.model = TRUE)
m.lm.e24_hmm2021.q14.qterms$cov1 <- vcovHC(m.lm.e24_hmm2021.q14.qterms, type = "HC1")
m.lm.e24_hmm2021.q14.qterms$robustse <- sqrt(diag(m.lm.e24_hmm2021.q14.qterms$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (60 Months)**
```{r}
m.lm.e60_hmm2021.q14 <- plm(target_prediction_deviance_hmm2021_60 ~  q14_inverse + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e5y.filtered, model = "within", index = "yyyyqq")
m.lm.e60_hmm2021.q14 <- within_intercept(m.lm.e60_hmm2021.q14, return.model = TRUE)
m.lm.e60_hmm2021.q14$cov1 <- vcovHC(m.lm.e60_hmm2021.q14, type = "HC1")
m.lm.e60_hmm2021.q14$robustse <- sqrt(diag(m.lm.e60_hmm2021.q14$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (60 Months + Quadratic Terms)**
```{r}
m.lm.e60_hmm2021.q14.qterms <- plm(target_prediction_deviance_hmm2021_60 ~  q14_inverse + I(q14_inverse^2) + knowledge_hmm2021 + I(knowledge_hmm2021^2) + eknowledge_hmm2021 + I(eknowledge_hmm2021^2) + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e5y.filtered, model = "within", index = "yyyyqq")
m.lm.e60_hmm2021.q14.qterms <- within_intercept(m.lm.e60_hmm2021.q14.qterms, return.model = TRUE)
m.lm.e60_hmm2021.q14.qterms$cov1 <- vcovHC(m.lm.e60_hmm2021.q14.qterms, type = "HC1")
m.lm.e60_hmm2021.q14.qterms$robustse <- sqrt(diag(m.lm.e60_hmm2021.q14.qterms$cov1))
```

#### Generate Tables for Haldane et al. (2021) models

**Create Haldane et al. (2021) model table**
```{r}
stargazer(
    m.lm.e12_hmm2021.q14, m.lm.e12_hmm2021.q14.qterms, m.lm.e24_hmm2021.q14, m.lm.e24_hmm2021.q14.qterms, m.lm.e60_hmm2021.q14, m.lm.e60_hmm2021.q14.qterms,
    omit = c("age","sex","class","sreg","income", "tenure", "educ", "work", "P_all", "CPI"),
    type = "text",
    title = "Linear Panel Models - Absolute Deviation of Inflation Predictions from BOE Target",
    column.labels = c("Inflation Prediction (12 Months)","Inflation Prediction (24 Months)", "Inflation Prediction (60 Months)"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust ProxyExp2", "Inst. Knowledge", "Inst. KnowledgeExp2", "Econ. Knowledge", "Econ. KnowledgeExp2"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2024','2001-2024','2009-2024','2009-2024','2009-2024','2009-2024')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),    
    se = list(m.lm.e12_hmm2021.q14$robustse, m.lm.e12_hmm2021.q14.qterms$robustse, m.lm.e24_hmm2021.q14$robustse, m.lm.e24_hmm2021.q14.qterms$robustse, m.lm.e60_hmm2021.q14$robustse, m.lm.e60_hmm2021.q14.qterms$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

#### Validate Model Against Pre-2020 Data

##### Create Pre-2020 Dataframes

**Absolute Deviance from Target - Inflation Prediction (12 Months)**
```{r}
df.hmm2021.e1y.filtered.0119 <- BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E1y_all != 99)%>%
    filter(q14 <= 5) %>%
    filter(yyyyqq <= 201904)
```

**Absolute Deviance from Target - Inflation Prediction (24 Months)**
```{r}
df.hmm2021.e2y.filtered.0919 <- BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E2y_all != 99)%>%
    filter(q14 <= 5)%>%
    filter(yyyyqq >= 200901)%>%
    filter(yyyyqq <= 201904)
```

**Absolute Deviance from Target - Inflation Prediction (60 Months)**
```{r}
df.hmm2021.e5y.filtered.0919 <- BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E5y_all != 99)%>%
    filter(q14 <= 5)%>%
    filter(yyyyqq >= 200901)%>%
    filter(yyyyqq <= 201904)
```

##### Re-create Haldane et al. (2021) model objects for pre-2020 data

**Absolute Deviance from Target - Inflation Prediction (12 Months)**

```{r}
m.lm.e12_hmm2021.q14.0119 <- plm(target_prediction_deviance_hmm2021_12 ~  q14_inverse + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e1y.filtered.0119, model = "within", index = "yyyyqq", effect = "time")
m.lm.e12_hmm2021.q14.0119 <- within_intercept(m.lm.e12_hmm2021.q14.0119, return.model = TRUE)
m.lm.e12_hmm2021.q14.0119$cov1 <- vcovHC(m.lm.e12_hmm2021.q14.0119, type = "HC1")
m.lm.e12_hmm2021.q14.0119$robustse <- sqrt(diag(m.lm.e12_hmm2021.q14.0119$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (12 Months + Quadratic Terms)**

```{r}
m.lm.e12_hmm2021.q14.qterms.0119 <- plm(target_prediction_deviance_hmm2021_12 ~  q14_inverse + I(q14_inverse^2) + knowledge_hmm2021 + I(knowledge_hmm2021^2) + eknowledge_hmm2021 + I(eknowledge_hmm2021^2)  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e1y.filtered.0119, model = "within", index = "timetrend", effect = "time")
m.lm.e12_hmm2021.q14.qterms.0119 <- within_intercept(m.lm.e12_hmm2021.q14.qterms.0119, return.model = TRUE)
m.lm.e12_hmm2021.q14.qterms.0119$cov1 <- vcovHC(m.lm.e12_hmm2021.q14.qterms.0119, type = "HC1")
m.lm.e12_hmm2021.q14.qterms.0119$robustse <- sqrt(diag(m.lm.e12_hmm2021.q14.qterms.0119$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (24 Months)**
```{r}
m.lm.e24_hmm2021.q14.0919 <-plm(target_prediction_deviance_hmm2021_24 ~  q14_inverse + knowledge_hmm2021  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e2y.filtered.0919, model = "within", index = "timetrend", effect = "time")
m.lm.e24_hmm2021.q14.0919 <- within_intercept(m.lm.e24_hmm2021.q14.0919, return.model = TRUE)
m.lm.e24_hmm2021.q14.0919$cov1 <- vcovHC(m.lm.e24_hmm2021.q14.0919, type = "HC1")
m.lm.e24_hmm2021.q14.0919$robustse <- sqrt(diag(m.lm.e24_hmm2021.q14.0919$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (24 Months + Quadratic Terms)**
```{r}
m.lm.e24_hmm2021.q14.qterms.0919 <- plm(target_prediction_deviance_hmm2021_24 ~ q14_inverse + I(q14_inverse^2) + knowledge_hmm2021 + I(knowledge_hmm2021^2) + eknowledge_hmm2021 + I(eknowledge_hmm2021^2)  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e2y.filtered.0919, model = "within", index = "timetrend", effect = "time")
m.lm.e24_hmm2021.q14.qterms.0919 <- within_intercept(m.lm.e24_hmm2021.q14.qterms.0919, return.model = TRUE)
m.lm.e24_hmm2021.q14.qterms.0919$cov1 <- vcovHC(m.lm.e24_hmm2021.q14.qterms.0919, type = "HC1")
m.lm.e24_hmm2021.q14.qterms.0919$robustse <- sqrt(diag(m.lm.e24_hmm2021.q14.qterms.0919$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (60 Months)**
```{r}
m.lm.e60_hmm2021.q14.0919 <- plm(target_prediction_deviance_hmm2021_60 ~  q14_inverse + knowledge_hmm2021  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e5y.filtered.0919, model = "within", index = "timetrend", effect = "time")
m.lm.e60_hmm2021.q14.0919 <- within_intercept(m.lm.e60_hmm2021.q14.0919, return.model = TRUE)
m.lm.e60_hmm2021.q14.0919$cov1 <- vcovHC(m.lm.e60_hmm2021.q14.0919, type = "HC1")
m.lm.e60_hmm2021.q14.0919$robustse <- sqrt(diag(m.lm.e60_hmm2021.q14.0919$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (60 Months + Quadratic Terms)**
```{r}
m.lm.e60_hmm2021.q14.qterms.0919 <- plm(target_prediction_deviance_hmm2021_60 ~  q14_inverse + I(q14_inverse^2) + knowledge_hmm2021 + I(knowledge_hmm2021^2) + eknowledge_hmm2021 + I(eknowledge_hmm2021^2)  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e5y.filtered.0919, model = "within", index = "timetrend", effect = "time")
m.lm.e60_hmm2021.q14.qterms.0919 <- within_intercept(m.lm.e60_hmm2021.q14.qterms.0919, return.model = TRUE)
m.lm.e60_hmm2021.q14.qterms.0919$cov1 <- vcovHC(m.lm.e60_hmm2021.q14.qterms.0919, type = "HC1")
m.lm.e60_hmm2021.q14.qterms.0919$robustse <- sqrt(diag(m.lm.e60_hmm2021.q14.qterms.0919$cov1))
```

#### Generate Tables for Haldane et al. (2021) models

**Create Haldane et al. (2021) model table**
```{r}
stargazer(
    m.lm.e12_hmm2021.q14.0119, m.lm.e12_hmm2021.q14.qterms.0119, m.lm.e24_hmm2021.q14.0919, m.lm.e24_hmm2021.q14.qterms.0919, m.lm.e60_hmm2021.q14.0919, m.lm.e60_hmm2021.q14.qterms.0919,
    omit = c("age","sex","class","sreg","income", "tenure", "educ", "work", "P_all", "CPI"),
    type = "text",
    title = "Linear Panel Models - Absolute Deviation of Inflation Predictions from BOE Target (2001-2019)",
    column.labels = c("Inflation Prediction (12 Months)","Inflation Prediction (24 Months)", "Inflation Prediction (60 Months)"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust ProxyExp2", "Inst. Knowledge", "Inst. KnowledgeExp2", "Econ. Knowledge", "Econ. KnowledgeExp2"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2019','2001-2019','2009-2019','2009-2019','2009-2019','2009-2019')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),    
    se = list(m.lm.e12_hmm2021.q14.0119$robustse, m.lm.e12_hmm2021.q14.qterms.0119$robustse, m.lm.e24_hmm2021.q14.0919$robustse, m.lm.e24_hmm2021.q14.qterms.0919$robustse, m.lm.e60_hmm2021.q14.0919$robustse, m.lm.e60_hmm2021.q14.qterms.0919$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

##### Create Post-2019 Dataframes

**Absolute Deviance from Target - Inflation Prediction (12 Months)**
```{r}
df.hmm2021.e1y.filtered.post <- BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E1y_all != 99)%>%
    filter(q14 <= 5) %>%
    filter(yyyyqq >= 201902)
```

**Absolute Deviance from Target - Inflation Prediction (24 Months)**
```{r}
df.hmm2021.e2y.filtered.post <- BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E2y_all != 99)%>%
    filter(q14 <= 5)%>%
    filter(yyyyqq >= 201902)
```

**Absolute Deviance from Target - Inflation Prediction (60 Months)**
```{r}
df.hmm2021.e5y.filtered.post <- BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E5y_all != 99)%>%
    filter(q14 <= 5)%>%
    filter(yyyyqq >= 201902)
```

##### Apply Haldane et. al. model to post-2019 data

**Absolute Deviance from Target - Inflation Prediction (12 Months)**

```{r}
m.lm.e12_hmm2021.q14.post <- plm(target_prediction_deviance_hmm2021_12 ~  q14_inverse + knowledge_hmm2021  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e1y.filtered.post, model = "within", index = "timetrend", effect = "time")
m.lm.e12_hmm2021.q14.post <- within_intercept(m.lm.e12_hmm2021.q14.post, return.model = TRUE)
m.lm.e12_hmm2021.q14.post$cov1 <- vcovHC(m.lm.e12_hmm2021.q14.post, type = "HC1")
m.lm.e12_hmm2021.q14.post$robustse <- sqrt(diag(m.lm.e12_hmm2021.q14.post$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (12 Months + Quadratic Terms)**

```{r}
m.lm.e12_hmm2021.q14.qterms.post <- plm(target_prediction_deviance_hmm2021_12 ~  q14_inverse + I(q14_inverse^2) + knowledge_hmm2021 + I(knowledge_hmm2021^2) + eknowledge_hmm2021 + I(eknowledge_hmm2021^2)  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e1y.filtered.post, model = "within", index = "timetrend", effect = "time")
m.lm.e12_hmm2021.q14.qterms.post <- within_intercept(m.lm.e12_hmm2021.q14.qterms.post, return.model = TRUE)
m.lm.e12_hmm2021.q14.qterms.post$cov1 <- vcovHC(m.lm.e12_hmm2021.q14.qterms.post, type = "HC1")
m.lm.e12_hmm2021.q14.qterms.post$robustse <- sqrt(diag(m.lm.e12_hmm2021.q14.qterms.post$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (24 Months)**
```{r}
m.lm.e24_hmm2021.q14.post <- plm(target_prediction_deviance_hmm2021_24 ~  q14_inverse + knowledge_hmm2021  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e2y.filtered.post, model = "within", index = "timetrend", effect = "time")
m.lm.e24_hmm2021.q14.post <- within_intercept(m.lm.e24_hmm2021.q14.post, return.model = TRUE)
m.lm.e24_hmm2021.q14.post$cov1 <- vcovHC(m.lm.e24_hmm2021.q14.post, type = "HC1")
m.lm.e24_hmm2021.q14.post$robustse <- sqrt(diag(m.lm.e24_hmm2021.q14.post$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (24 Months + Quadratic Terms)**
```{r}
m.lm.e24_hmm2021.q14.qterms.post <- plm(target_prediction_deviance_hmm2021_24 ~  q14_inverse + I(q14_inverse^2) + knowledge_hmm2021 + I(knowledge_hmm2021^2) + eknowledge_hmm2021 + I(eknowledge_hmm2021^2)  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e2y.filtered.post, model = "within", index = "timetrend", effect = "time")
m.lm.e24_hmm2021.q14.qterms.post <- within_intercept(m.lm.e24_hmm2021.q14.qterms.post, return.model = TRUE)
m.lm.e24_hmm2021.q14.qterms.post$cov1 <- vcovHC(m.lm.e24_hmm2021.q14.qterms.post, type = "HC1")
m.lm.e24_hmm2021.q14.qterms.post$robustse <- sqrt(diag(m.lm.e24_hmm2021.q14.qterms.post$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (60 Months)**
```{r}
m.lm.e60_hmm2021.q14.post <- plm(target_prediction_deviance_hmm2021_60 ~  q14_inverse + knowledge_hmm2021  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e5y.filtered.post, model = "within", index = "timetrend", effect = "time")
m.lm.e60_hmm2021.q14.post <- within_intercept(m.lm.e60_hmm2021.q14.post, return.model = TRUE)
m.lm.e60_hmm2021.q14.post$cov1 <- vcovHC(m.lm.e60_hmm2021.q14.post, type = "HC1")
m.lm.e60_hmm2021.q14.post$robustse <- sqrt(diag(m.lm.e60_hmm2021.q14.post$cov1))
```

**Absolute Deviance from Target - Inflation Prediction (60 Months + Quadratic Terms)**
```{r}
m.lm.e60_hmm2021.q14.qterms.post <- plm(target_prediction_deviance_hmm2021_60 ~  q14_inverse + I(q14_inverse^2) + knowledge_hmm2021 + I(knowledge_hmm2021^2) + eknowledge_hmm2021 + I(eknowledge_hmm2021^2)  + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.hmm2021.e5y.filtered.post, model = "within", index = "timetrend", effect = "time")
m.lm.e60_hmm2021.q14.qterms.post <- within_intercept(m.lm.e60_hmm2021.q14.qterms.post, return.model = TRUE)
m.lm.e60_hmm2021.q14.qterms.post$cov1 <- vcovHC(m.lm.e60_hmm2021.q14.qterms.post, type = "HC1")
m.lm.e60_hmm2021.q14.qterms.post$robustse <- sqrt(diag(m.lm.e60_hmm2021.q14.qterms.post$cov1))
```

#### Generate Tables for Haldane et al. (2021) models post-2020

**Create Haldane et al. (2021) model table**
```{r}
stargazer(
    m.lm.e12_hmm2021.q14.post, m.lm.e12_hmm2021.q14.qterms.post, m.lm.e24_hmm2021.q14.post, m.lm.e24_hmm2021.q14.qterms.post, m.lm.e60_hmm2021.q14.post, m.lm.e60_hmm2021.q14.qterms.post,
    omit = c("age","sex","class","sreg","income", "tenure", "educ", "work", "P_all", "CPI"),
    type = "text",
    title = "Linear Panel Models - Absolute Deviation of Inflation Predictions from BOE Target (2020-2024)",
    column.labels = c("Inflation Prediction (12 Months)","Inflation Prediction (24 Months)", "Inflation Prediction (60 Months)"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust ProxyExp2", "Inst. Knowledge", "Inst. KnowledgeExp2", "Econ. Knowledge", "Econ. KnowledgeExp2"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2020-2024','2020-2024','2020-2024','2020-2024','2020-2024','2020-2024')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),    
    se = list(m.lm.e12_hmm2021.q14.post$robustse, m.lm.e12_hmm2021.q14.qterms.post$robustse, m.lm.e24_hmm2021.q14.post$robustse, m.lm.e24_hmm2021.q14.qterms.post$robustse, m.lm.e60_hmm2021.q14.post$robustse, m.lm.e60_hmm2021.q14.qterms.post$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

## Regression Models

### Feature Selection

#### Spearman's Rho Correlation Coefficient

**Correlation Matrix - Complete observations Only**
```{r}
f.cor.forA.complete <- BOE_IAS %>%
    dplyr::select(q14_hmm2021, age, sex, income_fix, educ, tenure, class, sreg, knowledge_hmm2021, eknowledge_hmm2021) %>%
    filter(sex <= 5) %>%
    cor(., use='complete.obs', method='spearman')%>%
    get_upper_tri(matrix_input=.) %>%
    melt(., na.rm=TRUE) %>%
    ggplot(data = ., aes(x = Var1, y = Var2, fill = value)) +
    geom_tile(colour = "white") +
    scale_fill_gradient2(low = "red", high = "blue", mid = "white", midpoint = 0, limits = c(-1, 1),na.value="white")+
    geom_text(aes(label = round(value, 2)), colour = "black") +
    labs(
        title = "Correlation Matrix",
        subtitle = "Complete Observations",
        x="Variable 1",
        y = "Variable 2",
        fill = "Spearman's Rho") +
    coord_fixed() +
    scale_x_discrete(
        labels = c("Trust Proxy", "Age", "Sex", "Income", "Education", "Tenure", "Class", "Region", "Inst. Knowledge", "Econ. Knowledge")) +
    scale_y_discrete(
        labels = c("Trust Proxy", "Age", "Sex", "Income", "Education", "Tenure", "Class", "Region", "Inst. Knowledge", "Econ. Knowledge")) +
    theme_minimal() +
    theme(
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1),
        axis.text.y = element_text(angle = 65, vjust = 1, hjust = 1),
        text = element_text(family = "serif"))
```

**Correlation Matrix - Pairwise Complete Observations**

```{r}
f.cor.forA.pairwise <- BOE_IAS %>%
    dplyr::select(q14_hmm2021, age, sex, income_fix, educ, tenure, class, sreg, knowledge_hmm2021, eknowledge_hmm2021) %>%
    filter(sex <= 5) %>%
    cor(., use='pairwise.complete.obs', method='spearman')%>%
    get_upper_tri(matrix_input=.) %>%
    melt(., na.rm=TRUE) %>%
    ggplot(data = ., aes(x = Var1, y = Var2, fill = value)) +
    geom_tile(colour = "white") +
    scale_fill_gradient2(low = "red", high = "blue", mid = "white", midpoint = 0, limits = c(-1, 1),na.value="white")+
    geom_text(aes(label = round(value, 2)), colour = "black") +
    labs(
      title = "Correlation Matrix",
      subtitle = "Pairwise Observations",
      x="Variable 1",
      y = "Variable 2",
      fill = "Spearman's Rho")+
    coord_fixed()+
    scale_x_discrete(
        labels = c("Trust Proxy", "Age", "Sex", "Income", "Education", "Tenure", "Class", "Region", "Inst. Knowledge", "Econ. Knowledge")) +
    scale_y_discrete(
        labels = c("Trust Proxy", "Age", "Sex", "Income", "Education", "Tenure", "Class", "Region", "Inst. Knowledge", "Econ. Knowledge")) +
    theme_minimal() +
    theme(
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1),
        axis.text.y = element_text(angle = 65, vjust = 1, hjust = 1),
        text = element_text(family = "serif"))
```

#### Covariance - Pearson's Correlation Coefficient

**Covariance Matrix - Complete Observations Only**

```{r}
f.cov.forA.complete <- BOE_IAS %>%
    dplyr::select(q14_hmm2021, age, sex, income_fix, educ, tenure, class, sreg, knowledge_hmm2021, eknowledge_hmm2021) %>%
    filter(sex <= 5) %>%
    cov(., use='complete.obs')%>%
    get_upper_tri(matrix_input=.) %>%
    melt(., na.rm=TRUE) %>%
    ggplot(data = ., aes(x = Var1, y = Var2, fill = value)) +
    geom_tile(colour = "white") +
    scale_fill_gradient2(low = "red", high = "blue", mid = "white", midpoint = 0, limits = c(-1, 1),na.value="white")+
    geom_text(aes(label = round(value, 2)), colour = "black") +
    labs(
      title = "Covariance Matrix",
      subtitle = "Complete Observations",
      x="Variable 1",
      y = "Variable 2",
      fill = "Covariance\n(Pearson's Coefficient)")+
    coord_fixed()+
    scale_x_discrete(
        labels = c("Trust Proxy", "Age", "Sex", "Income", "Education", "Tenure", "Class", "Region", "Inst. Knowledge", "Econ. Knowledge")) +
    scale_y_discrete(
        labels = c("Trust Proxy", "Age", "Sex", "Income", "Education", "Tenure", "Class", "Region", "Inst. Knowledge", "Econ. Knowledge")) +
    theme_minimal() +
    theme(
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1),
        axis.text.y = element_text(angle = 65, vjust = 1, hjust = 1),
        text = element_text(family = "serif"))
```

**Covariance Matrix - Pairwise Complete Observations**

```{r}
f.cov.forA.pairwise <- BOE_IAS %>%
    dplyr::select(q14_hmm2021, age, sex, income_fix, educ, tenure, class, sreg, knowledge_hmm2021, eknowledge_hmm2021) %>%
    filter(sex <= 5) %>%
    cov(., use='pairwise.complete.obs')%>%
    get_upper_tri(matrix_input=.) %>%
    melt(., na.rm=TRUE) %>%
    ggplot(data = ., aes(x = Var1, y = Var2, fill = value)) +
    geom_tile(colour = "white") +
    scale_fill_gradient2(low = "red", high = "blue", mid = "white", midpoint = 0, limits = c(-1, 1),na.value="white")+
    geom_text(aes(label = round(value, 2)), colour = "black") +
    labs(
      title = "Covariance Matrix",
      subtitle = "Pairwise Observations",
      x="Variable 1",
      y = "Variable 2",
      fill = "Covariance\n(Pearson's Coefficient)")+
    coord_fixed()+
    scale_x_discrete(
        labels = c("Trust Proxy", "Age", "Sex", "Income", "Education", "Tenure", "Class", "Region", "Inst. Knowledge", "Econ. Knowledge")) +
    scale_y_discrete(
        labels = c("Trust Proxy", "Age", "Sex", "Income", "Education", "Tenure", "Class", "Region", "Inst. Knowledge", "Econ. Knowledge")) +
    theme_minimal() +
    theme(
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_text(angle = 65, vjust = 1, hjust = 1),
        axis.text.y = element_text(angle = 65, vjust = 1, hjust = 1),
        text = element_text(family = "serif"))
```

#### Correlation-Covariance Matrices - Heatmap

```{r}
(f.cor.forA.complete + f.cor.forA.pairwise + plot_layout(guides = "auto")) / (f.cov.forA.complete + f.cov.forA.pairwise +
    plot_layout(guides = "auto")) +
    plot_annotation(
        title = 'Comparison of Distribution of Responses to Inflation Expectations (12 Months)',
        caption = "Figure 10: Comparison of Distribution of Responses to Inflation Expectations - Grouped by Respondents' Response to Q14\nY scale is respondents' prediction error for 12 month inflation outcomes. X scale is respondents' perception error for current inflation. Both figures use 25 bins, and heatmap scale is the log of observations counted in each bin.") & theme(text = element_text(family = "serif"))  
```

### Linear Regression

#### Pooled Regression

**Create Filtered Dataframe - Perception & Perception Error**
```{r}
df.forA.filtered <- BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(sex <= 5) %>%
    filter(q14 <= 5) %>%
    filter(income != 12)
```

**Create Filtered Dataframe - 12 Month Prediction & Prediction Error**
```{r}
df.forB.filtered <- BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E1y_all != 99)%>%
    filter(q14 <= 5)%>%
    filter(income != 12)
```

**Create Filtered Dataframe - Prediction & Prediction Error**
```{r}
df.forC.filtered <- BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E2y_all != 99)%>%
    filter(q14 <= 5)%>%
    filter(income != 12)
```

**Create Filtered Dataframe - Prediction & Prediction Error**
```{r}
df.forD.filtered <- BOE_IAS %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    filter(E5y_all != 99)%>%
    filter(q14 <= 5)%>%
    filter(income != 12)
```

#####  Models

###### Baseline Model

**Inflation Perception - Baseline Model (Q14)**
```{r}
m.lm.p.q14.for2to7 <- plm(P_all ~  q14 + age + sex + tenure + class + educ + income_fix + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.p.q14.for2to7 <- within_intercept(m.lm.p.q14.for2to7, return.model = TRUE)
m.lm.p.q14.for2to7$cov1 <- vcovHC(m.lm.p.q14.for2to7, type = "HC1")
m.lm.p.q14.for2to7$robustse <- sqrt(diag(m.lm.p.q14.for2to7$cov1))
```

**Inflation Perception - Baseline Model (Q14 Without Indifference Limen)**
```{r}
m.lm.p.q14hmm2021.for2to7 <- plm(P_all ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.p.q14hmm2021.for2to7 <- within_intercept(m.lm.p.q14hmm2021.for2to7, return.model = TRUE)
m.lm.p.q14hmm2021.for2to7$cov1 <- vcovHC(m.lm.p.q14hmm2021.for2to7, type = "HC1")
m.lm.p.q14hmm2021.for2to7$robustse <- sqrt(diag(m.lm.p.q14hmm2021.for2to7$cov1))
```

**Perception Error - Baseline Model (Q14)**
```{r}
m.lm.perror.q14.for2to7 <- plm(CPIH_perception_error_scale_2009 ~  q14 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14.for2to7 <- within_intercept(m.lm.perror.q14.for2to7, return.model = TRUE)
m.lm.perror.q14.for2to7$cov1 <- vcovHC(m.lm.perror.q14.for2to7, type = "HC1")
m.lm.perror.q14.for2to7$robustse <- sqrt(diag(m.lm.perror.q14.for2to7$cov1))
```

**Perception Error - Baseline Model (Q14 Without Indifference Limen)**
```{r}
m.lm.perror.q14hmm2021.for2to7 <- plm(CPIH_perception_error_scale_2009 ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14hmm2021.for2to7 <- within_intercept(m.lm.perror.q14hmm2021.for2to7, return.model = TRUE)
m.lm.perror.q14hmm2021.for2to7$cov1 <- vcovHC(m.lm.perror.q14hmm2021.for2to7, type = "HC1")
m.lm.perror.q14hmm2021.for2to7$robustse <- sqrt(diag(m.lm.perror.q14hmm2021.for2to7$cov1))
```

**Absolute Perception Error - Baseline Model (Q14)**
```{r}
m.lm.perrorabs.q14.for2to7 <- plm(CPIH_perception_error_scale_2009_abs ~  q14 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q14.for2to7 <- within_intercept(m.lm.perrorabs.q14.for2to7, return.model = TRUE)
m.lm.perrorabs.q14.for2to7$cov1 <- vcovHC(m.lm.perrorabs.q14.for2to7, type = "HC1")
m.lm.perrorabs.q14.for2to7$robustse <- sqrt(diag(m.lm.perrorabs.q14.for2to7$cov1))
```

**Absolute Perception Error - Baseline Model (Q14 Without Indifference Limen)**
```{r}
m.lm.perrorabs.q142021.for2to7 <- plm(CPIH_perception_error_scale_2009_abs ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q142021.for2to7 <- within_intercept(m.lm.perrorabs.q142021.for2to7, return.model = TRUE)
m.lm.perrorabs.q142021.for2to7$cov1 <- vcovHC(m.lm.perrorabs.q142021.for2to7, type = "HC1")
m.lm.perrorabs.q142021.for2to7$robustse <- sqrt(diag(m.lm.perrorabs.q142021.for2to7$cov1))
```

**Inflation Prediction - Baseline Model (Q14 - 12 Months)**
```{r}
m.lm.e12.q14.for2to7 <- plm(E1y_all ~  q14 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e12.q14.for2to7 <- within_intercept(m.lm.e12.q14.for2to7, return.model = TRUE)
m.lm.e12.q14.for2to7$cov1 <- vcovHC(m.lm.e12.q14.for2to7, type = "HC1")
m.lm.e12.q14.for2to7$robustse <- sqrt(diag(m.lm.e12.q14.for2to7$cov1))
```

**Inflation Prediction - Baseline Model (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.e12.q14hmm2021.for2to7 <- plm(E1y_all ~  q14_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e12.q14hmm2021.for2to7 <- within_intercept(m.lm.e12.q14hmm2021.for2to7, return.model = TRUE)
m.lm.e12.q14hmm2021.for2to7$cov1 <- vcovHC(m.lm.e12.q14hmm2021.for2to7, type = "HC1")
m.lm.e12.q14hmm2021.for2to7$robustse <- sqrt(diag(m.lm.e12.q14hmm2021.for2to7$cov1))
```

**Prediction Error - Baseline Model (Q14 - 12 Months)**
```{r}
m.lm.eerror12.q14.for2to7 <- plm(CPIH_prediction_error_scale_2009_12 ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14.for2to7 <- within_intercept(m.lm.eerror12.q14.for2to7, return.model = TRUE)
m.lm.eerror12.q14.for2to7$cov1 <- vcovHC(m.lm.eerror12.q14.for2to7, type = "HC1")
m.lm.eerror12.q14.for2to7$robustse <- sqrt(diag(m.lm.eerror12.q14.for2to7$cov1))
```

**Prediction Error - Baseline Model (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.eerror12.q14hmm2021.for2to7 <- plm(CPIH_prediction_error_scale_2009_12 ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14hmm2021.for2to7 <- within_intercept(m.lm.eerror12.q14hmm2021.for2to7, return.model = TRUE)
m.lm.eerror12.q14hmm2021.for2to7$cov1 <- vcovHC(m.lm.eerror12.q14hmm2021.for2to7, type = "HC1")
m.lm.eerror12.q14hmm2021.for2to7$robustse <- sqrt(diag(m.lm.eerror12.q14hmm2021.for2to7$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 = 12 Months)**
```{r}
m.lm.eerror12abs.q14.for2to7 <- plm(CPIH_prediction_error_scale_2009_12_abs ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q14.for2to7 <- within_intercept(m.lm.eerror12abs.q14.for2to7, return.model = TRUE)
m.lm.eerror12abs.q14.for2to7$cov1 <- vcovHC(m.lm.eerror12abs.q14.for2to7, type = "HC1")
m.lm.eerror12abs.q14.for2to7$robustse <- sqrt(diag(m.lm.eerror12abs.q14.for2to7$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.eerror12abs.q142021.for2to7 <- plm(CPIH_prediction_error_scale_2009_12_abs ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q142021.for2to7 <- within_intercept(m.lm.eerror12abs.q142021.for2to7, return.model = TRUE)
m.lm.eerror12abs.q142021.for2to7$cov1 <- vcovHC(m.lm.eerror12abs.q142021.for2to7, type = "HC1")
m.lm.eerror12abs.q142021.for2to7$robustse <- sqrt(diag(m.lm.eerror12abs.q142021.for2to7$cov1))
```

**Inflation Prediction - Baseline Model (Q14 - 24 Months)**
```{r}
m.lm.e24.q14.for2to7 <- plm(E2y_all ~  q14 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e24.q14.for2to7 <- within_intercept(m.lm.e24.q14.for2to7, return.model = TRUE)
m.lm.e24.q14.for2to7$cov1 <- vcovHC(m.lm.e24.q14.for2to7, type = "HC1")
m.lm.e24.q14.for2to7$robustse <- sqrt(diag(m.lm.e24.q14.for2to7$cov1))
```

**Inflation Prediction - Baseline Model (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.e24.q14hmm2021.for2to7 <- plm(E2y_all ~  q14_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e24.q14hmm2021.for2to7 <- within_intercept(m.lm.e24.q14hmm2021.for2to7, return.model = TRUE)
m.lm.e24.q14hmm2021.for2to7$cov1 <- vcovHC(m.lm.e24.q14hmm2021.for2to7, type = "HC1")
m.lm.e24.q14hmm2021.for2to7$robustse <- sqrt(diag(m.lm.e24.q14hmm2021.for2to7$cov1))
```

**Prediction Error - Baseline Model (Q14 - 24 Months)**
```{r}
m.lm.eerror24.q14.for2to7 <- plm(CPIH_prediction_error_scale_2009_24 ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14.for2to7 <- within_intercept(m.lm.eerror24.q14.for2to7, return.model = TRUE)
m.lm.eerror24.q14.for2to7$cov1 <- vcovHC(m.lm.eerror24.q14.for2to7, type = "HC1")
m.lm.eerror24.q14.for2to7$robustse <- sqrt(diag(m.lm.eerror24.q14.for2to7$cov1))
```

**Prediction Error - Baseline Model (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.eerror24.q14hmm2021.for2to7 <- plm(CPIH_prediction_error_scale_2009_24 ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14hmm2021.for2to7 <- within_intercept(m.lm.eerror24.q14hmm2021.for2to7, return.model = TRUE)
m.lm.eerror24.q14hmm2021.for2to7$cov1 <- vcovHC(m.lm.eerror24.q14hmm2021.for2to7, type = "HC1")
m.lm.eerror24.q14hmm2021.for2to7$robustse <- sqrt(diag(m.lm.eerror24.q14hmm2021.for2to7$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 - 24 Months)**
```{r}
m.lm.eerror24abs.q14.for2to7 <- plm(CPIH_prediction_error_scale_2009_24_abs ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q14.for2to7 <- within_intercept(m.lm.eerror24abs.q14.for2to7, return.model = TRUE)
m.lm.eerror24abs.q14.for2to7$cov1 <- vcovHC(m.lm.eerror24abs.q14.for2to7, type = "HC1")
m.lm.eerror24abs.q14.for2to7$robustse <- sqrt(diag(m.lm.eerror24abs.q14.for2to7$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.eerror24abs.q142021.for2to7 <- plm(CPIH_prediction_error_scale_2009_24_abs ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q142021.for2to7 <- within_intercept(m.lm.eerror24abs.q142021.for2to7, return.model = TRUE)
m.lm.eerror24abs.q142021.for2to7$cov1 <- vcovHC(m.lm.eerror24abs.q142021.for2to7, type = "HC1")
m.lm.eerror24abs.q142021.for2to7$robustse <- sqrt(diag(m.lm.eerror24abs.q142021.for2to7$cov1))
```

**Inflation Prediction - Baseline Model (Q14 - 60 Months)**
```{r}
m.lm.e60.q14.for2to7 <- plm(E5y_all ~  q14 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e60.q14.for2to7 <- within_intercept(m.lm.e60.q14.for2to7, return.model = TRUE)
m.lm.e60.q14.for2to7$cov1 <- vcovHC(m.lm.e60.q14.for2to7, type = "HC1")
m.lm.e60.q14.for2to7$robustse <- sqrt(diag(m.lm.e60.q14.for2to7$cov1))
```

**Inflation Prediction - Baseline Model (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.e60.q14hmm2021.for2to7 <- plm(E5y_all ~  q14_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e60.q14hmm2021.for2to7 <- within_intercept(m.lm.e60.q14hmm2021.for2to7, return.model = TRUE)
m.lm.e60.q14hmm2021.for2to7$cov1 <- vcovHC(m.lm.e60.q14hmm2021.for2to7, type = "HC1")
m.lm.e60.q14hmm2021.for2to7$robustse <- sqrt(diag(m.lm.e60.q14hmm2021.for2to7$cov1))
```

**Prediction Error - Baseline Model (Q14 - 60 Months)**
```{r}
m.lm.eerror60.q14.for2to7 <- plm(CPIH_prediction_error_scale_2009_60 ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14.for2to7 <- within_intercept(m.lm.eerror60.q14.for2to7, return.model = TRUE)
m.lm.eerror60.q14.for2to7$cov1 <- vcovHC(m.lm.eerror60.q14.for2to7, type = "HC1")
m.lm.eerror60.q14.for2to7$robustse <- sqrt(diag(m.lm.eerror60.q14.for2to7$cov1))
```

**Prediction Error - Baseline Model (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.eerror60.q14hmm2021.for2to7 <- plm(CPIH_prediction_error_scale_2009_60 ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14hmm2021.for2to7 <- within_intercept(m.lm.eerror60.q14hmm2021.for2to7, return.model = TRUE)
m.lm.eerror60.q14hmm2021.for2to7$cov1 <- vcovHC(m.lm.eerror60.q14hmm2021.for2to7, type = "HC1")
m.lm.eerror60.q14hmm2021.for2to7$robustse <- sqrt(diag(m.lm.eerror60.q14hmm2021.for2to7$cov1))
```

**Prediction Error - Baseline Model (Q14 - 60 Months)**
```{r}
m.lm.eerror60abs.q14.for2to7 <- plm(CPIH_prediction_error_scale_2009_60_abs ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q14.for2to7 <- within_intercept(m.lm.eerror60abs.q14.for2to7, return.model = TRUE)
m.lm.eerror60abs.q14.for2to7$cov1 <- vcovHC(m.lm.eerror60abs.q14.for2to7, type = "HC1")
m.lm.eerror60abs.q14.for2to7$robustse <- sqrt(diag(m.lm.eerror60abs.q14.for2to7$cov1))
```

**Prediction Error - Baseline Model (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.eerror60abs.q142021.for2to7 <- plm(CPIH_prediction_error_scale_2009_60_abs ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q142021.for2to7 <- within_intercept(m.lm.eerror60abs.q142021.for2to7, return.model = TRUE)
m.lm.eerror60abs.q142021.for2to7$cov1 <- vcovHC(m.lm.eerror60abs.q142021.for2to7, type = "HC1")
m.lm.eerror60abs.q142021.for2to7$robustse <- sqrt(diag(m.lm.eerror60abs.q142021.for2to7$cov1))
```

###### Interacted Individual and Aggregate Trust Variables

**Inflation Perception - Formula [11] (Q14)**
```{r}
m.lm.p.q14.for11 <- plm(P_all ~  q14 + age + sex + tenure + class + income_fix + educ + sreg + work + agg_trust_inv + q14*agg_trust_inv, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.p.q14.for11 <- within_intercept(m.lm.p.q14.for11, return.model = TRUE)
m.lm.p.q14.for11$cov1 <- vcovHC(m.lm.p.q14.for11, type = "HC1")
m.lm.p.q14.for11$robustse <- sqrt(diag(m.lm.p.q14.for11$cov1))
```

**Inflation Perception - Formula [11] (Q14 Without Indifference Limen)**
```{r}
m.lm.p.q14hmm2021.for11 <- plm(P_all ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.p.q14hmm2021.for11 <- within_intercept(m.lm.p.q14hmm2021.for11, return.model = TRUE)
m.lm.p.q14hmm2021.for11$cov1 <- vcovHC(m.lm.p.q14hmm2021.for11, type = "HC1")
m.lm.p.q14hmm2021.for11$robustse <- sqrt(diag(m.lm.p.q14hmm2021.for11$cov1))
```

**Perception Error - Formula [11] (Q14)**
```{r}
m.lm.perror.q14.for11 <- plm(CPIH_perception_error_scale_2009 ~  q14 + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14.for11 <- within_intercept(m.lm.perror.q14.for11, return.model = TRUE)
m.lm.perror.q14.for11$cov1 <- vcovHC(m.lm.perror.q14.for11, type = "HC1")
m.lm.perror.q14.for11$robustse <- sqrt(diag(m.lm.perror.q14.for11$cov1))
```

**Perception Error - Formula [11] (Q14 Without Indifference Limen)**
```{r}
m.lm.perror.q14hmm2021.for11 <- plm(CPIH_perception_error_scale_2009 ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14hmm2021.for11 <- within_intercept(m.lm.perror.q14hmm2021.for11, return.model = TRUE)
m.lm.perror.q14hmm2021.for11$cov1 <- vcovHC(m.lm.perror.q14hmm2021.for11, type = "HC1")
m.lm.perror.q14hmm2021.for11$robustse <- sqrt(diag(m.lm.perror.q14hmm2021.for11$cov1))
```

**Absolute Perception Error - Formula [11] (Q14)**
```{r}
m.lm.perrorabs.q14.for11 <- plm(CPIH_perception_error_scale_2009_abs ~  q14 + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q14.for11 <- within_intercept(m.lm.perrorabs.q14.for11, return.model = TRUE)
m.lm.perrorabs.q14.for11$cov1 <- vcovHC(m.lm.perrorabs.q14.for11, type = "HC1")
m.lm.perrorabs.q14.for11$robustse <- sqrt(diag(m.lm.perrorabs.q14.for11$cov1))
```

**Absolute Perception Error - Formula [11] (Q14 Without Indifference Limen)**
```{r}
m.lm.perrorabs.q142021.for11 <- plm(CPIH_perception_error_scale_2009_abs ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q142021.for11 <- within_intercept(m.lm.perrorabs.q142021.for11, return.model = TRUE)
m.lm.perrorabs.q142021.for11$cov1 <- vcovHC(m.lm.perrorabs.q142021.for11, type = "HC1")
m.lm.perrorabs.q142021.for11$robustse <- sqrt(diag(m.lm.perrorabs.q142021.for11$cov1))
```

**Inflation Prediction - Formula [11] (Q14 - 12 Months)**
```{r}
m.lm.e12.q14.for11 <- plm(E1y_all ~  q14 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e12.q14.for11 <- within_intercept(m.lm.e12.q14.for11, return.model = TRUE)
m.lm.e12.q14.for11$cov1 <- vcovHC(m.lm.e12.q14.for11, type = "HC1")
m.lm.e12.q14.for11$robustse <- sqrt(diag(m.lm.e12.q14.for11$cov1))
```

**Inflation Prediction - Formula [11] (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.e12.q14hmm2021.for11 <- plm(E1y_all ~  q14_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e12.q14hmm2021.for11 <- within_intercept(m.lm.e12.q14hmm2021.for11, return.model = TRUE)
m.lm.e12.q14hmm2021.for11$cov1 <- vcovHC(m.lm.e12.q14hmm2021.for11, type = "HC1")
m.lm.e12.q14hmm2021.for11$robustse <- sqrt(diag(m.lm.e12.q14hmm2021.for11$cov1))
```

**Prediction Error - Formula [11] (Q14 - 12 Months)**
```{r}
m.lm.eerror12.q14.for11 <- plm(CPIH_prediction_error_scale_2009_12 ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14.for11 <- within_intercept(m.lm.eerror12.q14.for11, return.model = TRUE)
m.lm.eerror12.q14.for11$cov1 <- vcovHC(m.lm.eerror12.q14.for11, type = "HC1")
m.lm.eerror12.q14.for11$robustse <- sqrt(diag(m.lm.eerror12.q14.for11$cov1))
```

**Prediction Error - Formula [11] (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.eerror12.q14hmm2021.for11 <- plm(CPIH_prediction_error_scale_2009_12 ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14hmm2021.for11 <- within_intercept(m.lm.eerror12.q14hmm2021.for11, return.model = TRUE)
m.lm.eerror12.q14hmm2021.for11$cov1 <- vcovHC(m.lm.eerror12.q14hmm2021.for11, type = "HC1")
m.lm.eerror12.q14hmm2021.for11$robustse <- sqrt(diag(m.lm.eerror12.q14hmm2021.for11$cov1))
```

**Absolute Prediction Error - Formula [11] (Q14 - 12 Months)**
```{r}
m.lm.eerror12abs.q14.for11 <- plm(CPIH_prediction_error_scale_2009_12_abs ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q14.for11 <- within_intercept(m.lm.eerror12abs.q14.for11, return.model = TRUE)
m.lm.eerror12abs.q14.for11$cov1 <- vcovHC(m.lm.eerror12abs.q14.for11, type = "HC1")
m.lm.eerror12abs.q14.for11$robustse <- sqrt(diag(m.lm.eerror12abs.q14.for11$cov1))
```

**Absolute Prediction Error - Formula [11] (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.eerror12abs.q142021.for11 <- plm(CPIH_prediction_error_scale_2009_12_abs ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q142021.for11 <- within_intercept(m.lm.eerror12abs.q142021.for11, return.model = TRUE)
m.lm.eerror12abs.q142021.for11$cov1 <- vcovHC(m.lm.eerror12abs.q142021.for11, type = "HC1")
m.lm.eerror12abs.q142021.for11$robustse <- sqrt(diag(m.lm.eerror12abs.q142021.for11$cov1))
```

**Inflation Prediction - Formula [11] (Q14 - 24 Months)**
```{r}
m.lm.e24.q14.for11 <- plm(E2y_all ~  q14 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e24.q14.for11 <- within_intercept(m.lm.e24.q14.for11, return.model = TRUE)
m.lm.e24.q14.for11$cov1 <- vcovHC(m.lm.e24.q14.for11, type = "HC1")
m.lm.e24.q14.for11$robustse <- sqrt(diag(m.lm.e24.q14.for11$cov1))
```

**Inflation Prediction - Formula [11] (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.e24.q14hmm2021.for11 <- plm(E2y_all ~  q14_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e24.q14hmm2021.for11 <- within_intercept(m.lm.e24.q14hmm2021.for11, return.model = TRUE)
m.lm.e24.q14hmm2021.for11$cov1 <- vcovHC(m.lm.e24.q14hmm2021.for11, type = "HC1")
m.lm.e24.q14hmm2021.for11$robustse <- sqrt(diag(m.lm.e24.q14hmm2021.for11$cov1))
```

**Prediction Error - Formula [11] (Q14 - 24 Months)**
```{r}
m.lm.eerror24.q14.for11 <- plm(CPIH_prediction_error_scale_2009_24 ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14.for11 <- within_intercept(m.lm.eerror24.q14.for11, return.model = TRUE)
m.lm.eerror24.q14.for11$cov1 <- vcovHC(m.lm.eerror24.q14.for11, type = "HC1")
m.lm.eerror24.q14.for11$robustse <- sqrt(diag(m.lm.eerror24.q14.for11$cov1))
```

**Prediction Error - Formula [11] (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.eerror24.q14hmm2021.for11 <- plm(CPIH_prediction_error_scale_2009_24 ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14hmm2021.for11 <- within_intercept(m.lm.eerror24.q14hmm2021.for11, return.model = TRUE)
m.lm.eerror24.q14hmm2021.for11$cov1 <- vcovHC(m.lm.eerror24.q14hmm2021.for11, type = "HC1")
m.lm.eerror24.q14hmm2021.for11$robustse <- sqrt(diag(m.lm.eerror24.q14hmm2021.for11$cov1))
```

**Absolute Prediction Error - Formula [11] (Q14 - 24 Months)**
```{r}
m.lm.eerror24abs.q14.for11 <- plm(CPIH_prediction_error_scale_2009_24_abs ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q14.for11 <- within_intercept(m.lm.eerror24abs.q14.for11, return.model = TRUE)
m.lm.eerror24abs.q14.for11$cov1 <- vcovHC(m.lm.eerror24abs.q14.for11, type = "HC1")
m.lm.eerror24abs.q14.for11$robustse <- sqrt(diag(m.lm.eerror24abs.q14.for11$cov1))
```

**Absolute Prediction Error - Formula [11] (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.eerror24abs.q142021.for11 <- plm(CPIH_prediction_error_scale_2009_24_abs ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q142021.for11 <- within_intercept(m.lm.eerror24abs.q142021.for11, return.model = TRUE)
m.lm.eerror24abs.q142021.for11$cov1 <- vcovHC(m.lm.eerror24abs.q142021.for11, type = "HC1")
m.lm.eerror24abs.q142021.for11$robustse <- sqrt(diag(m.lm.eerror24abs.q142021.for11$cov1))
```

**Inflation Prediction - Formula [11] (Q14 - 60 Months)**
```{r}
m.lm.e60.q14.for11 <- plm(E5y_all ~  q14 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e60.q14.for11 <- within_intercept(m.lm.e60.q14.for11, return.model = TRUE)
m.lm.e60.q14.for11$cov1 <- vcovHC(m.lm.e60.q14.for11, type = "HC1")
m.lm.e60.q14.for11$robustse <- sqrt(diag(m.lm.e60.q14.for11$cov1))
```

**Inflation Prediction - Formula [11] (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.e60.q14hmm2021.for11 <- plm(E5y_all ~  q14_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e60.q14hmm2021.for11 <- within_intercept(m.lm.e60.q14hmm2021.for11, return.model = TRUE)
m.lm.e60.q14hmm2021.for11$cov1 <- vcovHC(m.lm.e60.q14hmm2021.for11, type = "HC1")
m.lm.e60.q14hmm2021.for11$robustse <- sqrt(diag(m.lm.e60.q14hmm2021.for11$cov1))
```

**Prediction Error - Formula [11] (Q14 - 60 Months)**
```{r}
m.lm.eerror60.q14.for11 <- plm(CPIH_prediction_error_scale_2009_60 ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14.for11 <- within_intercept(m.lm.eerror60.q14.for11, return.model = TRUE)
m.lm.eerror60.q14.for11$cov1 <- vcovHC(m.lm.eerror60.q14.for11, type = "HC1")
m.lm.eerror60.q14.for11$robustse <- sqrt(diag(m.lm.eerror60.q14.for11$cov1))
```

**Prediction Error - Formula [11] (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.eerror60.q14hmm2021.for11 <- plm(CPIH_prediction_error_scale_2009_60 ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14hmm2021.for11 <- within_intercept(m.lm.eerror60.q14hmm2021.for11, return.model = TRUE)
m.lm.eerror60.q14hmm2021.for11$cov1 <- vcovHC(m.lm.eerror60.q14hmm2021.for11, type = "HC1")
m.lm.eerror60.q14hmm2021.for11$robustse <- sqrt(diag(m.lm.eerror60.q14hmm2021.for11$cov1))
```

**Absolute Prediction Error - Formula [11] (Q14 - 60 Months)**
```{r}
m.lm.eerror60abs.q14.for11 <- plm(CPIH_prediction_error_scale_2009_60_abs ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14*agg_trust_inv, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q14.for11 <- within_intercept(m.lm.eerror60abs.q14.for11, return.model = TRUE)
m.lm.eerror60abs.q14.for11$cov1 <- vcovHC(m.lm.eerror60abs.q14.for11, type = "HC1")
m.lm.eerror60abs.q14.for11$robustse <- sqrt(diag(m.lm.eerror60abs.q14.for11$cov1))
```

**Absolute Prediction Error - Formula [11] (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.eerror60abs.q142021.for11 <- plm(CPIH_prediction_error_scale_2009_60_abs ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + q14_hmm2021*agg_trust_inv, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q142021.for11 <- within_intercept(m.lm.eerror60abs.q142021.for11, return.model = TRUE)
m.lm.eerror60abs.q142021.for11$cov1 <- vcovHC(m.lm.eerror60abs.q142021.for11, type = "HC1")
m.lm.eerror60abs.q142021.for11$robustse <- sqrt(diag(m.lm.eerror60abs.q142021.for11$cov1))
```

###### CPI Comparison

**Perception Error - CPI-Based Model (Q14)**
```{r}
m.lm.perror.q14.CPI <- plm(CPI_perception_error_scale_2009 ~  q14 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14.CPI <- within_intercept(m.lm.perror.q14.CPI, return.model = TRUE)
m.lm.perror.q14.CPI$cov1 <- vcovHC(m.lm.perror.q14.CPI, type = "HC1")
m.lm.perror.q14.CPI$robustse <- sqrt(diag(m.lm.perror.q14.CPI$cov1))
```

**Perception Error - CPI-Based Model (Q14 Without Indifference Limen)**
```{r}
m.lm.perror.q14hmm2021.CPI <- plm(CPI_perception_error_scale_2009 ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14hmm2021.CPI <- within_intercept(m.lm.perror.q14hmm2021.CPI, return.model = TRUE)
m.lm.perror.q14hmm2021.CPI$cov1 <- vcovHC(m.lm.perror.q14hmm2021.CPI, type = "HC1")
m.lm.perror.q14hmm2021.CPI$robustse <- sqrt(diag(m.lm.perror.q14hmm2021.CPI$cov1))
```

**Absolute Perception Error - CPI-Based Model (Q14)**
```{r}
m.lm.perrorabs.q14.CPI <- plm(CPI_perception_error_scale_2009_abs ~  q14 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q14.CPI <- within_intercept(m.lm.perrorabs.q14.CPI, return.model = TRUE)
m.lm.perrorabs.q14.CPI$cov1 <- vcovHC(m.lm.perrorabs.q14.CPI, type = "HC1")
m.lm.perrorabs.q14.CPI$robustse <- sqrt(diag(m.lm.perrorabs.q14.CPI$cov1))
```

**Absolute Perception Error - CPI-Based Model (Q14 Without Indifference Limen)**
```{r}
m.lm.perrorabs.q142021.CPI <- plm(CPI_perception_error_scale_2009_abs ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q142021.CPI <- within_intercept(m.lm.perrorabs.q142021.CPI, return.model = TRUE)
m.lm.perrorabs.q142021.CPI$cov1 <- vcovHC(m.lm.perrorabs.q142021.CPI, type = "HC1")
m.lm.perrorabs.q142021.CPI$robustse <- sqrt(diag(m.lm.perrorabs.q142021.CPI$cov1))
```

**Prediction Error - Baseline Model (Q14 - 12 Months)**
```{r}
m.lm.eerror12.q14.CPI <- plm(CPI_prediction_error_scale_2009_12 ~  q14 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14.CPI <- within_intercept(m.lm.eerror12.q14.CPI, return.model = TRUE)
m.lm.eerror12.q14.CPI$cov1 <- vcovHC(m.lm.eerror12.q14.CPI, type = "HC1")
m.lm.eerror12.q14.CPI$robustse <- sqrt(diag(m.lm.eerror12.q14.CPI$cov1))
```

**Prediction Error - Baseline Model (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.eerror12.q14hmm2021.CPI <- plm(CPI_prediction_error_scale_2009_12 ~  q14_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14hmm2021.CPI <- within_intercept(m.lm.eerror12.q14hmm2021.CPI, return.model = TRUE)
m.lm.eerror12.q14hmm2021.CPI$cov1 <- vcovHC(m.lm.eerror12.q14hmm2021.CPI, type = "HC1")
m.lm.eerror12.q14hmm2021.CPI$robustse <- sqrt(diag(m.lm.eerror12.q14hmm2021.CPI$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 = 12 Months)**
```{r}
m.lm.eerror12abs.q14.CPI <- plm(CPI_prediction_error_scale_2009_12_abs ~  q14 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q14.CPI <- within_intercept(m.lm.eerror12abs.q14.CPI, return.model = TRUE)
m.lm.eerror12abs.q14.CPI$cov1 <- vcovHC(m.lm.eerror12abs.q14.CPI, type = "HC1")
m.lm.eerror12abs.q14.CPI$robustse <- sqrt(diag(m.lm.eerror12abs.q14.CPI$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.eerror12abs.q142021.CPI <- plm(CPI_prediction_error_scale_2009_12_abs ~  q14_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q142021.CPI <- within_intercept(m.lm.eerror12abs.q142021.CPI, return.model = TRUE)
m.lm.eerror12abs.q142021.CPI$cov1 <- vcovHC(m.lm.eerror12abs.q142021.CPI, type = "HC1")
m.lm.eerror12abs.q142021.CPI$robustse <- sqrt(diag(m.lm.eerror12abs.q142021.CPI$cov1))
```


**Prediction Error - CPI-Based Model (Q14 - 24 Months)**
```{r}
m.lm.eerror24.q14.CPI <- plm(CPI_prediction_error_scale_2009_24 ~  q14 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14.CPI <- within_intercept(m.lm.eerror24.q14.CPI, return.model = TRUE)
m.lm.eerror24.q14.CPI$cov1 <- vcovHC(m.lm.eerror24.q14.CPI, type = "HC1")
m.lm.eerror24.q14.CPI$robustse <- sqrt(diag(m.lm.eerror24.q14.CPI$cov1))
```

**Prediction Error - CPI-Based Model (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.eerror24.q14hmm2021.CPI <- plm(CPI_prediction_error_scale_2009_24 ~  q14_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14hmm2021.CPI <- within_intercept(m.lm.eerror24.q14hmm2021.CPI, return.model = TRUE)
m.lm.eerror24.q14hmm2021.CPI$cov1 <- vcovHC(m.lm.eerror24.q14hmm2021.CPI, type = "HC1")
m.lm.eerror24.q14hmm2021.CPI$robustse <- sqrt(diag(m.lm.eerror24.q14hmm2021.CPI$cov1))
```

**Absolute Prediction Error - CPI-Based Model (Q14 - 24 Months)**
```{r}
m.lm.eerror24abs.q14.CPI <- plm(CPI_prediction_error_scale_2009_24_abs ~  q14 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q14.CPI <- within_intercept(m.lm.eerror24abs.q14.CPI, return.model = TRUE)
m.lm.eerror24abs.q14.CPI$cov1 <- vcovHC(m.lm.eerror24abs.q14.CPI, type = "HC1")
m.lm.eerror24abs.q14.CPI$robustse <- sqrt(diag(m.lm.eerror24abs.q14.CPI$cov1))
```

**Absolute Prediction Error - CPI-Based Model (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.eerror24abs.q142021.CPI <- plm(CPI_prediction_error_scale_2009_24_abs ~  q14_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q142021.CPI <- within_intercept(m.lm.eerror24abs.q142021.CPI, return.model = TRUE)
m.lm.eerror24abs.q142021.CPI$cov1 <- vcovHC(m.lm.eerror24abs.q142021.CPI, type = "HC1")
m.lm.eerror24abs.q142021.CPI$robustse <- sqrt(diag(m.lm.eerror24abs.q142021.CPI$cov1))
```

**Prediction Error - CPI-Based Model (Q14 - 60 Months)**
```{r}
m.lm.eerror60.q14.CPI <- plm(CPI_prediction_error_scale_2009_60 ~  q14 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14.CPI <- within_intercept(m.lm.eerror60.q14.CPI, return.model = TRUE)
m.lm.eerror60.q14.CPI$cov1 <- vcovHC(m.lm.eerror60.q14.CPI, type = "HC1")
m.lm.eerror60.q14.CPI$robustse <- sqrt(diag(m.lm.eerror60.q14.CPI$cov1))
```

**Prediction Error - CPI-Based Model (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.eerror60.q14hmm2021.CPI <- plm(CPI_prediction_error_scale_2009_60 ~  q14_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14hmm2021.CPI <- within_intercept(m.lm.eerror60.q14hmm2021.CPI, return.model = TRUE)
m.lm.eerror60.q14hmm2021.CPI$cov1 <- vcovHC(m.lm.eerror60.q14hmm2021.CPI, type = "HC1")
m.lm.eerror60.q14hmm2021.CPI$robustse <- sqrt(diag(m.lm.eerror60.q14hmm2021.CPI$cov1))
```

**Absolute Prediction Error - CPI-Based Model (Q14 - 60 Months)**
```{r}
m.lm.eerror60abs.q14.CPI <- plm(CPI_prediction_error_scale_2009_60_abs ~  q14 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q14.CPI <- within_intercept(m.lm.eerror60abs.q14.CPI, return.model = TRUE)
m.lm.eerror60abs.q14.CPI$cov1 <- vcovHC(m.lm.eerror60abs.q14.CPI, type = "HC1")
m.lm.eerror60abs.q14.CPI$robustse <- sqrt(diag(m.lm.eerror60abs.q14.CPI$cov1))
```

**Absolute Prediction Error - CPI-Based Model (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.eerror60abs.q142021.CPI <- plm(CPI_prediction_error_scale_2009_60_abs ~  q14_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q142021.CPI <- within_intercept(m.lm.eerror60abs.q142021.CPI, return.model = TRUE)
m.lm.eerror60abs.q142021.CPI$cov1 <- vcovHC(m.lm.eerror60abs.q142021.CPI, type = "HC1")
m.lm.eerror60abs.q142021.CPI$robustse <- sqrt(diag(m.lm.eerror60abs.q142021.CPI$cov1))
```

###### Knowledge Models

**Inflation Perception - Baseline Model (Q14)**
```{r}
m.lm.p.q14.know <- plm(P_all ~  q14 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.p.q14.know <- within_intercept(m.lm.p.q14.know, return.model = TRUE)
m.lm.p.q14.know$cov1 <- vcovHC(m.lm.p.q14.know, type = "HC1")
m.lm.p.q14.know$robustse <- sqrt(diag(m.lm.p.q14.know$cov1))
```

**Inflation Perception - Baseline Model (Q14 Without Indifference Limen)**
```{r}
m.lm.p.q14hmm2021.know <- plm(P_all ~  q14_hmm2021 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.p.q14hmm2021.know <- within_intercept(m.lm.p.q14hmm2021.know, return.model = TRUE)
m.lm.p.q14hmm2021.know$cov1 <- vcovHC(m.lm.p.q14hmm2021.know, type = "HC1")
m.lm.p.q14hmm2021.know$robustse <- sqrt(diag(m.lm.p.q14hmm2021.know$cov1))
```

**Perception Error - Baseline Model (Q14)**
```{r}
m.lm.perror.q14.know <- plm(CPIH_perception_error_scale_2009 ~  q14 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14.know <- within_intercept(m.lm.perror.q14.know, return.model = TRUE)
m.lm.perror.q14.know$cov1 <- vcovHC(m.lm.perror.q14.know, type = "HC1")
m.lm.perror.q14.know$robustse <- sqrt(diag(m.lm.perror.q14.know$cov1))
```

**Perception Error - Baseline Model (Q14 Without Indifference Limen)**
```{r}
m.lm.perror.q14hmm2021.know <- plm(CPIH_perception_error_scale_2009 ~  q14_hmm2021 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14hmm2021.know <- within_intercept(m.lm.perror.q14hmm2021.know, return.model = TRUE)
m.lm.perror.q14hmm2021.know$cov1 <- vcovHC(m.lm.perror.q14hmm2021.know, type = "HC1")
m.lm.perror.q14hmm2021.know$robustse <- sqrt(diag(m.lm.perror.q14hmm2021.know$cov1))
```

**Absolute Perception Error - Baseline Model (Q14)**
```{r}
m.lm.perrorabs.q14.know <- plm(CPIH_perception_error_scale_2009_abs ~  q14 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q14.know <- within_intercept(m.lm.perrorabs.q14.know, return.model = TRUE)
m.lm.perrorabs.q14.know$cov1 <- vcovHC(m.lm.perrorabs.q14.know, type = "HC1")
m.lm.perrorabs.q14.know$robustse <- sqrt(diag(m.lm.perrorabs.q14.know$cov1))
```

**Absolute Perception Error - Baseline Model (Q14 Without Indifference Limen)**
```{r}
m.lm.perrorabs.q142021.know <- plm(CPIH_perception_error_scale_2009_abs ~  q14_hmm2021 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q142021.know <- within_intercept(m.lm.perrorabs.q142021.know, return.model = TRUE)
m.lm.perrorabs.q142021.know$cov1 <- vcovHC(m.lm.perrorabs.q142021.know, type = "HC1")
m.lm.perrorabs.q142021.know$robustse <- sqrt(diag(m.lm.perrorabs.q142021.know$cov1))
```

**Inflation Prediction - Baseline Model (Q14 - 12 Months)**
```{r}
m.lm.e12.q14.know <- plm(E1y_all ~  q14 + P_all + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e12.q14.know <- within_intercept(m.lm.e12.q14.know, return.model = TRUE)
m.lm.e12.q14.know$cov1 <- vcovHC(m.lm.e12.q14.know, type = "HC1")
m.lm.e12.q14.know$robustse <- sqrt(diag(m.lm.e12.q14.know$cov1))
```

**Inflation Prediction - Baseline Model (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.e12.q14hmm2021.know <- plm(E1y_all ~  q14_hmm2021 + P_all + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e12.q14hmm2021.know <- within_intercept(m.lm.e12.q14hmm2021.know, return.model = TRUE)
m.lm.e12.q14hmm2021.know$cov1 <- vcovHC(m.lm.e12.q14hmm2021.know, type = "HC1")
m.lm.e12.q14hmm2021.know$robustse <- sqrt(diag(m.lm.e12.q14hmm2021.know$cov1))
```

**Prediction Error - Baseline Model (Q14 - 12 Months)**
```{r}
m.lm.eerror12.q14.know <- plm(CPIH_prediction_error_scale_2009_12 ~  q14 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14.know <- within_intercept(m.lm.eerror12.q14.know, return.model = TRUE)
m.lm.eerror12.q14.know$cov1 <- vcovHC(m.lm.eerror12.q14.know, type = "HC1")
m.lm.eerror12.q14.know$robustse <- sqrt(diag(m.lm.eerror12.q14.know$cov1))
```

**Prediction Error - Baseline Model (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.eerror12.q14hmm2021.know <- plm(CPIH_prediction_error_scale_2009_12 ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14hmm2021.know <- within_intercept(m.lm.eerror12.q14hmm2021.know, return.model = TRUE)
m.lm.eerror12.q14hmm2021.know$cov1 <- vcovHC(m.lm.eerror12.q14hmm2021.know, type = "HC1")
m.lm.eerror12.q14hmm2021.know$robustse <- sqrt(diag(m.lm.eerror12.q14hmm2021.know$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 = 12 Months)**
```{r}
m.lm.eerror12abs.q14.know <- plm(CPIH_prediction_error_scale_2009_12_abs ~  q14 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q14.know <- within_intercept(m.lm.eerror12abs.q14.know, return.model = TRUE)
m.lm.eerror12abs.q14.know$cov1 <- vcovHC(m.lm.eerror12abs.q14.know, type = "HC1")
m.lm.eerror12abs.q14.know$robustse <- sqrt(diag(m.lm.eerror12abs.q14.know$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 Without Indifference Limen - 12 Months)**
```{r}
m.lm.eerror12abs.q142021.know <- plm(CPIH_prediction_error_scale_2009_12_abs ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q142021.know <- within_intercept(m.lm.eerror12abs.q142021.know, return.model = TRUE)
m.lm.eerror12abs.q142021.know$cov1 <- vcovHC(m.lm.eerror12abs.q142021.know, type = "HC1")
m.lm.eerror12abs.q142021.know$robustse <- sqrt(diag(m.lm.eerror12abs.q142021.know$cov1))
```

**Inflation Prediction - Baseline Model (Q14 - 24 Months)**
```{r}
m.lm.e24.q14.know <- plm(E2y_all ~  q14 + P_all + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e24.q14.know <- within_intercept(m.lm.e24.q14.know, return.model = TRUE)
m.lm.e24.q14.know$cov1 <- vcovHC(m.lm.e24.q14.know, type = "HC1")
m.lm.e24.q14.know$robustse <- sqrt(diag(m.lm.e24.q14.know$cov1))
```

**Inflation Prediction - Baseline Model (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.e24.q14hmm2021.know <- plm(E2y_all ~  q14_hmm2021 + P_all + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e24.q14hmm2021.know <- within_intercept(m.lm.e24.q14hmm2021.know, return.model = TRUE)
m.lm.e24.q14hmm2021.know$cov1 <- vcovHC(m.lm.e24.q14hmm2021.know, type = "HC1")
m.lm.e24.q14hmm2021.know$robustse <- sqrt(diag(m.lm.e24.q14hmm2021.know$cov1))
```

**Prediction Error - Baseline Model (Q14 - 24 Months)**
```{r}
m.lm.eerror24.q14.know <- plm(CPIH_prediction_error_scale_2009_24 ~  q14 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14.know <- within_intercept(m.lm.eerror24.q14.know, return.model = TRUE)
m.lm.eerror24.q14.know$cov1 <- vcovHC(m.lm.eerror24.q14.know, type = "HC1")
m.lm.eerror24.q14.know$robustse <- sqrt(diag(m.lm.eerror24.q14.know$cov1))
```

**Prediction Error - Baseline Model (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.eerror24.q14hmm2021.know <- plm(CPIH_prediction_error_scale_2009_24 ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14hmm2021.know <- within_intercept(m.lm.eerror24.q14hmm2021.know, return.model = TRUE)
m.lm.eerror24.q14hmm2021.know$cov1 <- vcovHC(m.lm.eerror24.q14hmm2021.know, type = "HC1")
m.lm.eerror24.q14hmm2021.know$robustse <- sqrt(diag(m.lm.eerror24.q14hmm2021.know$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 - 24 Months)**
```{r}
m.lm.eerror24abs.q14.know <- plm(CPIH_prediction_error_scale_2009_24_abs ~  q14 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q14.know <- within_intercept(m.lm.eerror24abs.q14.know, return.model = TRUE)
m.lm.eerror24abs.q14.know$cov1 <- vcovHC(m.lm.eerror24abs.q14.know, type = "HC1")
m.lm.eerror24abs.q14.know$robustse <- sqrt(diag(m.lm.eerror24abs.q14.know$cov1))
```

**Absolute Prediction Error - Baseline Model (Q14 Without Indifference Limen - 24 Months)**
```{r}
m.lm.eerror24abs.q142021.know <- plm(CPIH_prediction_error_scale_2009_24_abs ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q142021.know <- within_intercept(m.lm.eerror24abs.q142021.know, return.model = TRUE)
m.lm.eerror24abs.q142021.know$cov1 <- vcovHC(m.lm.eerror24abs.q142021.know, type = "HC1")
m.lm.eerror24abs.q142021.know$robustse <- sqrt(diag(m.lm.eerror24abs.q142021.know$cov1))
```

**Inflation Prediction - Baseline Model (Q14 - 60 Months)**
```{r}
m.lm.e60.q14.know <- plm(E5y_all ~  q14 + P_all + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e60.q14.know <- within_intercept(m.lm.e60.q14.know, return.model = TRUE)
m.lm.e60.q14.know$cov1 <- vcovHC(m.lm.e60.q14.know, type = "HC1")
m.lm.e60.q14.know$robustse <- sqrt(diag(m.lm.e60.q14.know$cov1))
```

**Inflation Prediction - Baseline Model (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.e60.q14hmm2021.know <- plm(E5y_all ~  q14_hmm2021 + P_all + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e60.q14hmm2021.know <- within_intercept(m.lm.e60.q14hmm2021.know, return.model = TRUE)
m.lm.e60.q14hmm2021.know$cov1 <- vcovHC(m.lm.e60.q14hmm2021.know, type = "HC1")
m.lm.e60.q14hmm2021.know$robustse <- sqrt(diag(m.lm.e60.q14hmm2021.know$cov1))
```

**Prediction Error - Baseline Model (Q14 - 60 Months)**
```{r}
m.lm.eerror60.q14.know <- plm(CPIH_prediction_error_scale_2009_60 ~  q14 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14.know <- within_intercept(m.lm.eerror60.q14.know, return.model = TRUE)
m.lm.eerror60.q14.know$cov1 <- vcovHC(m.lm.eerror60.q14.know, type = "HC1")
m.lm.eerror60.q14.know$robustse <- sqrt(diag(m.lm.eerror60.q14.know$cov1))
```

**Prediction Error - Baseline Model (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.eerror60.q14hmm2021.know <- plm(CPIH_prediction_error_scale_2009_60 ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14hmm2021.know <- within_intercept(m.lm.eerror60.q14hmm2021.know, return.model = TRUE)
m.lm.eerror60.q14hmm2021.know$cov1 <- vcovHC(m.lm.eerror60.q14hmm2021.know, type = "HC1")
m.lm.eerror60.q14hmm2021.know$robustse <- sqrt(diag(m.lm.eerror60.q14hmm2021.know$cov1))
```

**Prediction Error - Baseline Model (Q14 - 60 Months)**
```{r}
m.lm.eerror60abs.q14.know <- plm(CPIH_prediction_error_scale_2009_60_abs ~  q14 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q14.know <- within_intercept(m.lm.eerror60abs.q14.know, return.model = TRUE)
m.lm.eerror60abs.q14.know$cov1 <- vcovHC(m.lm.eerror60abs.q14.know, type = "HC1")
m.lm.eerror60abs.q14.know$robustse <- sqrt(diag(m.lm.eerror60abs.q14.know$cov1))
```

**Prediction Error - Baseline Model (Q14 Without Indifference Limen - 60 Months)**
```{r}
m.lm.eerror60abs.q142021.know <- plm(CPIH_prediction_error_scale_2009_60_abs ~  q14_hmm2021 + CPIH_perception_error_scale_2009 + age + knowledge_hmm2021 + eknowledge_hmm2021 + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q142021.know <- within_intercept(m.lm.eerror60abs.q142021.know, return.model = TRUE)
m.lm.eerror60abs.q142021.know$cov1 <- vcovHC(m.lm.eerror60abs.q142021.know, type = "HC1")
m.lm.eerror60abs.q142021.know$robustse <- sqrt(diag(m.lm.eerror60abs.q142021.know$cov1))
```

###### Quadratric Terms

**Inflation Perception - Quadratic Formula (Q14)**
```{r}
m.lm.p.q14.quad <- plm(P_all ~  q14 + I(q14^2) + q14:I(q14^2) + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.p.q14.quad <- within_intercept(m.lm.p.q14.quad, return.model = TRUE)
m.lm.p.q14.quad$cov1 <- vcovHC(m.lm.p.q14.quad, type = "HC1")
m.lm.p.q14.quad$robustse <- sqrt(diag(m.lm.p.q14.quad$cov1))
```

**Inflation Perception - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.p.q14hmm2021.quad <- plm(P_all ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.p.q14hmm2021.quad <- within_intercept(m.lm.p.q14hmm2021.quad, return.model = TRUE)
m.lm.p.q14hmm2021.quad$cov1 <- vcovHC(m.lm.p.q14hmm2021.quad, type = "HC1")
m.lm.p.q14hmm2021.quad$robustse <- sqrt(diag(m.lm.p.q14hmm2021.quad$cov1))
```

**Perception Error - Quadratic Formula (Q14)**
```{r}
m.lm.perror.q14.quad <- plm(CPIH_perception_error_scale_2009 ~  q14 + I(q14^2) + q14:I(q14^2) + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14.quad <- within_intercept(m.lm.perror.q14.quad, return.model = TRUE)
m.lm.perror.q14.quad$cov1 <- vcovHC(m.lm.perror.q14.quad, type = "HC1")
m.lm.perror.q14.quad$robustse <- sqrt(diag(m.lm.perror.q14.quad$cov1))
```

**Perception Error - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.perror.q14hmm2021.quad <- plm(CPIH_perception_error_scale_2009 ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perror.q14hmm2021.quad <- within_intercept(m.lm.perror.q14hmm2021.quad, return.model = TRUE)
m.lm.perror.q14hmm2021.quad$cov1 <- vcovHC(m.lm.perror.q14hmm2021.quad, type = "HC1")
m.lm.perror.q14hmm2021.quad$robustse <- sqrt(diag(m.lm.perror.q14hmm2021.quad$cov1))
```

**Absolute Perception Error - Quadratic Formula (Q14)**
```{r}
m.lm.perrorabs.q14.quad <- plm(CPIH_perception_error_scale_2009_abs ~  q14 + I(q14^2) + q14:I(q14^2) + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q14.quad <- within_intercept(m.lm.perrorabs.q14.quad, return.model = TRUE)
m.lm.perrorabs.q14.quad$cov1 <- vcovHC(m.lm.perrorabs.q14.quad, type = "HC1")
m.lm.perrorabs.q14.quad$robustse <- sqrt(diag(m.lm.perrorabs.q14.quad$cov1))
```

**Absolute Perception Error - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.perrorabs.q142021.quad <- plm(CPIH_perception_error_scale_2009_abs ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forA.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.perrorabs.q142021.quad <- within_intercept(m.lm.perrorabs.q142021.quad, return.model = TRUE)
m.lm.perrorabs.q142021.quad$cov1 <- vcovHC(m.lm.perrorabs.q142021.quad, type = "HC1")
m.lm.perrorabs.q142021.quad$robustse <- sqrt(diag(m.lm.perrorabs.q142021.quad$cov1))
```

**Inflation Prediction - 12 Months - Quadratic Formula (Q14)**
```{r}
m.lm.e12.q14.quad <- plm(E1y_all ~  q14 + I(q14^2) + q14:I(q14^2) + P_all + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e12.q14.quad <- within_intercept(m.lm.e12.q14.quad, return.model = TRUE)
m.lm.e12.q14.quad$cov1 <- vcovHC(m.lm.e12.q14.quad, type = "HC1")
m.lm.e12.q14.quad$robustse <- sqrt(diag(m.lm.e12.q14.quad$cov1))
```

**Inflation Prediction - 12 Months - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.e12.q14hmm2021.quad <- plm(E1y_all ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + P_all + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e12.q14hmm2021.quad <- within_intercept(m.lm.e12.q14hmm2021.quad, return.model = TRUE)
m.lm.e12.q14hmm2021.quad$cov1 <- vcovHC(m.lm.e12.q14hmm2021.quad, type = "HC1")
m.lm.e12.q14hmm2021.quad$robustse <- sqrt(diag(m.lm.e12.q14hmm2021.quad$cov1))
```

**Prediction Error - 12 Months - Quadratic Formula (Q14)**
```{r}
m.lm.eerror12.q14.quad <- plm(CPIH_prediction_error_scale_2009_12 ~  q14 + I(q14^2) + q14:I(q14^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14.quad <- within_intercept(m.lm.eerror12.q14.quad, return.model = TRUE)
m.lm.eerror12.q14.quad$cov1 <- vcovHC(m.lm.eerror12.q14.quad, type = "HC1")
m.lm.eerror12.q14.quad$robustse <- sqrt(diag(m.lm.eerror12.q14.quad$cov1))
```

**Prediction Error - 12 Months - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.eerror12.q14hmm2021.quad <- plm(CPIH_prediction_error_scale_2009_12 ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12.q14hmm2021.quad <- within_intercept(m.lm.eerror12.q14hmm2021.quad, return.model = TRUE)
m.lm.eerror12.q14hmm2021.quad$cov1 <- vcovHC(m.lm.eerror12.q14hmm2021.quad, type = "HC1")
m.lm.eerror12.q14hmm2021.quad$robustse <- sqrt(diag(m.lm.eerror12.q14hmm2021.quad$cov1))
```

**Absolute Prediction Error - 12 Months - Quadratic Formula (Q14)**
```{r}
m.lm.eerror12abs.q14.quad <- plm(CPIH_prediction_error_scale_2009_12_abs ~  q14 + I(q14^2) + q14:I(q14^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q14.quad <- within_intercept(m.lm.eerror12abs.q14.quad, return.model = TRUE)
m.lm.eerror12abs.q14.quad$cov1 <- vcovHC(m.lm.eerror12abs.q14.quad, type = "HC1")
m.lm.eerror12abs.q14.quad$robustse <- sqrt(diag(m.lm.eerror12abs.q14.quad$cov1))
```

**Absolute Prediction Error - 12 Months - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.eerror12abs.q142021.quad <- plm(CPIH_prediction_error_scale_2009_12_abs ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forB.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror12abs.q142021.quad <- within_intercept(m.lm.eerror12abs.q142021.quad, return.model = TRUE)
m.lm.eerror12abs.q142021.quad$cov1 <- vcovHC(m.lm.eerror12abs.q142021.quad, type = "HC1")
m.lm.eerror12abs.q142021.quad$robustse <- sqrt(diag(m.lm.eerror12abs.q142021.quad$cov1))
```

**Inflation Prediction - 24 Months - Quadratic Formula (Q14)**
```{r}
m.lm.e24.q14.quad <- plm(E2y_all ~  q14 + I(q14^2) + q14:I(q14^2) + P_all + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e24.q14.quad <- within_intercept(m.lm.e24.q14.quad, return.model = TRUE)
m.lm.e24.q14.quad$cov1 <- vcovHC(m.lm.e24.q14.quad, type = "HC1")
m.lm.e24.q14.quad$robustse <- sqrt(diag(m.lm.e24.q14.quad$cov1))
```

**Inflation Prediction - 24 Months - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.e24.q14hmm2021.quad <- plm(E2y_all ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + P_all + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e24.q14hmm2021.quad <- within_intercept(m.lm.e24.q14hmm2021.quad, return.model = TRUE)
m.lm.e24.q14hmm2021.quad$cov1 <- vcovHC(m.lm.e24.q14hmm2021.quad, type = "HC1")
m.lm.e24.q14hmm2021.quad$robustse <- sqrt(diag(m.lm.e24.q14hmm2021.quad$cov1))
```

**Prediction Error - 24 Months - Quadratic Formula (Q14)**
```{r}
m.lm.eerror24.q14.quad <- plm(CPIH_prediction_error_scale_2009_24 ~  q14 + I(q14^2) + q14:I(q14^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14.quad <- within_intercept(m.lm.eerror24.q14.quad, return.model = TRUE)
m.lm.eerror24.q14.quad$cov1 <- vcovHC(m.lm.eerror24.q14.quad, type = "HC1")
m.lm.eerror24.q14.quad$robustse <- sqrt(diag(m.lm.eerror24.q14.quad$cov1))
```

**Prediction Error - 24 Months - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.eerror24.q14hmm2021.quad <- plm(CPIH_prediction_error_scale_2009_24 ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24.q14hmm2021.quad <- within_intercept(m.lm.eerror24.q14hmm2021.quad, return.model = TRUE)
m.lm.eerror24.q14hmm2021.quad$cov1 <- vcovHC(m.lm.eerror24.q14hmm2021.quad, type = "HC1")
m.lm.eerror24.q14hmm2021.quad$robustse <- sqrt(diag(m.lm.eerror24.q14hmm2021.quad$cov1))
```

**Absolute Prediction Error - 24 Months - Quadratic Formula (Q14)**
```{r}
m.lm.eerror24abs.q14.quad <- plm(CPIH_prediction_error_scale_2009_24_abs ~  q14 + I(q14^2) + q14:I(q14^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q14.quad <- within_intercept(m.lm.eerror24abs.q14.quad, return.model = TRUE)
m.lm.eerror24abs.q14.quad$cov1 <- vcovHC(m.lm.eerror24abs.q14.quad, type = "HC1")
m.lm.eerror24abs.q14.quad$robustse <- sqrt(diag(m.lm.eerror24abs.q14.quad$cov1))
```

**Absolute Prediction Error - 24 Months - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.eerror24abs.q142021.quad <- plm(CPIH_prediction_error_scale_2009_24_abs ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forC.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror24abs.q142021.quad <- within_intercept(m.lm.eerror24abs.q142021.quad, return.model = TRUE)
m.lm.eerror24abs.q142021.quad$cov1 <- vcovHC(m.lm.eerror24abs.q142021.quad, type = "HC1")
m.lm.eerror24abs.q142021.quad$robustse <- sqrt(diag(m.lm.eerror24abs.q142021.quad$cov1))
```

**Inflation Prediction - 60 Months - Quadratic Formula (Q14)**
```{r}
m.lm.e60.q14.quad <- plm(E5y_all ~ q14 + I(q14^2) + q14:I(q14^2) + P_all + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e60.q14.quad <- within_intercept(m.lm.e60.q14.quad, return.model = TRUE)
m.lm.e60.q14.quad$cov1 <- vcovHC(m.lm.e60.q14.quad, type = "HC1")
m.lm.e60.q14.quad$robustse <- sqrt(diag(m.lm.e60.q14.quad$cov1))
```

**Inflation Prediction - 60 Months - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.e60.q14hmm2021.quad <- plm(E5y_all ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + P_all + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.e60.q14hmm2021.quad <- within_intercept(m.lm.e60.q14hmm2021.quad, return.model = TRUE)
m.lm.e60.q14hmm2021.quad$cov1 <- vcovHC(m.lm.e60.q14hmm2021.quad, type = "HC1")
m.lm.e60.q14hmm2021.quad$robustse <- sqrt(diag(m.lm.e60.q14hmm2021.quad$cov1))
```

**Prediction Error - 60 Months - Quadratic Formula (Q14)**
```{r}
m.lm.eerror60.q14.quad <- plm(CPIH_prediction_error_scale_2009_60 ~  q14 + I(q14^2) + q14:I(q14^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14.quad <- within_intercept(m.lm.eerror60.q14.quad, return.model = TRUE)
m.lm.eerror60.q14.quad$cov1 <- vcovHC(m.lm.eerror60.q14.quad, type = "HC1")
m.lm.eerror60.q14.quad$robustse <- sqrt(diag(m.lm.eerror60.q14.quad$cov1))
```

**Prediction Error - 60 Months - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.eerror60.q14hmm2021.quad <- plm(CPIH_prediction_error_scale_2009_60 ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60.q14hmm2021.quad <- within_intercept(m.lm.eerror60.q14hmm2021.quad, return.model = TRUE)
m.lm.eerror60.q14hmm2021.quad$cov1 <- vcovHC(m.lm.eerror60.q14hmm2021.quad, type = "HC1")
m.lm.eerror60.q14hmm2021.quad$robustse <- sqrt(diag(m.lm.eerror60.q14hmm2021.quad$cov1))
```

**Prediction Error - 60 Months - Quadratic Formula (Q14)**
```{r}
m.lm.eerror60abs.q14.quad <- plm(CPIH_prediction_error_scale_2009_60_abs ~  q14 + I(q14^2) + q14:I(q14^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q14.quad <- within_intercept(m.lm.eerror60abs.q14.quad, return.model = TRUE)
m.lm.eerror60abs.q14.quad$cov1 <- vcovHC(m.lm.eerror60abs.q14.quad, type = "HC1")
m.lm.eerror60abs.q14.quad$robustse <- sqrt(diag(m.lm.eerror60abs.q14.quad$cov1))
```

**Prediction Error - 60 Months - Quadratic Formula (Q14_hmm2021)**
```{r}
m.lm.eerror60abs.q142021.quad <- plm(CPIH_prediction_error_scale_2009_60_abs ~  q14_hmm2021 + I(q14_hmm2021^2) + q14_hmm2021:I(q14_hmm2021^2) + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work , data = df.forD.filtered, model = "within", index = "timetrend", effect = "time")
m.lm.eerror60abs.q142021.quad <- within_intercept(m.lm.eerror60abs.q142021.quad, return.model = TRUE)
m.lm.eerror60abs.q142021.quad$cov1 <- vcovHC(m.lm.eerror60abs.q142021.quad, type = "HC1")
m.lm.eerror60abs.q142021.quad$robustse <- sqrt(diag(m.lm.eerror60abs.q142021.quad$cov1))
```

###### Interval Regression

####### Create survreg objects for upper and lower-bounds

**Inflation Perceptions**
```{r}
p_intervals <- with(df.forA.filtered, Surv(time = P_all_lower, time2 = P_all_upper, type = "interval2"))
```

**Inflation Prediction - 12 Months**
```{r}
e12_intervals <- with(df.forB.filtered, Surv(time = E1y_all_lower, time2 = E1y_all_upper, type = "interval2"))
```

**Inflation Prediction - 24 Months**
```{r}
e24_intervals <- with(df.forC.filtered, Surv(time = E2y_all_lower, time2 = E2y_all_upper, type = "interval2"))
```

**Inflation Prediction - 60 Months**
```{r}
e60_intervals <- with(df.forD.filtered, Surv(time = E5y_all_lower, time2 = E5y_all_upper, type = "interval2"))
```

**Perception Error**
```{r}
perror_intervals <- with(df.forA.filtered, Surv(time = CPIH_perception_error_scale_2009_lower, time2 = CPIH_perception_error_scale_2009_upper, type = "interval2"))
```

**Prediction Error - 12 Months**
```{r}
eerror12_intervals <- with(df.forB.filtered, Surv(time = CPIH_prediction_error_scale_2009_12_lower, time2 = CPIH_prediction_error_scale_2009_12_upper, type = "interval2"))
```

**Prediction Error - 24 Months**
```{r}
eerror24_intervals <- with(df.forC.filtered, Surv(time = CPIH_prediction_error_scale_2009_24_lower, time2 = CPIH_prediction_error_scale_2009_24_upper, type = "interval2"))
```

**Prediction Error - 60 Months**
```{r}
eerror60_intervals <- with(df.forD.filtered, Surv(time = CPIH_prediction_error_scale_2009_60_lower, time2 = CPIH_prediction_error_scale_2009_60_upper, type = "interval2"))
```

###### Fit survival models with surv object

**Inflation Perceptions**
```{r}
m.survreg.p.q14 <- survreg(p_intervals ~  q14 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forA.filtered, dist = "gaussian")
```

**Inflation Prediction - 12 Months**
```{r}
m.survreg.e12.q14 <- survreg(e12_intervals ~  q14 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forB.filtered, dist = "gaussian")
```

**Inflation Prediction - 24 Months**
```{r}
m.survreg.e24.q14 <- survreg(e24_intervals ~  q14 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forC.filtered, dist = "gaussian")
```

**Inflation Prediction - 60 Months**
```{r}
m.survreg.e60.q14 <- survreg(e60_intervals ~  q14 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forD.filtered, dist = "gaussian")
```

**Perception Error**
```{r}
m.survreg.perror.q14 <- survreg(perror_intervals ~  q14 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forA.filtered, dist = "gaussian")
```
**Prediction Error - 12 Months**
```{r}
m.survreg.eerror12.q14 <- survreg(eerror12_intervals ~  q14 + CPIH_prediction_error_scale_2009_12 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forB.filtered, dist = "gaussian")
```

**Prediction Error - 24 Months**
```{r}
m.survreg.eerror24.q14 <- survreg(eerror24_intervals ~  q14 + CPIH_prediction_error_scale_2009_24 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forC.filtered, dist = "gaussian")
```

**Prediction Error - 60 Months**
```{r}
m.survreg.eerror60.q14 <- survreg(eerror60_intervals ~  q14 + CPIH_prediction_error_scale_2009_60 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forD.filtered, dist = "gaussian")
```
**Inflation Perceptions (Q14_hmm2021)**
```{r}
m.survreg.p.q14hmm2021 <- survreg(p_intervals ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forA.filtered, dist = "gaussian")
```

**Inflation Prediction - 12 Months (Q14_hmm2021)**
```{r}
m.survreg.e12.q14hmm2021 <- survreg(e12_intervals ~  q14_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forB.filtered, dist = "gaussian")
```

**Inflation Prediction - 24 Months (Q14_hmm2021)**
```{r}
m.survreg.e24.q14hmm2021 <- survreg(e24_intervals ~  q14_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forC.filtered, dist = "gaussian")
```

**Inflation Prediction - 60 Months (Q14_hmm2021)**
```{r}
m.survreg.e60.q14hmm2021 <- survreg(e60_intervals ~  q14_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forD.filtered, dist = "gaussian")
```

**Perception Error (Q14_hmm2021)**
```{r}
m.survreg.perror.q14hmm2021 <- survreg(perror_intervals ~  q14_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forA.filtered, dist = "gaussian")
```

**Prediction Error - 12 Months (Q14_hmm2021)**
```{r}
m.survreg.eerror12.q14hmm2021 <- survreg(eerror12_intervals ~  q14_hmm2021 + CPIH_prediction_error_scale_2009_12 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forB.filtered, dist = "gaussian")
```

**Prediction Error - 24 Months (Q14_hmm2021)**
```{r}
m.survreg.eerror24.q14hmm2021 <- survreg(eerror24_intervals ~  q14_hmm2021 + CPIH_prediction_error_scale_2009_24 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forC.filtered, dist = "gaussian")
```

**Prediction Error - 60 Months (Q14_hmm2021)**
```{r}
m.survreg.eerror60.q14hmm2021 <- survreg(eerror60_intervals ~  q14_hmm2021 + CPIH_prediction_error_scale_2009_60 + age + sex + tenure + class + income_fix + educ + sreg + work + CPIH + agg_trust, data = df.forD.filtered, dist = "gaussian")
```

##### Generate Tables for Pooled Linear Models

###### Baseline Models

**Inflation Perception and Perception Error**
```{r}
stargazer(
    m.lm.p.q14.for2to7, m.lm.p.q14hmm2021.for2to7, m.lm.perror.q14.for2to7, m.lm.perror.q14hmm2021.for2to7, m.lm.perrorabs.q14.for2to7, m.lm.perrorabs.q142021.for2to7,
    keep = c("q14","q14_hmm2021","Constant"),
    type = "text",
    title = "Linear Panel Models - Inflation Perception and Perception Error",
    column.labels = c("Inflation Perception","Perception Error", "Absolute Perception Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif."),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024')),
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.p.q14.for2to7$robustse, m.lm.p.q14hmm2021.for2to7$robustse, m.lm.perror.q14.for2to7$robustse, m.lm.perror.q14hmm2021.for2to7$robustse, m.lm.perrorabs.q14.for2to7$robustse, m.lm.perrorabs.q142021.for2to7$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (12 Months)**
```{r}
stargazer(
    m.lm.e12.q14.for2to7, m.lm.e12.q14hmm2021.for2to7, m.lm.eerror12.q14.for2to7, m.lm.eerror12.q14hmm2021.for2to7, m.lm.eerror12abs.q14.for2to7, m.lm.eerror12abs.q142021.for2to7,
    keep = c("q14","q14_hmm2021","P_all","CPIH_perception_error_scale_2009", "Constant"),
    type = "text",
    title = "Linear Panel Models - Inflation Prediction and Prediction Error (12 Months)",
    column.labels = c("Inflation Prediction","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.", "Inflation Perception", "Perception Error"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2024','2001-2024','2001-2023','2001-2023','2001-2023','2001-2023')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.e12.q14.for2to7$robustse, m.lm.e12.q14hmm2021.for2to7$robustse, m.lm.eerror12.q14.for2to7$robustse, m.lm.eerror12.q14hmm2021.for2to7$robustse, m.lm.eerror12abs.q14.for2to7$robustse, m.lm.eerror12abs.q142021.for2to7$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (24 Months)**
```{r}
stargazer(
    m.lm.e24.q14.for2to7, m.lm.e24.q14hmm2021.for2to7, m.lm.eerror24.q14.for2to7, m.lm.eerror24.q14hmm2021.for2to7, m.lm.eerror24abs.q14.for2to7, m.lm.eerror24abs.q142021.for2to7,
    keep = c("q14","q14_hmm2021","P_all","CPIH_perception_error_scale_2009", "Constant"),
    type = "text",
    title = "Linear Panel Models - Inflation Prediction and Prediction Error (24 Months)",
    column.labels = c("Inflation Prediction","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.", "Inflation Perception", "Perception Error"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2009-2024','2009-2024','2009-2022','2009-2022','2009-2022','2009-2022')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.e24.q14.for2to7$robustse, m.lm.e24.q14hmm2021.for2to7$robustse, m.lm.eerror24.q14.for2to7$robustse, m.lm.eerror24.q14hmm2021.for2to7$robustse, m.lm.eerror24abs.q14.for2to7$robustse, m.lm.eerror24abs.q142021.for2to7$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (60 Months)**
```{r}
stargazer(
    m.lm.e60.q14.for2to7, m.lm.e60.q14hmm2021.for2to7, m.lm.eerror60.q14.for2to7, m.lm.eerror60.q14hmm2021.for2to7, m.lm.eerror60abs.q14.for2to7, m.lm.eerror60abs.q142021.for2to7,
    keep = c("q14","q14_hmm2021","P_all","CPIH_perception_error_scale_2009", "Constant"),
    type = "text",
    title = "Linear Panel Models - Inflation Prediction and Prediction Error (60 Months)",
    column.labels = c("Inflation Prediction","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.", "Inflation Perception", "Perception Error"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2009-2019','2009-2019','2009-2019','2009-2019','2009-2019','2009-2019')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.e60.q14.for2to7$robustse, m.lm.e60.q14hmm2021.for2to7$robustse, m.lm.eerror60.q14.for2to7$robustse, m.lm.eerror60.q14hmm2021.for2to7$robustse, m.lm.eerror60abs.q14.for2to7$robustse, m.lm.eerror60abs.q142021.for2to7$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

###### Interacted Individual and Aggregate Trust

**Inflation Perception and Perception Error**
```{r}
stargazer(
    m.lm.p.q14.for11, m.lm.p.q14hmm2021.for11, m.lm.perror.q14.for11, m.lm.perror.q14hmm2021.for11, m.lm.perrorabs.q14.for11, m.lm.perrorabs.q142021.for11,
    omit = c("age","sex","class","sreg","income", "tenure", "educ", "work", "CPIH"),
    type = "text",
    title = "Linear Panel Model - Aggregate and Individual Trust Interacted - Inflation Perceptions and Perception Error",
    column.labels = c("Inflation Perception","Perception Error", "Absolute Perception Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.","Public Trust", "Trust Proxy:Public Trust", "TP w/o Indif.:Public Trust"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.p.q14.for11$robustse, m.lm.p.q14hmm2021.for11$robustse, m.lm.perror.q14.for11$robustse, m.lm.perror.q14hmm2021.for11$robustse, m.lm.perrorabs.q14.for11$robustse, m.lm.perrorabs.q142021.for11$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (12 Months)**
```{r}
stargazer(
    m.lm.e12.q14.for11, m.lm.e12.q14hmm2021.for11, m.lm.eerror12.q14.for11, m.lm.eerror12.q14hmm2021.for11, m.lm.eerror12abs.q14.for11, m.lm.eerror12abs.q142021.for11,
    keep = c("q14","q14_hmm2021","CPIH_perception_error_scale_2009","P_all","Constant", "agg_trust"),
    type = "text",
    title = "Linear Panel Model - Inflation Predictions and Prediction Error - Aggregate and Individual Trust Interacted (12 Months)",
    column.labels = c("Inflation Prediction","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.","Inflation Perceptions", "Perception Error", "Public Trust", "Trust Proxy:Public Trust", "TP w/o Indif.:Public Trust"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2024','2001-2024','2001-2023','2001-2023','2001-2023','2001-2023')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.e12.q14.for11$robustse, m.lm.e12.q14hmm2021.for11$robustse, m.lm.eerror12.q14.for11$robustse, m.lm.eerror12.q14hmm2021.for11$robustse, m.lm.eerror12abs.q14.for11$robustse, m.lm.eerror12abs.q142021.for11$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (24 Months)**
```{r}
stargazer(
    m.lm.e24.q14.for11, m.lm.e24.q14hmm2021.for11, m.lm.eerror24.q14.for11, m.lm.eerror24.q14hmm2021.for11, m.lm.eerror24abs.q14.for11, m.lm.eerror24abs.q142021.for11,
    keep = c("q14","q14_hmm2021","CPIH_perception_error_scale_2009","P_all","Constant", "agg_trust"),
    type = "text",
    title = "Linear Panel Model - Inflation Predictions and Prediction Error - Aggregate and Individual Trust Interacted (24 Months)",
    column.labels = c("Inflation Prediction","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.","Inflation Perceptions", "Perception Error", "Public Trust", "Trust Proxy:Public Trust", "TP w/o Indif.:Public Trust"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2009-2024','2009-2024','2009-2022','2009-2022','2009-2022','2009-2022')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.e24.q14.for11$robustse, m.lm.e24.q14hmm2021.for11$robustse, m.lm.eerror24.q14.for11$robustse, m.lm.eerror24.q14hmm2021.for11$robustse, m.lm.eerror24abs.q14.for11$robustse, m.lm.eerror24abs.q142021.for11$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (60 Months)**
```{r}
stargazer(
    m.lm.e60.q14.for11, m.lm.e60.q14hmm2021.for11, m.lm.eerror60.q14.for11, m.lm.eerror60.q14hmm2021.for11, m.lm.eerror60abs.q14.for11, m.lm.eerror60abs.q142021.for11,
    keep = c("q14","q14_hmm2021","CPIH_perception_error_scale_2009","P_all","Constant", "agg_trust"),
    type = "text",
    title = "Linear Panel Model - Inflation Predictions and Prediction Error - Aggregate and Individual Trust Interacted (60 Months)",
    column.labels = c("Inflation Prediction","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.","Inflation Perceptions", "Perception Error", "Public Trust", "Trust Proxy:Public Trust", "TP w/o Indif.:Public Trust"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2009-2019','2009-2019','2009-2019','2009-2019','2009-2019','2009-2019')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.e60.q14.for11$robustse, m.lm.e60.q14hmm2021.for11$robustse, m.lm.eerror60.q14.for11$robustse, m.lm.eerror60.q14hmm2021.for11$robustse, m.lm.eerror60abs.q14.for11$robustse, m.lm.eerror60abs.q142021.for11$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```


###### Knowledge Variable Models

**Inflation Perception and Perception Error**
```{r}
stargazer(
    m.lm.p.q14.know, m.lm.p.q14hmm2021.know, m.lm.perror.q14.know, m.lm.perror.q14hmm2021.know, m.lm.perrorabs.q14.know, m.lm.perrorabs.q142021.know,
    keep = c("q14","q14_hmm2021", "knowledge_hmm2021", "eknowledge_hmm2021", "Constant"),
    type = "text",
    title = "Linear Panel Models - Knowledge Indices Included - Inflation Perception and Perception Error",
    column.labels = c("Inflation Perception","Perception Error", "Absolute Perception Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.", "Inst. Knowledge","Econ. Knowledge"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.p.q14.know$robustse, m.lm.p.q14hmm2021.know$robustse, m.lm.perror.q14.know$robustse, m.lm.perror.q14hmm2021.know$robustse, m.lm.perrorabs.q14.know$robustse, m.lm.perrorabs.q142021.know$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (12 Months)**
```{r}
stargazer(
    m.lm.e12.q14.know, m.lm.e12.q14hmm2021.know, m.lm.eerror12.q14.know, m.lm.eerror12.q14hmm2021.know, m.lm.eerror12abs.q14.know, m.lm.eerror12abs.q142021.know,
    keep = c("q14","q14_hmm2021", "knowledge_hmm2021", "eknowledge_hmm2021", "P_all", "CPIH_perception_error_scale_2009", "Constant"),
    type = "text",
    title = "Linear Panel Models - Knowledge Indices Included - Inflation Prediction and Prediction Error (12 Months)",
    column.labels = c("Inflation Prediction","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.", "Inflation Perception", "Perception Error", "Inst. Knowledge","Econ. Knowledge"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2024','2001-2024','2001-2023','2001-2023','2001-2023','2001-2023')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.e12.q14.know$robustse, m.lm.e12.q14hmm2021.know$robustse, m.lm.eerror12.q14.know$robustse, m.lm.eerror12.q14hmm2021.know$robustse, m.lm.eerror12abs.q14.know$robustse, m.lm.eerror12abs.q142021.know$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (24 Months)**
```{r}
stargazer(
    m.lm.e24.q14.know, m.lm.e24.q14hmm2021.know, m.lm.eerror24.q14.know, m.lm.eerror24.q14hmm2021.know, m.lm.eerror24abs.q14.know, m.lm.eerror24abs.q142021.know,
    keep = c("q14","q14_hmm2021", "knowledge_hmm2021", "eknowledge_hmm2021", "P_all", "CPIH_perception_error_scale_2009", "Constant"),
    type = "text",
    title = "Linear Panel Models - Knowledge Indices Included - Inflation Prediction and Prediction Error (24 Months)",
    column.labels = c("Inflation Prediction","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.", "Inflation Perception", "Perception Error", "Inst. Knowledge","Econ. Knowledge"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2009-2024','2009-2024','2009-2022','2009-2022','2009-2022','2009-2022')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.e24.q14.know$robustse, m.lm.e24.q14hmm2021.know$robustse, m.lm.eerror24.q14.know$robustse, m.lm.eerror24.q14hmm2021.know$robustse, m.lm.eerror24abs.q14.know$robustse, m.lm.eerror24abs.q142021.know$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (60 Months)**
```{r}
stargazer(
    m.lm.e60.q14.know, m.lm.e60.q14hmm2021.know, m.lm.eerror60.q14.know, m.lm.eerror60.q14hmm2021.know, m.lm.eerror60abs.q14.know, m.lm.eerror60abs.q142021.know,
    keep = c("q14","q14_hmm2021", "knowledge_hmm2021", "eknowledge_hmm2021", "P_all", "CPIH_perception_error_scale_2009", "Constant"),
    type = "text",
    title = "Linear Panel Models - Knowledge Indices Included - Inflation Prediction and Prediction Error (60 Months)",
    column.labels = c("Inflation Prediction","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy", "Trust Proxy w/o Indif.", "Inflation Perception", "Perception Error", "Inst. Knowledge","Econ. Knowledge"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2009-2024','2009-2024','2009-2019','2009-2019','2009-2019','2009-2019')),
    ci.level = 0.95,
    model.names = TRUE,
    report = ('vc*t'),
    se = list(m.lm.e60.q14.know$robustse, m.lm.e60.q14hmm2021.know$robustse, m.lm.eerror60.q14.know$robustse, m.lm.eerror60.q14hmm2021.know$robustse, m.lm.eerror60abs.q14.know$robustse, m.lm.eerror60abs.q142021.know$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```


###### CPI Comparison

**Perception Error**
```{r}
stargazer(
    m.lm.perror.q14.CPI, m.lm.perror.q14hmm2021.CPI, m.lm.perrorabs.q14.CPI, m.lm.perrorabs.q142021.CPI,
    omit = c("age","sex","class","sreg","income", "tenure", "educ", "work", "CPI"),
    type = "text",
    title = "Linear Panel Models - CPI-Based Models - Inflation Perception and Perception Error",
    column.labels = c("Perception Error", "Absolute Perception Error"),
    column.separate = c(2,2),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No','No','No'),
        c('Timeframe','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust')),
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE,
    se = list(m.lm.perror.q14.CPI$robustse, m.lm.perror.q14hmm2021.CPI$robustse, m.lm.perrorabs.q14.CPI$robustse, m.lm.perrorabs.q142021.CPI$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = FALSE
)
```

**Inflation Prediction and Prediction Error (12 Months)**
```{r}
stargazer(
    m.lm.eerror12.q14.CPI, m.lm.eerror12.q14hmm2021.CPI, m.lm.eerror12abs.q14.CPI, m.lm.eerror12abs.q142021.CPI,
    keep = c("q14","q14_hmm2021","CPI_perception_error_scale_2009","P_all","Constant", "agg_trust", "CPI"),
    type = "text",
    title = "Linear Panel Models - CPI-Based Models - Inflation Predictions and Prediction Error (12 Months)",
    column.labels = c("Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No','No','No'),
        c('Timeframe','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust')),
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE,
    se = list(m.lm.eerror12.q14.CPI$robustse, m.lm.eerror12.q14hmm2021.CPI$robustse, m.lm.eerror12abs.q14.CPI$robustse, m.lm.eerror12abs.q142021.CPI$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = FALSE
)
```

**Inflation Prediction and Prediction Error (24 Months)**
```{r}
stargazer(
    m.lm.eerror24.q14.CPI, m.lm.eerror24.q14hmm2021.CPI, m.lm.eerror24abs.q14.CPI, m.lm.eerror24abs.q142021.CPI,
    keep = c("q14","q14_hmm2021","CPI_perception_error_scale_2009","P_all","Constant", "agg_trust"),
    type = "text",
    title = "Linear Panel Models - CPI-Based Models - Inflation Predictions and Prediction Error (24 Months)",
    column.labels = c("Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2),    
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Timeframe','2009-2024','2009-2024','2009-2024','2009-2024','2009-2024','2009-2024'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust')),
    style = "qje",
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE,
    se = list(m.lm.e24.q14.CPI$robustse, m.lm.e24.q14hmm2021.CPI$robustse, m.lm.eerror24.q14.CPI$robustse, m.lm.eerror24.q14hmm2021.CPI$robustse, m.lm.eerror24abs.q14.CPI$robustse, m.lm.eerror24abs.q142021.CPI$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = FALSE
)
```

**Inflation Prediction and Prediction Error (60 Months)**
```{r}
stargazer(
    m.lm.eerror60.q14.CPI, m.lm.eerror60.q14hmm2021.CPI, m.lm.eerror60abs.q14.CPI, m.lm.eerror60abs.q142021.CPI,
    keep = c("q14","q14_hmm2021","CPI_perception_error_scale_2009","P_all","Constant", "agg_trust"),
    type = "text",
    title = "Linear Panel Models - CPI-Based Models - Inflation Predictions and Prediction Error (60 Months)",
    column.labels = c("Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2),    
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No','No','No'),
        c('Timeframe','2009-2024','2009-2024','2009-2024','2009-2024','2009-2024','2009-2024'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust')),
    style = "qje",
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE,
    se = list(m.lm.eerror60.q14.CPI$robustse, m.lm.eerror60.q14hmm2021.CPI$robustse, m.lm.eerror60abs.q14.CPI$robustse, m.lm.eerror60abs.q142021.CPI$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = FALSE
)
```

###### Quadratic Terms

**Inflation Perception and Perception Error**
```{r}
stargazer(
    m.lm.p.q14.quad, m.lm.p.q14hmm2021.quad, m.lm.perror.q14.quad, m.lm.perror.q14hmm2021.quad, m.lm.perrorabs.q14.quad, m.lm.perrorabs.q142021.quad,
    omit = c("age","sex","class","sreg","income", "tenure", "educ", "work"),
    type = "text",
    title = "Linear Panel Models - Quadratic Trust Proxy - Inflation Perception and Perception Error",
    column.labels = c("Inflation Perceptions","Perception Error", "Absolute Perception Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy","Trust ProxyExp2","Trust Proxy w/o Indif.","Trust Proxy w/o Indif.Exp2", "TP:TPExp2","TP w/o Indif:TP w/o IndifExp2"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024','2001-2024')),
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE,
    se = list(m.lm.p.q14.quad$robustse, m.lm.p.q14hmm2021.quad$robustse, m.lm.perror.q14.quad$robustse, m.lm.perror.q14hmm2021.quad$robustse, m.lm.perrorabs.q14.quad$robustse, m.lm.perrorabs.q142021.quad$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (12 Months)**
```{r}
stargazer(
    m.lm.e12.q14.quad, m.lm.e12.q14hmm2021.quad, m.lm.eerror12.q14.quad, m.lm.eerror12.q14hmm2021.quad, m.lm.eerror12abs.q14.quad, m.lm.eerror12abs.q142021.quad,
    omit = c("age","sex","class","sreg","income_fix", "tenure", "educ", "work"),
    type = "text",
    title = "Linear Panel Models - Quadratic Trust Proxy - Inflation Prediction and Prediction Error (12 Months)",
    column.labels = c("Inflation Predictions","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy","Trust ProxyExp2","Trust Proxy w/o Indif.","Trust Proxy w/o Indif.Exp2", "Inflation Perception", "Perception Error", "TP:TPExp2","TP w/o Indif:TP w/o IndifExp2"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2001-2024','2001-2024','2001-2023','2001-2023','2001-2023','2001-2023')),
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE,
    se = list(m.lm.e12.q14.quad$robustse, m.lm.e12.q14hmm2021.quad$robustse, m.lm.eerror12.q14.quad$robustse, m.lm.eerror12.q14hmm2021.quad$robustse, m.lm.eerror12abs.q14.quad$robustse, m.lm.eerror12abs.q142021.quad$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (24 Months)**
```{r}
stargazer(
    m.lm.e24.q14.quad, m.lm.e24.q14hmm2021.quad, m.lm.eerror24.q14.quad, m.lm.eerror24.q14hmm2021.quad, m.lm.eerror24abs.q14.quad, m.lm.eerror24abs.q142021.quad,
    keep = c("q14","q14_hmm2021","CPIH_perception_error_scale_2009","P_all","Constant", "agg_trust"),
    type = "text",
    title = "Linear Panel Models - Quadratic Trust Proxy - Inflation Prediction and Prediction Error (24 Months)",
    column.labels = c("Inflation Predictions","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy","Trust ProxyExp2","Trust Proxy w/o Indif.","Trust Proxy w/o Indif.Exp2", "Inflation Perception", "Perception Error", "TP:TPExp2","TP w/o Indif:TP w/o IndifExp2"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2009-2024','2009-2024','2009-2022','2009-2022','2009-2022','2009-2022')),
    style = "qje",
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE,
    se = list(m.lm.e24.q14.quad$robustse, m.lm.e24.q14hmm2021.quad$robustse, m.lm.eerror24.q14.quad$robustse, m.lm.eerror24.q14hmm2021.quad$robustse, m.lm.eerror24abs.q14.quad$robustse, m.lm.eerror24abs.q142021.quad$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

**Inflation Prediction and Prediction Error (60 Months)**
```{r}
stargazer(
    m.lm.e60.q14.quad, m.lm.e60.q14hmm2021.quad, m.lm.eerror60.q14.quad, m.lm.eerror60.q14hmm2021.quad, m.lm.eerror60abs.q14.quad, m.lm.eerror60abs.q142021.quad,
    keep = c("q14","q14_hmm2021","CPIH_perception_error_scale_2009","P_all","Constant", "agg_trust"),
    type = "text",
    title = "Linear Panel Models - Quadratic Trust Proxy - Inflation Prediction and Prediction Error (60 Months)",
    column.labels = c("Inflation Predictions","Prediction Error", "Absolute Prediction Error"),
    column.separate = c(2,2,2),
    covariate.labels = c("Trust Proxy","Trust ProxyExp2","Trust Proxy w/o Indif.","Trust Proxy w/o Indif.Exp2","Inflation Perception", "Perception Error", "TP:TPExp2","TP w/o Indif:TP w/o IndifExp2"),
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Year Fixed-Effects','Yes','Yes','Yes','Yes','Yes','Yes'),
        c('Std. Errors','Robust','Robust','Robust','Robust','Robust','Robust'),
        c('Timeframe','2009-2024','2009-2024','2009-2019','2009-2019','2009-2019','2009-2019')),
    style = "qje",
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE,
    se = list(m.lm.e60.q14.quad$robustse, m.lm.e60.q14hmm2021.quad$robustse, m.lm.eerror60.q14.quad$robustse, m.lm.eerror60.q14hmm2021.quad$robustse, m.lm.eerror60abs.q14.quad$robustse, m.lm.eerror60abs.q142021.quad$robustse),
    omit.stat = ("f"),
    dep.var.labels.include = FALSE,
    omit.table.layout = "l",
    header = TRUE
)
```

##### Interval Regression

**Inflation Perceptions and Predictions**

```{r}
stargazer(
    m.survreg.p.q14, m.survreg.e12.q14, m.survreg.e24.q14, m.survreg.e60.q14,
    keep = c("q14","q14_hmm2021","P_all","Constant", "agg_trust"),
    type = "text",
    title = "Models 2 and 5 - Interval Regression: Inflation Perceptions and Predictions",
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No'),
        c('Timeframe','2001-2024','2001-2024','2001-2024','2001-2024'),
        c('Std. Errors','Standard','Standard','Standard','Standard')),
    style = "qje",
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE
        )
```

**Inflation Perceptions and Predictions - Without Trust Limen**

```{r}
stargazer(
    m.survreg.p.q14hmm2021, m.survreg.e12.q14hmm2021, m.survreg.e24.q14hmm2021, m.survreg.e60.q14hmm2021,
    keep = c("q14","q14_hmm2021","P_all","Constant", "agg_trust"),
    type = "text",
    title = "Models 2, 5 & 8 - Interval Regression: Inflation Perceptions and Predictions Without Indifference Limen",
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No'),
        c('Timeframe','2001-2024','2001-2024','2001-2024','2001-2024'),
        c('Std. Errors','Standard','Standard','Standard','Standard')),
    style = "qje",
    ci.level = 0.95,
    report = ('vc*t'),
    model.names = TRUE
        )
```
### Assess Model Fit

**Model Fit**

```{r}
BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    lm(CPIH_perception_error_scale_2009 ~  q14_hmm2021 + knowledge_hmm2021 + age + sex + class + income + educ + tenure,.) %>%
    plot(.)
```

```{r}
qqPlot(m.survreg.test$linear.predictors)
```

### Time Series LM - Quarterly

**Formula A (Q14 - Unweighted)**
```{r}
BOE_IAS %>%
    filter(income != 12) %>%
    filter(P_all != 99) %>%
    filter(sex <= 5)%>%
    lm(CPIH_perception_error_scale_2009 ~  CPIH_BOEscale2009 + q14 + knowledge_hmm2021 + age + sex + class + income + educ + tenure + sreg,., conf.int = TRUE)
```

#### Perception Error

**Perception Error \~ Satisfaction (Ordinal) + Knowledge (HMM 2021) + Demographics (Weighted)\
**(2001-2024)

```{r}
BOE_IAS %>%
    filter(income != 12) %>%
    filter(sex <= 5) %>%
    filter(P_all != 99) %>%
    nest_by(yyyyqq, timetrend) %>%
    mutate(ModelModel = list(lm(CPIH_perception_error_scale_2009 ~ CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + class + income + educ + tenure + sreg, weights = weight, data = data))) %>%
    reframe(tidy(ModelModel, conf.int = TRUE, conf.level = 0.95)) %>%
    {
        ggplot(., aes(x = timetrend, y = estimate)) +
            geom_line(data = subset(., term == "q14_hmm2021"), aes(colour = "Satisfaction (Ordinal Scale)")) +
            geom_text(data = subset(.,term == "q14_hmm2021"), aes(colour = "Satisfaction (Ordinal Scale)",
                                                            label =
                                                                  ifelse(p.value < 0.001, "***",
                                                                           ifelse(p.value < 0.01, "**",
                                                                                  ifelse(p.value < 0.05, "*", "")))), 
                                                            angle = 90,
                                                            hjust = 2,
                                                            show.legend = FALSE
                                                            )+
            geom_line(data = subset(., term == "CPIH_BOEscale_2009"), aes(colour = "CPIH")) +
            geom_text(data = subset(., term == "CPIH_BOEscale_2009"), aes(colour = "CPIH",
                                                              label = 
                                                                  ifelse(p.value < 0.001, "***",
                                                                         ifelse(p.value < 0.01, "**",
                                                                                ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = -2,
                      show.legend = FALSE
            )+
            geom_ribbon(data = subset(., term == "q14_hmm2021"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1, fill = "Satisfaction (Ordinal Scale)")) +
            geom_ribbon(data = subset(., term == "CPIH_BOEscale_2009"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1,  fill = "CPIH")) +
            scale_x_continuous(breaks = .$timetrend, labels = .$yyyyqq) +
            theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
            labs(colour = "Coefficient", fill = "95% CI", title = "Linear Model: Perception Error ~ Satisfaction (Ordinal Scale) - BoE 2009 Scaling", x = "Year - Quarter", y = "Estimate") +
            scale_fill_manual(values = c("Satisfaction (Ordinal Scale)" = "pink", "CPIH" = "grey")) +
            scale_colour_manual(values = c("Satisfaction (Ordinal Scale)" = "red", "CPIH" = "black"))+
            guides(alpha = "none")
    }
```

#### Prediction Error (12 Months)

**Prediction Error ~ Satisfaction (Ordinal) + Perception Error (12 Months) + Knowledge (HMM 2021) + Demographics (Weighted)**

**(2001-2022)**

```{r}
BOE_IAS %>%
    filter(income != 12) %>%
    filter(sex <= 5) %>%
    filter(E1y_all != 99) %>%
    filter(P_all != 99) %>%
    filter(yyyyqq <= 202204) %>%
    nest_by(yyyyqq, timetrend) %>%
    mutate(ModelModel = list(lm(CPIH_prediction_error_scale_2009_12 ~ CPIH_BOEscale_2009 +q14_hmm2021 + CPIH_perception_error_scale_2009 + knowledge_hmm2021 + age + class + income + educ + tenure, weights = weight, data = data))) %>%
    reframe(tidy(ModelModel, conf.int = TRUE, conf.level = 0.95)) %>%
    {
        ggplot(., aes(x = timetrend, y = estimate)) +
            geom_line(data = subset(., term == "q14_hmm2021"), aes(colour = "Satisfaction (Ordinal Scale)")) +
            geom_text(data = subset(.,term == "q14_hmm2021"), aes(colour = "Satisfaction (Ordinal Scale)",
                                                                  label =
                                                                      ifelse(p.value < 0.001, "***",
                                                                             ifelse(p.value < 0.01, "**",
                                                                                    ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = 2,
                      show.legend = FALSE
            )+
            geom_line(data = subset(., term == "CPIH_perception_error_scale_2009"), aes(colour = "Perception Error (12 Months)")) +
            geom_text(data = subset(.,term == "CPIH_perception_error_scale_2009"), aes(colour = "Perception Error (12 Months)",
                                                                  label = 
                                                                      ifelse(p.value < 0.001, "***",
                                                                             ifelse(p.value < 0.01, "**",
                                                                                    ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = -2,
                      show.legend = FALSE
            )+
            geom_ribbon(data = subset(., term == "q14_hmm2021"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1, fill = "Satisfaction (Ordinal Scale)")) +
            geom_ribbon(data = subset(., term == "CPIH_perception_error_scale_2009"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1,  fill = "Perception Error (12 Months)")) +
            scale_x_continuous(breaks = .$timetrend, labels = .$yyyyqq) +
            theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
            labs(colour = "Coefficient", fill = "95% CI", title = "Linear Model: Prediction Error (12 Months) ~ Satisfaction (Ordinal Scale) + Perception Error + Demographics (Weighted) - BoE 2009 Scaling", x = "Year - Quarter", y = "Estimate") +
            scale_fill_manual(values = c("Satisfaction (Ordinal Scale)" = "pink", "Perception Error (12 Months)" = "grey")) +
            scale_colour_manual(values = c("Satisfaction (Ordinal Scale)" = "red", "Perception Error (12 Months)" = "black"))+
            guides(alpha = "none")
    }
```

**Prediction Error ~ Satisfaction (Ordinal) + Perception Error (12 Months) + Knowledge (HMM 2021) + Demographics (Weighted)**

**(2009-2022)**

```{r}
BOE_IAS %>%
    filter(income != 12) %>%
    filter(E1y_all != 99) %>%
    filter(P_all != 99) %>%
    filter(yyyyqq >= 200901) %>%
    filter(yyyyqq <= 202204) %>%
    nest_by(yyyyqq, timetrend) %>%
    mutate(ModelModel = list(lm(CPIH_prediction_error_scale_2009_12 ~ q14_hmm2021 + CPIH_perception_error_scale_2009 + knowledge_hmm2021 + age + class + income + educ + tenure, weights = weight, data = data))) %>%
    reframe(tidy(ModelModel, conf.int = TRUE, conf.level = 0.95)) %>%
    {
        ggplot(., aes(x = timetrend, y = estimate)) +
            geom_line(data = subset(., term == "q14_hmm2021"), aes(colour = "Satisfaction (Ordinal Scale)")) +
            geom_text(data = subset(.,term == "q14_hmm2021"), aes(colour = "Satisfaction (Ordinal Scale)",
                                                                  label =
                                                                      ifelse(p.value < 0.001, "***",
                                                                             ifelse(p.value < 0.01, "**",
                                                                                    ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = 2,
                      show.legend = FALSE
            )+
            geom_line(data = subset(., term == "(Intercept)"), aes(colour = "(Intercept)")) +
            geom_text(data = subset(.,term == "(Intercept)"), aes(colour = "(Intercept)",
                                                                  label =
                                                                      ifelse(p.value < 0.001, "***",
                                                                             ifelse(p.value < 0.01, "**",
                                                                                    ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = 2,
                      show.legend = FALSE
            )+
            geom_ribbon(data = subset(., term == "(Intercept)"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1, fill = "(Intercept)")) +
            geom_line(data = subset(., term == "CPIH_perception_error_scale_2009"), aes(colour = "Perception Error (12 Months)")) +
            geom_text(data = subset(.,term == "CPIH_perception_error_scale_2009"), aes(colour = "Perception Error (12 Months)",
                                                                                       label = 
                                                                                           ifelse(p.value < 0.001, "***",
                                                                                                  ifelse(p.value < 0.01, "**",
                                                                                                         ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = -2,
                      show.legend = FALSE
            )+
            geom_ribbon(data = subset(., term == "q14_hmm2021"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1, fill = "Satisfaction (Ordinal Scale)")) +
            geom_ribbon(data = subset(., term == "CPIH_perception_error_scale_2009"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1,  fill = "Perception Error (12 Months)")) +
            scale_x_continuous(breaks = .$timetrend, labels = .$yyyyqq) +
            theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
            labs(colour = "Coefficient", fill = "95% CI", title = "Linear Model: Prediction Error (12 Months) ~ Satisfaction (Ordinal Scale) + Perception Error + Demographics (Weighted) - BoE 2009 Scaling", x = "Year - Quarter", y = "Estimate") +
            scale_fill_manual(values = c("Satisfaction (Ordinal Scale)" = "pink", "Perception Error (12 Months)" = "grey", "(Intercept)" = "lightgreen")) +
            scale_colour_manual(values = c("Satisfaction (Ordinal Scale)" = "red", "Perception Error (12 Months)" = "black", "(Intercept)" = "green"))+
            guides(alpha = "none")
    }
```

\*\*Perception Error \~ Satisfaction (Binary) + Prediction Error (12 Months) + Knowledge (HMM 2021) + Demographics (Weighted)\*\* **(2001-2022)**

```{r}
BOE_IAS %>%
    filter(income != 12) %>%
    filter(E1y_all != 99) %>%
    filter(yyyyqq <= 202204) %>%
    nest_by(yyyyqq, timetrend) %>%
    mutate(ModelModel = list(lm(CPIH_prediction_error_scale_2009_12 ~ q14_binary + CPIH_perception_error_scale_2009 + knowledge_hmm2021 + age + class + income + educ + tenure, weights = weight, data = data))) %>%
    reframe(tidy(ModelModel, conf.int = TRUE, conf.level = 0.95)) %>%
    {
        ggplot(., aes(x = timetrend, y = estimate)) +
            geom_line(data = subset(., term == "q14_binary"), aes(colour = "Satisfaction (Binary Scale)")) +
            geom_text(data = subset(.,term == "q14_binary"), aes(colour = "Satisfaction (Binary Scale)",
                                                                  label =
                                                                      ifelse(p.value < 0.001, "***",
                                                                             ifelse(p.value < 0.01, "**",
                                                                                    ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = 2,
                      show.legend = FALSE
            )+
            geom_line(data = subset(., term == "CPIH_perception_error_scale_2009"), aes(colour = "Perception Error (12 Months)")) +
            geom_text(data = subset(.,term == "CPIH_perception_error_scale_2009"), aes(colour = "Perception Error (12 Months)",
                                                                  label = 
                                                                      ifelse(p.value < 0.001, "***",
                                                                             ifelse(p.value < 0.01, "**",
                                                                                    ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = -2,
                      show.legend = FALSE
            )+
            geom_ribbon(data = subset(., term == "q14_binary"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1, fill = "Satisfaction (Binary Scale)")) +
            geom_ribbon(data = subset(., term == "CPIH_perception_error_scale_2009"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1,  fill = "Perception Error (12 Months)")) +
            scale_x_continuous(breaks = .$timetrend, labels = .$yyyyqq) +
            theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
            labs(colour = "Coefficient", fill = "CI95", title = "Linear Model: Prediction Error (12 Months) ~ Satisfaction (Binary Scale) - BoE 2009 Scaling", x = "Year - Quarter", y = "Estimate") +
            scale_fill_manual(values = c("Satisfaction (Binary Scale)" = "pink", "Perception Error (12 Months)" = "grey")) +
            scale_colour_manual(values = c("Satisfaction (Binary Scale)" = "red", "Perception Error (12 Months)" = "black"))+
            guides(alpha = "none")
    }
```

# Miscellaneous code

### Calculating Aggregate Confidence

**Create Confidence Binary using Q18**
```{r}
BOE_IAS <- BOE_IAS %>% 
    mutate(q18_binary = case_when(
        q18 %in% c(1, 2, 6, 7) ~ 0,
        q18 %in% c(4, 5, 8, 9) ~ 1
    ))
```

**Add confidence binary to the BOE IAS dataset**
```{r}
confaggregate <- BOE_IAS %>%
    group_by(yyyyqq) %>%
    summarise(.,
              agg_notconfident = round((sum(q18_binary, na.rm = TRUE) / sum(!is.na(q18_binary))), 2),
              agg_confident = round((sum(!is.na(q18_binary)) - sum(q18_binary, na.rm = TRUE)) / sum(!is.na(q18_binary)), 2),
              agg_confidence = round((agg_notconfident * -1) + agg_confident,2)
            ) %>%
    filter(!is.na(agg_confidence))
BOE_IAS <-
    left_join(BOE_IAS,confaggregate %>%
                  dplyr::select(any_of(c("yyyyqq","agg_confidence"))),
              by = "yyyyqq")
```

#### Prediction Error (12 Months) - 2001 Scaling

##### Overall

```{r}
BOE_IAS %>%
    filter(E1y != 99) %>%
    filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
    ggplot(aes(x = CPIH_prediction_error_scale_2001_12, fill = as.factor(q14))) +
               geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
               geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12)), colour = "#000000", linewidth = 1.25) +
               geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12) + sd(CPIH_prediction_error_scale_2001_12)), colour = "#000000", linewidth = 1, linetype = "dashed") +
               geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12) - sd(CPIH_prediction_error_scale_2001_12)), colour = "#000000", linewidth = 1, linetype = "dashed") +
               labs(title = "Prediction Error Density - 12 Months (Excludes Q14 Response 'Do Not Know')", x = "Prediction Error - 12 Months (Intervals)", y = "Response Count", fill = "Q14 Response\n(Satisfaction with Bank of England)") +
               scale_fill_manual(
                   values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
                   labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied"

```{r}
BOE_IAS %>%
    filter(E1y != 99) %>%
    filter(q14 == 1) %>%
    ggplot(aes(x = CPIH_prediction_error_scale_2001_12, fill = as.factor(q14))) +
    geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
    stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
    geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1.25) +
    geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
    geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
    labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Very Satisfied')", x = "Prediction Error (Intervals)", y = "Response Count") +
    theme(legend.position = "none")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(E1y != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2001_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Fairly Satisfied')", x = "Prediction Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Neither Satisfied nor Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E1y != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2001_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Neither Satisfied nor Dissatisfied')", x = "Prediction Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Fairly Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E1y != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2001_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Fairly Dissatisfied')", x = "Prediction Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
    scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Very Dissatisfied'

```{r}
BOE_IAS %>%
  filter(E1y != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2001_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Very Dissatisfied')", x = "Prediction Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(E1y != 99) %>%
  filter(q14 == 1 | q14 == 2) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2001_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Very Satisfied' or 'Fairly Satisfied')", x = "Prediction Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
  filter(E1y != 99) %>%
  filter(q14 == 5 | q14 == 4) %>%
  ggplot(aes(x = CPIH_prediction_error_scale_2001_12, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) + sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_prediction_error_scale_2001_12,na.rm = TRUE) - sd(CPIH_prediction_error_scale_2001_12,na.rm = TRUE)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Prediction Error Density - 12 Months (Q14 Response = 'Very Dissatisfied' or 'Fairly Dissatisfied')", x = "Prediction Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

#### Perception Error - 2001 Scaling

##### Overall

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 1 | q14 == 2 | q14 == 3 | q14 == 4 | q14 == 5) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2001, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) + sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
  geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) - sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
  labs(title = "Perception Error Density (Excludes Q14 Response 'Do Not Know')", x = "Perception Error (Intervals)", y = "Response Count", fill = "Q14 Response\n(Satisfaction with Bank of England)") +
  scale_fill_manual(
        values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
        labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = 'Very Satisfied'

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 1) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2001, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) + sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) - sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Very Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = Fairly Satisfied'

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 2) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2001, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) + sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) - sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Neither Satisfied Nor Dissatisfied"

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 3) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2001, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "black", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) + sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) - sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Percpetion Error Density (Q14 Response = 'Neither Satisfied Nor Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Fairly Dissatisfied'

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 4) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2001, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) + sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) - sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied"

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 5) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2001, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "identity") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", linewidth = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) + sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) - sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Very Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Satisfied" or "Fairly Satisfied"

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 1 | q14 == 2) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2001, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", size = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) + sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) - sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Very Satisfied' or 'Fairly Satisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

##### Q14 Response = "Very Dissatisfied" or "Fairly Dissatisfied"

```{r}
BOE_IAS %>%
  filter(P != 99) %>%
  filter(q14 == 5 | q14 == 4) %>%
  ggplot(aes(x = CPIH_perception_error_scale_2001, fill = as.factor(q14))) +
	geom_histogram(binwidth = 0.5, linetype = "dashed", colour = "black", position = "stack") +
	stat_bin(binwidth = 0.5, geom = "text", colour = "white", linewidth = 3.5, aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1.25) +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) + sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	geom_vline(aes(xintercept = mean(CPIH_perception_error_scale_2001) - sd(CPIH_perception_error_scale_2001)), colour = "#000000", linewidth = 1, linetype = "dashed") +
	labs(title = "Perception Error Density (Q14 Response = 'Very Dissatisfied' or 'Fairly Dissatisfied')", x = "Perception Error (Intervals)", y = "Response Count") +
	theme(legend.position = "none")+
  scale_fill_manual(
    values = c("1" = "#2E5A87FF", "2" = "#6998C1FF", "3" = "#D6D0D1", "4" = "#ED6055FF", "5" = "#A90C38FF", "6" = "black"),
    labels = c("1" = "Very Satisfied", "2" = "Fairly Satisfied", "3" = "Neither Satisfied nor Dissatisfied", "4" = "Fairly Dissatisfied", "5" = "Very Dissatisfied", "6" = "Don't Know"))
```

## Generate Tables without Stargazer Fix

### Generate Tables for Haldane et al. (2021) models

**Create model list**
```{r}
target_prediction_deviance_model_list_pre2020 <- list(
    "Absolute Prediction Deviance from Target (12 Months - 2001 to 2019)" = m.lm.e12_hmm2021.q14.0119,
    "Absolute Prediction Deviance from Target (12 Months - Quadratic Terms - 2001 to 2019)" = m.lm.e12_hmm2021.q14.qterms.0119,
    "Absolute Prediction Deviance from Target (24 Months - 2009 to 2019)" = m.lm.e24_hmm2021.q14.0919,
    "Absolute Prediction Deviance from Target (24 Months - Quadratic Terms- 2009 to 2019)" = m.lm.e24_hmm2021.q14.qterms.0919,
    "Absolute Prediction Deviance from Target (60 Months- 2009 to 2019)" = m.lm.e60_hmm2021.q14.0919,
    "Absolute Prediction Deviance from Target (60 Months - Quadratic Terms- 2009 to 2019)" = m.lm.e60_hmm2021.q14.qterms.0919
)
```

**Create Haldane et al. (2021) model table**
```{r}
stargazer(
    target_prediction_deviance_model_list_pre2020,
    keep = c("q14_inverse","knowledge_hmm2021","Constant"),
    type = "latex",
    title = "Linear Model - Absolute Deviation of Inflation Predictions from BOE Target (2001-2019)",
    column.labels = c("12 Months", "24 Months", "60 Months"),
    column.separate = c(2, 2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
                        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
                        c('Survey Weights','No','No','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = TRUE)
```

### Generate Tables for Haldane et al. (2021) models post-2020

**Create model list**
```{r}
target_prediction_deviance_model_list_post2020 <- list(
    "Absolute Prediction Deviance from Target (12 Months - Post-2020)" = m.lm.e12_hmm2021.q14.post,
    "Absolute Prediction Deviance from Target (12 Months - Quadratic Terms - 2001 to 2019)" = m.lm.e12_hmm2021.q14.qterms.post,
    "Absolute Prediction Deviance from Target (24 Months - 2009 to 2019)" = m.lm.e24_hmm2021.q14.post,
    "Absolute Prediction Deviance from Target (24 Months - Quadratic Terms- 2009 to 2019)" = m.lm.e24_hmm2021.q14.qterms.post,
    "Absolute Prediction Deviance from Target (60 Months- 2009 to 2019)" = m.lm.e60_hmm2021.q14.post,
    "Absolute Prediction Deviance from Target (60 Months - Quadratic Terms- 2009 to 2019)" = m.lm.e60_hmm2021.q14.qterms.post
)
```

**Create Haldane et al. (2021) model table**
```{r}
stargazer(
    target_prediction_deviance_model_list_post2020,
    keep = c("q14_inverse","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Absolute Deviation of Inflation Predictions from BOE Target (2001-2019)",
    column.labels = c("12 Months", "24 Months", "60 Months"),
    column.separate = c(2, 2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
                        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes'),
                        c('Survey Weights','No','No','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = TRUE)
```

### Baseline formula
**Create List Object for Perception Error Models for baseline formula**

Perception and Perception Error
```{r}
p_baseline_model_list <- list(
    "Inflation Perception (Q14)" = m.lm.p.q14.forA,
    "Inflation Perception (Q14_hmm2021)" = m.lm.p.q14hmm2021.forA,
    "Perception Error (Q14)" = m.lm.perror.q14.forA,
    "Perception Error (Q14_hmm2021)" = m.lm.perror.q14hmm2021.forA)
```

**Inflation Perception and Perception Error**
```{r}
stargazer(
    p_baseline_model_list,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Baseline Model - Inflation Perception and Perception Error",
    column.labels = c("Inflation Perception", "Perception Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation Prediction and Prediction Error - 12 Months**
```{r}
e12_baseline_model_list <- list(
    "Inflation Prediction (Q14 - 12 Months)" = m.lm.e12.q14.forA,
    "Inflation Prediction (Q14_hmm2021  - 12 Months)" = m.lm.e12.q14hmm2021.forA,
    "Prediction Error (Q14 - 12 Months)" = m.lm.eerror12.q14.forA,
    "Prediction Error (Q14_hmm2021 - 12 Months)" = m.lm.eerror12.q14hmm2021.forA)
```

**Inflation Prediction and Prediction Error - 24 Months**
```{r}
e24_baseline_model_list <- list(
    "Inflation Prediction (Q14 - 24 Months)" = m.lm.e24.q14.forA,
    "Inflation Prediction (Q14_hmm2021  - 24 Months)" = m.lm.e24.q14hmm2021.forA,
    "Prediction Error (Q14 - 24 Months)" = m.lm.eerror24.q14.forA,
    "Prediction Error (Q14_hmm2021 - 24 Months)" = m.lm.eerror24.q14hmm2021.forA)
```

**Inflation Prediction and Prediction Error (24 Months)**
```{r}
stargazer(
    e24_baseline_model_list,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Baseline Model - Inflation Prediction and Prediction Error (24 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation Prediction and Prediction Error - 60 Months**
```{r}
e60_baseline_model_list <- list(
    "Inflation Prediction (Q14 - 60 Months)" = m.lm.e60.q14.forA,
    "Inflation Prediction (Q14_hmm2021  - 60 Months)" = m.lm.e60.q14hmm2021.forA,
    "Prediction Error (Q14 - 60 Months)" = m.lm.eerror60.q14.forA,
    "Prediction Error (Q14_hmm2021 - 60 Months)" = m.lm.eerror60.q14hmm2021.forA)
```

**Inflation Prediction and Prediction Error (60 Months)**
```{r}
stargazer(
    e60_baseline_model_list,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Baseline Model - Inflation Prediction and Prediction Error (60 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```


2009-2022 Prediction chart with broken knowledge line
```{r}
BOE_IAS %>%
    filter(income != 12) %>%
    filter(E1y_all != 99) %>%
    filter(P_all != 99) %>%
    filter(yyyyqq >= 200901) %>%
    filter(yyyyqq <= 202204) %>%
    nest_by(yyyyqq, timetrend) %>%
    mutate(ModelModel = list(lm(CPIH_prediction_error_scale_2009_12 ~ q14_hmm2021 + CPIH_perception_error_scale_2009 + knowledge_hmm2021 + age + class + income + educ + tenure, weights = weight, data = data))) %>%
    reframe(tidy(ModelModel, conf.int = TRUE, conf.level = 0.95)) %>%
    {
        ggplot(., aes(x = timetrend, y = estimate)) +
            geom_line(data = subset(., term == "q14_hmm2021"), aes(colour = "Satisfaction (Ordinal Scale)")) +
            geom_text(data = subset(.,term == "q14_hmm2021"), aes(colour = "Satisfaction (Ordinal Scale)",
                                                                  label =
                                                                      ifelse(p.value < 0.001, "***",
                                                                             ifelse(p.value < 0.01, "**",
                                                                                    ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = 2,
                      show.legend = FALSE
            )+
            geom_line(data = subset(., term == "(Intercept)"), aes(colour = "(Intercept)")) +
            geom_text(data = subset(.,term == "(Intercept)"), aes(colour = "(Intercept)",
                                                                  label =
                                                                      ifelse(p.value < 0.001, "***",
                                                                             ifelse(p.value < 0.01, "**",
                                                                                    ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = 2,
                      show.legend = FALSE
            )+
            geom_ribbon(data = subset(., term == "(Intercept)"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1, fill = "(Intercept)")) +
            geom_line(data = subset(., term == "knowledge_hmm2021"), aes(colour = "Knowledge (Haldane et al. (2021)")) +
            geom_text(data = subset(.,term == "knowledge_hmm2021"), aes(colour = "Knowledge (Haldane et al. (2021)",
                                                                  label =
                                                                      ifelse(p.value < 0.001, "***",
                                                                             ifelse(p.value < 0.01, "**",
                                                                                    ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = 2,
                      show.legend = FALSE
            )+
            geom_ribbon(data = subset(., term == "knowledge_hmm2021"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1, fill = "Knowledge (Haldane et al. (2021)")) +
            geom_line(data = subset(., term == "CPIH_perception_error_scale_2009"), aes(colour = "Perception Error (12 Months)")) +
            geom_text(data = subset(.,term == "CPIH_perception_error_scale_2009"), aes(colour = "Perception Error (12 Months)",
                                                                                       label = 
                                                                                           ifelse(p.value < 0.001, "***",
                                                                                                  ifelse(p.value < 0.01, "**",
                                                                                                         ifelse(p.value < 0.05, "*", "")))), 
                      angle = 90,
                      hjust = -2,
                      show.legend = FALSE
            )+
            geom_ribbon(data = subset(., term == "q14_hmm2021"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1, fill = "Satisfaction (Ordinal Scale)")) +
            geom_ribbon(data = subset(., term == "CPIH_perception_error_scale_2009"), aes(ymin = conf.low, ymax = conf.high, alpha = 0.1,  fill = "Perception Error (12 Months)")) +
            scale_x_continuous(breaks = .$timetrend, labels = .$yyyyqq) +
            theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
            labs(colour = "Coefficient", fill = "95% CI", title = "Linear Model: Prediction Error (12 Months) ~ Satisfaction (Ordinal Scale) + Perception Error + Demographics (Weighted) - BoE 2009 Scaling", x = "Year - Quarter", y = "Estimate") +
            scale_fill_manual(values = c("Satisfaction (Ordinal Scale)" = "pink", "Perception Error (12 Months)" = "grey", "(Intercept)" = "lightgreen", "Knowledge (Haldane et al. (2021)" = "lightblue")) +
            scale_colour_manual(values = c("Satisfaction (Ordinal Scale)" = "red", "Perception Error (12 Months)" = "black", "(Intercept)" = "green","Knowledge (Haldane et al. (2021)" = "blue"))+
            guides(alpha = "none")
    }
```

### Weighted Models

**Inflation Perception - Baseline Formula (Q14 - Weighted)**
```{r}
m.lm.p.q14.forA.weighted <- lm(P_all ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income + educ + sreg + work, data = df.forA.filtered, weights = weight)
```

**Inflation Perception - Baseline Formula (Q14_hmm2021 - Weighted)**
```{r}
m.lm.p.q14hmm2021.forA.weighted <- lm(P_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income + educ + sreg + work, data = df.forA.filtered, weights = weight)
```

**Perception Error - Baseline Formula (Q14 - Weighted)**
```{r}
m.lm.perror.q14.forA.weighted <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income + educ + sreg + work, data = df.forA.filtered, weights = weight)
```

**Perception Error - Baseline Formula (Q14_hmm2021 - Weighted)**
```{r}
m.lm.perror.q14hmm2021.forA.weighted <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income + educ + sreg + work, data = df.forA.filtered, weights = weight)
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14 - Weighted)**
```{r}
m.lm.e12.q14.forA.weighted <- lm(E1y_all ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, weights = weight, data = df.forB.filtered)
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14_hmm2021 - Weighted)**
```{r}
m.lm.e12.q14hmm2021.forA.weighted <- lm(E1y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, weights = weight, data = df.forB.filtered)
```

**Prediction Error - 12 Months - Baseline Formula (Q14 - Weighted)**
```{r}
m.lm.eerror12.q14.forA.weighted <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, weights = weight, data = df.forB.filtered)
```

**Prediction Error - 12 Months - Baseline Formula (Q14_hmm2021 - Weighted)**
```{r}
m.lm.eerror12.q14hmm2021.forA.weighted <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, weights = weight, data = df.forB.filtered)
```

Weighted models list

**Create List Object for Inflation Perception Models for Baseline Formula**
```{r}
p_model_list <- list(
    "Q14 - Unweighted" = m.lm.p.q14.forA,
    "Q14 - Weighted" = m.lm.p.q14.forA.weighted,
    "Q14_hmm2021 - Unweighted" = m.lm.p.q14hmm2021.forA,
    "Q14_hmm2021 - Weighted" = m.lm.p.q14hmm2021.forA.weighted
)
```

**Create list object for perception error models for baseline formula**
```{r}
perror_model_list <- list(
    "Q14 - Unweighted" = m.lm.perror.q14.forA,
    "Q14 - Weighted" = m.lm.perror.q14.forA.weighted,
    "Q14_hmm2021 - Unweighted" = m.lm.perror.q14hmm2021.forA,
    "Q14_hmm2021 - Weighted" = m.lm.perror.q14hmm2021.forA.weighted
)
```

**Create List Object for Inflation Prediction Models for Baseline Formula **
```{r}
e12_model_list <- list(
    "Q14 - Unweighted" = m.lm.e12.q14.forA,
    "Q14 - Weighted" = m.lm.e12.q14.forA.weighted,
    "Q14_hmm2021 - Unweighted" = m.lm.e12.q14hmm2021.forA,
    "Q14_hmm2021 - Weighted" = m.lm.e12.q14hmm2021.forA.weighted
)
```

**Create List Object for Prediction Error Models for Baseline Formula**
```{r}
eerror12_model_list <- list(
    "Q14 - Unweighted" = m.lm.eerror12.q14.forA,
    "Q14 - Weighted" = m.lm.eerror12.q14.forA.weighted,
    "Q14_hmm2021 - Unweighted" = m.lm.eerror12.q14hmm2021.forA,
    "Q14_hmm2021 - Weighted" = m.lm.eerror12.q14hmm2021.forA.weighted
)
```


Weighted baseline models

**Perception Error**
```{r}
stargazer(
    perror_model_list,
    type = "text",
    title = "Linear Model: Perception Error",
    out = "CPIH\\_perception\\_error\\_scale\\_2009",
    column.labels = c("Q14 - Unweighted", "Q14 - Weighted", "Q14\\_hmm2021 - Unweighted", "Q14\\_hmm2021 - Weighted"),
    column.separate = c(1, 1, 1, 1),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = TRUE,
    dep.var.labels = "CPIH Perception Error (CPIH\\_perception\\_error\\_scale\\_2009)"
)
```

**Inflation Perception**
```{r}
stargazer(
    p_model_list,
    type = "text",
    title = "Linear Model: Inflation Perception",
    out = "P\\_all",
    column.labels = c("Q14 - Unweighted", "Q14 - Weighted", "Q14\\_hmm2021 - Unweighted", "Q14\\_hmm2021 - Weighted"),
    column.separate = c(1, 1, 1, 1),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = TRUE,
    dep.var.labels = "Inflation Perception (P\\_all)"
)
```
### Absolute Error - Regression for Aggregate Uncertainty

**Create List Object for Absolute Error Models for Baseline Formula**
```{r}
absolute_error_model_list <- list(
    "Perception Error - Absolute Values (Q14)" = m.lm.perrorabs.q14.forA,
    "Perception Error - Absolute Values (Q14_hmm2021)" = m.lm.perrorabs.q14hmm2021.forA,
    "Prediction Error - Absolute Values (12 Months - Q14)" = m.lm.eerror12abs.q14.forA,
    "Prediction Error - Absolute Values (12 Months - Q14_hmm2021)" = m.lm.eerror12abs.q14hmm2021.forA,
    "Prediction Error - Absolute Values (24 Months - Q14)" = m.lm.eerror24abs.q14.forA,
    "Prediction Error - Absolute Values (24 Months - Q14_hmm2021)" = m.lm.eerror24abs.q14hmm2021.forA,
    "Prediction Error - Absolute Values (60 Months - Q14)" = m.lm.eerror60abs.q14.forA,
    "Prediction Error - Absolute Values (60 Months - Q14_hmm2021)" = m.lm.eerror60abs.q14hmm2021.forA
)
```

**Create list object for perception and prediction (12 months)**
```{r}
absolute_error_model_list1 <- list(
    "Perception Error - Absolute Values (Q14)" = m.lm.perrorabs.q14.forA,
    "Perception Error - Absolute Values (Q14_hmm2021)" = m.lm.perrorabs.q14hmm2021.forA,
    "Prediction Error - Absolute Values (12 Months - Q14)" = m.lm.eerror12abs.q14.forA,
    "Prediction Error - Absolute Values (12 Months - Q14_hmm2021)" = m.lm.eerror12abs.q14hmm2021.forA
)
```

**Create list object for prediction error (24 and 60 months)**
```{r}
absolute_error_model_list2 <- list(
    "Prediction Error - Absolute Values (24 Months - Q14)" = m.lm.eerror24abs.q14.forA,
    "Prediction Error - Absolute Values (24 Months - Q14_hmm2021)" = m.lm.eerror24abs.q14hmm2021.forA,
    "Prediction Error - Absolute Values (60 Months - Q14)" = m.lm.eerror60abs.q14.forA,
    "Prediction Error - Absolute Values (60 Months - Q14_hmm2021)" = m.lm.eerror60abs.q14hmm2021.forA
)
```

**Absolute error: Inflation Perception and Prediction**
```{r}
stargazer(
    absolute_error_model_list,
    keep = c("CPIH","q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Absolute Inflation Perception & Prediction",
    column.labels = c("Perception Error", "Prediction Error (12 Months)", "Prediction Error (24 Months)", "Prediction Error (60 Months)"),
    column.separate = c(2, 2, 2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
                        c('Demographic Controls','Yes','Yes','Yes','Yes','Yes','Yes','Yes','Yes'),
                        c('Survey Weights','No','No','No','No','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Absolute error: Inflation perception and prediction (12 months)**
```{r}
stargazer(
    absolute_error_model_list1,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Absolute Inflation Perception & Prediction (12 Months)",
    column.labels = c("Perception Error", "Prediction Error (12 Months)"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Absolute error: Inflation prediction (24 and 60 months)**
```{r}
stargazer(
    absolute_error_model_list2,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Absolute Error - Prediction (24 and 60 Months)",
    column.labels = c("Prediction Error (24 Months)", "Prediction Error (60 Months)"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

### CPI-based models

**Inflation Perception - Baseline Formula (Q14)**
```{r}
m.lm.p.q14.forA.CPI <- lm(P_all ~  CPI + q14 + knowledge_hmm2021 + age + sex + tenure + class + income + educ + sreg + work, data = df.forA.filtered)
```

**Inflation Perception - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.p.q14hmm2021.forA.CPI <- lm(P_all ~  CPI + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income + educ + sreg, data = df.forA.filtered)
```

**Perception Error - Baseline Formula (Q14)**
```{r}
m.lm.perror.q14.forA.CPI <- lm(CPI_perception_error_scale_2009 ~  CPI + q14 + knowledge_hmm2021 + age + sex + tenure + class + income + educ + sreg + work, data = df.forA.filtered)
```

**Perception Error - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.perror.q14hmm2021.forA.CPI <- lm(CPI_perception_error_scale_2009 ~  CPI + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income + educ + sreg + work, data = df.forA.filtered)
```

**Create List Object for Inflation Prediction and Prediction Error Models for Baseline Formula **
```{r}
p_CPI_model_list <- list(
    "Inflation Perception (Q14 - 12 Months)" = m.lm.p.q14.forA.CPI,
    "Inflation Perception (Q14_hmm2021 - 12 Months)" = m.lm.p.q14hmm2021.forA.CPI,
    "Perception Error (Q14 - 12 Months)" = m.lm.perror.q14.forA.CPI,
    "Perception Error (Q14_hmm2021 - 12 Months)" = m.lm.perror.q14hmm2021.forA.CPI
)
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.e12.q14.forA.CPI <- lm(E1y_all ~  CPI + q14 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forB.filtered)
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e12.q14hmm2021.forA.CPI <- lm(E1y_all ~  CPI + q14_hmm2021 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forB.filtered)
```

**Prediction Error - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror12.q14.forA.CPI <- lm(CPI_prediction_error_scale_2009_12 ~  CPI + q14 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forB.filtered)
```

**Prediction Error - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror12.q14hmm2021.forA.CPI <- lm(CPI_prediction_error_scale_2009_12 ~  CPI + q14_hmm2021 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forB.filtered)
```

**Create List Object for Inflation Prediction and Prediction Error Models for Baseline Formula **
```{r}
e12_CPI_model_list <- list(
    "Inflation Prediction (Q14 - 12 Months)" = m.lm.e12.q14.forA.CPI,
    "Inflation Prediction (Q14_hmm2021 - 12 Months)" = m.lm.e12.q14hmm2021.forA.CPI,
    "Prediction Error (Q14 - 12 Months)" = m.lm.eerror12.q14.forA.CPI,
    "Prediction Error (Q14_hmm2021 - 12 Months)" = m.lm.eerror12.q14hmm2021.forA.CPI
)
```

**Inflation Prediction - 24 Months - Baseline Formula (Q14)**
```{r}
m.lm.e24.q14.forA.CPI <- lm(E2y_all ~  CPI + q14 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forC.filtered)
```

**Inflation Prediction - 24 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e24.q14hmm2021.forA.CPI <- lm(E2y_all ~  CPI + q14_hmm2021 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forC.filtered)
```

**Prediction Error - 24 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror24.q14.forA.CPI <- lm(CPI_prediction_error_scale_2009_24 ~  CPI + q14 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forC.filtered)
```

**Prediction Error - 24 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror24.q14hmm2021.forA.CPI <- lm(CPI_prediction_error_scale_2009_24 ~  CPI + q14_hmm2021 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forC.filtered)
```

**Create List Object for Inflation Prediction and Prediction Error Models for Baseline Formula **
```{r}
e24_CPI_model_list <- list(
    "Inflation Prediction (Q14 - 24 Months)" = m.lm.e24.q14.forA.CPI,
    "Inflation Prediction (Q14_hmm2021 - 24 Months)" = m.lm.e24.q14hmm2021.forA.CPI,
    "Prediction Error (Q14 - 24 Months)" = m.lm.eerror24.q14.forA.CPI,
    "Prediction Error (Q14_hmm2021 - 24 Months)" = m.lm.eerror24.q14hmm2021.forA.CPI
)
```

**Inflation Prediction - 60 Months - Baseline Formula (Q14)**
```{r}
m.lm.e60.q14.forA.CPI <- lm(E5y_all ~  CPI + q14 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forD.filtered)
```

**Inflation Prediction - 60 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e60.q14hmm2021.forA.CPI <- lm(E5y_all ~  CPI + q14_hmm2021 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forD.filtered)
```

**Prediction Error - 60 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror60.q14.forA.CPI <- lm(CPI_prediction_error_scale_2009_60 ~  CPI + q14 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forD.filtered)
```

**Prediction Error - 60 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror60.q14hmm2021.forA.CPI <- lm(CPI_prediction_error_scale_2009_60 ~  CPI + q14_hmm2021 + knowledge_hmm2021 + CPI_perception_error_scale_2009 + age + sex + tenure + class + income + educ + sreg + work, data = df.forD.filtered)
```

**Create List Object for Inflation Prediction and Prediction Error Models for Baseline Formula **
```{r}
e60_CPI_model_list <- list(
    "Inflation Prediction (Q14 - 60 Months)" = m.lm.e60.q14.forA.CPI,
    "Inflation Prediction (Q14_hmm2021 - 60 Months)" = m.lm.e60.q14hmm2021.forA.CPI,
    "Prediction Error (Q14 - 60 Months)" = m.lm.eerror60.q14.forA.CPI,
    "Prediction Error (Q14_hmm2021 - 60 Months)" = m.lm.eerror60.q14hmm2021.forA.CPI
)
```


**Perception and Perception Error**

```{r}
stargazer(
    p_CPI_model_list,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Inflation Series: CPI - Perception and Perception Error",
    column.labels = c("Inflation Perception", "Perception Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation prediction and prediction error (12 months)**

```{r}
stargazer(
    e12_CPI_model_list,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Inflation Series: CPI - Inflation Prediction and Prediction Error (12 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation prediction and prediction error (24 months)**

```{r}
stargazer(
    e24_CPI_model_list,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Inflation Series: CPI - Inflation Prediction and Prediction Error (24 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation prediction and prediction error (60 months)**

```{r}
stargazer(
    e60_CPI_model_list,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Inflation Series: CPI - Inflation Prediction and Prediction Error (24 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

##### Models without trust effects models

**Inflation Perception and Perception Error**

```{r}
stargazer(
    m.lm.p.q14.forA, m.lm.p.q14hmm2021.forA, m.lm.perror.q14.forA, m.lm.perror.q14hmm2021.forA,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Baseline Model - Inflation Perception and Perception Error",
    column.labels = c("Inflation Perception", "Perception Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation Prediction and Prediction Error (12 Months)**
```{r}
stargazer(
    m.lm.e12.q14.forA, m.lm.e12.q14hmm2021.forA, m.lm.eerror12.q14.forA, m.lm.eerror12.q14hmm2021.forA,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Baseline Model - Inflation Prediction and Prediction Error (24 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation Prediction and Prediction Error (24 Months)**
```{r}
stargazer(
    m.lm.e24.q14.forA, m.lm.e24.q14hmm2021.forA, m.lm.eerror24.q14.forA, m.lm.eerror24.q14hmm2021.forA, 
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Baseline Model - Inflation Prediction and Prediction Error (24 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation Prediction and Prediction Error (60 Months)**
```{r}
stargazer(
    m.lm.e60.q14.forA, m.lm.e60.q14hmm2021.forA, m.lm.eerror60.q14.forA, m.lm.eerror60.q14hmm2021.forA,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Baseline Model - Inflation Prediction and Prediction Error (60 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

##### Models with truncated data

###### 2001-2008
**Inflation Perception - Baseline Formula (Q14)**
```{r}
m.lm.p.q14.forA.0804 <- lm(P_all ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq <= 200804))
```

**Perception Error - Baseline Formula (Q14)**
```{r}
m.lm.perror.q14.forA.0804 <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq <= 200804))
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.e12.q14.forA.0804 <- lm(E1y_all ~  CPIH + q14 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq <= 200804))
```

**Prediction Error - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror12.q14.forA.0804 <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq <= 200804))
```

**Inflation Perception - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.p.q14hmm2021.forA.0804 <- lm(P_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq <= 200804))
```

**Perception Error - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.perror.q14hmm2021.forA.0804 <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq <= 200804))
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e12.q14hmm2021.forA.0804 <- lm(E1y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq <= 200804))
```

**Prediction Error - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror12.q14hmm2021.forA.0804 <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq <= 200804))
```

###### 2009-2022
**Inflation Perception - Baseline Formula (Q14)**
```{r}
m.lm.p.q14.forA.2201 <- lm(P_all ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Perception Error - Baseline Formula (Q14)**
```{r}
m.lm.perror.q14.forA.2201 <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.e12.q14.forA.2201 <- lm(E1y_all ~  CPIH + q14 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Prediction Error - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror12.q14.forA.2201 <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Inflation Prediction - 24 Months - Baseline Formula (Q14)**
```{r}
m.lm.e24.q14.forA.2201 <- lm(E2y_all ~  CPIH + q14 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Prediction Error - 24 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror24.q14.forA.2201 <- lm(CPIH_prediction_error_scale_2009_24 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Inflation Prediction - 60 Months - Baseline Formula (Q14)**
```{r}
m.lm.e60.q14.forA.2201 <- lm(E5y_all ~  CPIH + q14 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Prediction Error - 60 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror60.q14.forA.2201 <- lm(CPIH_prediction_error_scale_2009_60 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Inflation Perception - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.p.q14hmm2021.forA.2201 <- lm(P_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Perception Error - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.perror.q14hmm2021.forA.2201 <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e12.q14hmm2021.forA.2201 <- lm(E1y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Prediction Error - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror12.q14hmm2021.forA.2201 <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Inflation Prediction - 24 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e24.q14hmm2021.forA.2201 <- lm(E2y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Prediction Error - 24 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror24.q14hmm2021.forA.2201 <- lm(CPIH_prediction_error_scale_2009_24 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Inflation Prediction - 60 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e60.q14hmm2021.forA.2201 <- lm(E5y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

**Prediction Error - 60 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror60.q14hmm2021.forA.2201 <- lm(CPIH_prediction_error_scale_2009_60 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forD.filtered, subset = (yyyyqq >= 200901 & yyyyqq <=202201))
```

###### 2022-2024

**Inflation Perception - Baseline Formula (Q14)**
```{r}
m.lm.p.q14.forA.2304 <- lm(P_all ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 202202))
```

**Perception Error - Baseline Formula (Q14)**
```{r}
m.lm.perror.q14.forA.2304 <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 202202))
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.e12.q14.forA.2304 <- lm(E1y_all ~  CPIH + q14 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 202202))
```

**Prediction Error - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror12.q14.forA.2304 <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 202202))
```

**Inflation Perception - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.p.q14hmm2021.forA.2304 <- lm(P_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 202202))
```

**Perception Error - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.perror.q14hmm2021.forA.2304 <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 202202))
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e12.q14hmm2021.forA.2304 <- lm(E1y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 202202))
```

**Prediction Error - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror12.q14hmm2021.forA.2304 <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 202202))
```

###### 2020-2024

**Inflation Perception - Baseline Formula (Q14)**
```{r}
m.lm.p.q14.forA.19042304 <- lm(P_all ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 201904))
```

**Perception Error - Baseline Formula (Q14)**
```{r}
m.lm.perror.q14.forA.19042304 <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 201904))
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.e12.q14.forA.19042304 <- lm(E1y_all ~  CPIH + q14 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 201904))
```

**Prediction Error - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror12.q14.forA.19042304 <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 201904))
```

**Inflation Prediction - 24 Months - Baseline Formula (Q14)**
```{r}
m.lm.e24.q14.forA.19042304 <- lm(E2y_all ~  CPIH + q14 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, subset = (yyyyqq >= 201904))
```

**Prediction Error - 24 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror24.q14.forA.19042304 <- lm(CPIH_prediction_error_scale_2009_24 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, subset = (yyyyqq >= 201904))
```

**Inflation Perception - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.p.q14hmm2021.forA.19042304 <- lm(P_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 201904))
```

**Perception Error - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.perror.q14hmm2021.forA.19042304 <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, subset = (yyyyqq >= 201904))
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e12.q14hmm2021.forA.19042304 <- lm(E1y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 201904))
```

**Prediction Error - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror12.q14hmm2021.forA.19042304 <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered, subset = (yyyyqq >= 201904))
```

**Inflation Prediction - 24 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.e24.q14hmm2021.forA.19042304 <- lm(E2y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, subset = (yyyyqq >= 201904))
```

**Prediction Error - 24 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror24.q14hmm2021.forA.19042304 <- lm(CPIH_prediction_error_scale_2009_24 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forC.filtered, subset = (yyyyqq >= 201904))
```

##### Truncated Data

###### 2020-2024

**Create list object for 2020-2024 subset for baseline formula**

Perception and Perception Error
```{r}
truncated_2020_2024_model_list1 <- list(
    "Inflation Perception (Q14)" = m.lm.p.q14.forA.19042304,
    "Inflation Perception (Q14_hmm2021)" = m.lm.p.q14hmm2021.forA.19042304,
    "Perception Error (Q14)" = m.lm.perror.q14.forA.19042304,
    "Perception Error (Q14_hmm2021)" = m.lm.perror.q14hmm2021.forA.19042304)
```

Inflation Prediction and Prediction Error (12 months)
```{r}
truncated_2020_2024_model_list2 <- list(
    "Inflation Prediction (Q14 - 12 Months)" = m.lm.e12.q14.forA.19042304,
    "Inflation Prediction (Q14_hmm2021 - 12 Months)" = m.lm.e12.q14hmm2021.forA.19042304,
    "Prediction Error (Q14 - 12 Months)" = m.lm.eerror12.q14.forA.19042304,
    "Prediction Error (Q14_hmm2021 - 12 Months)" = m.lm.eerror12.q14hmm2021.forA.19042304)
```

Inflation Prediction and Prediction Error (24 months)
```{r}
truncated_2020_2024_model_list3 <- list(
    "Inflation Prediction (Q14 - 24 Months)" = m.lm.e24.q14.forA.19042304,
    "Inflation Prediction (Q14_hmm2021 - 12 Months)" = m.lm.e24.q14hmm2021.forA.19042304,
    "Prediction Error (Q14 - 12 Months)" = m.lm.eerror24.q14.forA.19042304,
    "Prediction Error (Q14_hmm2021 - 12 Months)" = m.lm.eerror24.q14hmm2021.forA.19042304)
```

**Perception and Perception Error**

```{r}
stargazer(
    truncated_2020_2024_model_list1,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - 2020-2024 - Perception and Perception Error",
    column.labels = c("Inflation Perception", "Perception Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation prediction and prediction error (12 months)**

```{r}
stargazer(
    truncated_2020_2024_model_list2,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - 2020-2024 - Inflation Prediction and Prediction Error (12 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```

**Inflation prediction and prediction error (24 months)**

```{r}
stargazer(
    truncated_2020_2024_model_list3,
    keep = c("q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - 2020-2024 - Inflation Prediction and Prediction Error (24 Months)",
    column.labels = c("Inflation Prediction", "Prediction Error"),
    column.separate = c(2, 2),
    dep.var.labels.include = FALSE,
    add.lines = list(
        c('Demographic Controls','Yes','Yes','Yes','Yes'),
        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = FALSE)
```
**Compare knowledge models - construct perception & perception error model list**
```{r}
  p_knowledge_model_list <- list(
    "Q14 - Inflation Perception" = m.lm.p.q14.forA.01only,
    "Q14_hmm2021 - Inflation Perception" = m.lm.p.q14hmm2021.forA.01only,
    "Q14 - Perception Error" = m.lm.perror.q14.forA.01only,
    "Q14_hmm2021 - Perception Error" = m.lm.perror.q14hmm2021.forA.01only
)
```

**Compare knowledge models - construct prediction & prediction error model list**
```{r}
  e_knowledge_model_list <- list(
    "Q14 - Inflation Prediction" = m.lm.e12.q14.forA.01only,
    "Q14_hmm2021 - Inflation Prediction" = m.lm.e12.q14hmm2021.forA.01only,
    "Q14 - Prediction Error" = m.lm.eerror12.q14.forA.01only,
    "Q14_hmm2021 - Prediction Error" = m.lm.eerror12.q14hmm2021.forA.01only
)
```

**Inflation perception and perception error**
```{r}
stargazer(
    m.lm.p.q14.forA.01only, m.lm.p.q14hmm2021.forA.01only, m.lm.perror.q14.forA.01only, m.lm.perror.q14hmm2021.forA.01only,
    keep = c("CPIH","q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Inflation Perceptions & Error ~ Knowledge",
    column.labels = c("Q14 - Inflation Perception", "Q14\\_hmm2021 - Inflation Perception", "Q14 - Perception Error", "Q14\\_hmm2021 - Perception Error"),
    column.separate = c(1, 1, 1, 1),
    add.lines = list(
                        c('Demographic Controls','Yes','Yes','Yes','Yes'),
                        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = TRUE)
```

**Inflation prediction and prediction error**
```{r}
stargazer(
    e_knowledge_model_list,
    keep = c("CPIH","q14","q14_hmm2021","knowledge_hmm2021","Constant"),
    type = "text",
    title = "Linear Model - Inflation Prediction & Error ~ Knowledge",
    column.labels = c("Q14 - Inflation Prediction", "Q14\\_hmm2021 - Inflation Prediction", "Q14 - Prediction Error", "Q14\\_hmm2021 - Prediction Error"),
    column.separate = c(1, 1, 1, 1),
    add.lines = list(
                        c('Demographic Controls','Yes','Yes','Yes','Yes'),
                        c('Survey Weights','No','No','No','No')),
    style = "qje",
    ci = TRUE,
    ci.level = 0.95,
    model.names = TRUE)
```



**Inflation Perception - Baseline Formula (Q14 - February data only)**

```{r}
m.lm.p.q14.forA.01only <- lm(P_all ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered.01only)
```

**Inflation Perception - Baseline Formula (Q14 - Weighted and February data only)**
```{r}
m.lm.p.q14.forA.weighted.01only <- lm(P_all ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered.01only, weights = weight)
```

**Inflation Perception - Baseline Formula (Q14_hmm2021 - February data only)**
```{r}
m.lm.p.q14hmm2021.forA.01only <- lm(P_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered.01only)
```

**Inflation Perception - Baseline Formula (Q14_hmm2021 - Weighted and February data only)**
```{r}
m.lm.p.q14hmm2021.forA.weighted.01only <- lm(P_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forA.filtered, weights = weight)
```

**Create List Object for Inflation Perception Models for Baseline Formula**
```{r}
p_model_list_01only <- list(
    "Q14 - Unweighted" = m.lm.p.q14.forA.01only,
    "Q14 - Weighted" = m.lm.p.q14.forA.weighted.01only,
    "Q14_hmm2021 - Unweighted" = m.lm.p.q14hmm2021.forA.01only,
    "Q14_hmm2021 - Weighted" = m.lm.p.q14hmm2021.forA.weighted.01only
)
```

**Perception Error - Baseline Formula (Q14 - February data only)**
```{r}
m.lm.perror.q14.forA.01only <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg, data = df.forA.filtered.01only)
```

**Perception Error - Baseline Formula (Q14 - Weighted and February data only)**
```{r}
m.lm.perror.q14.forA.weighted.01only <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg, data = df.forA.filtered.01only, weights = weight)
```

**Perception Error - Baseline Formula (Q14_hmm2021 - February data only)**
```{r}
m.lm.perror.q14hmm2021.forA.01only <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg, data = df.forA.filtered.01only)
```

**Perception Error - Baseline Formula (Q14_hmm2021 - Weighted and February data only)**
```{r}
m.lm.perror.q14hmm2021.forA.weighted.01only <- lm(CPIH_perception_error_scale_2009 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + age + sex + tenure + class + income_fix + educ + sreg, data = df.forA.filtered.01only, weights = weight)
```

**Create List Object for Perception Error Models for Baseline Formula**
```{r}
perror_model_list_01only <- list(
    "Q14 - Unweighted" = m.lm.perror.q14.forA.01only,
    "Q14 - Weighted" = m.lm.perror.q14.forA.weighted.01only,
    "Q14_hmm2021 - Unweighted" = m.lm.perror.q14hmm2021.forA.01only,
    "Q14_hmm2021 - Weighted" = m.lm.perror.q14hmm2021.forA.weighted.01only
)
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14 - February data only)**
```{r}
m.lm.e12.q14.forA.01only <- lm(E1y_all ~  CPIH + q14 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg, data = df.forB.filtered.01only)
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14 - Weighted and February data only)**
```{r}
m.lm.e12.q14.forA.weighted.01only <- lm(E1y_all ~  CPIH + q14 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg, weights = weight, data = df.forB.filtered.01only)
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14_hmm2021 - February data only)**
```{r}
m.lm.e12.q14hmm2021.forA.01only <- lm(E1y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg, data = df.forB.filtered.01only)
```

**Inflation Prediction - 12 Months - Baseline Formula (Q14_hmm2021 - Weighted and February data only)**
```{r}
m.lm.e12.q14hmm2021.forA.weighted.01only <- lm(E1y_all ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + P_all + age + sex + tenure + class + income_fix + educ + sreg, weights = weight, data = df.forB.filtered.01only)
```

**Create List Object for Inflation Prediction Models for Baseline Formula with February data only**
```{r}
e12_model_list_01only <- list(
    "Q14 - Unweighted" = m.lm.e12.q14.forA.01only,
    "Q14 - Weighted" = m.lm.e12.q14.forA.weighted.01only,
    "Q14_hmm2021 - Unweighted" = m.lm.e12.q14hmm2021.forA.01only,
    "Q14_hmm2021 - Weighted" = m.lm.e12.q14hmm2021.forA.weighted.01only
)
```

**Prediction Error - 12 Months - Baseline Formula (Q14)**
```{r}
m.lm.eerror12.q14.forA.01only <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered.01only)
```

**Prediction Error - 12 Months - Baseline Formula (Q14 - Weighted)**
```{r}
m.lm.eerror12.q14.forA.weighted.01only <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, weights = weight, data = df.forB.filtered.01only)
```

**Prediction Error - 12 Months - Baseline Formula (Q14_hmm2021)**
```{r}
m.lm.eerror12.q14hmm2021.forA.01only <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, data = df.forB.filtered.01only)
```

**Prediction Error - 12 Months - Baseline Formula (Q14_hmm2021 - Weighted)**
```{r}
m.lm.eerror12.q14hmm2021.forA.weighted.01only <- lm(CPIH_prediction_error_scale_2009_12 ~  CPIH + q14_hmm2021 + knowledge_hmm2021 + CPIH_perception_error_scale_2009 + age + sex + tenure + class + income_fix + educ + sreg + work, weights = weight, data = df.forB.filtered.01only)
```

**Create List Object for Prediction Error Models for Baseline Formula**
```{r}
eerror12_model_list_01only <- list(
    "Q14 - Unweighted" = m.lm.eerror12.q14.forA.01only,
    "Q14 - Weighted" = m.lm.eerror12.q14.forA.weighted.01only,
    "Q14_hmm2021 - Unweighted" = m.lm.eerror12.q14hmm2021.forA.01only,
    "Q14_hmm2021 - Weighted" = m.lm.eerror12.q14hmm2021.forA.weighted.01only
)
```
